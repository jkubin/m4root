<!-- DO NOT EDIT! This file is generated automatically! -->
<!doctype html>
<html id="css" class="js-inactive" lang="cs" manifest="manifest.appcache">
<head>
<meta charset="utf-8">
<title>GenerovÃ¡nÃ­ kÃ³du v M4: Ãºvod</title>
<link rel="stylesheet" type="text/css" href="../preview.css">
<meta name="description" content="Makro procesor M4 se pouÅ¾Ã­vÃ¡ ke generovÃ¡nÃ­ libovolnÄ› sloÅ¾itÃ©ho kÃ³du z&nbsp;jednoduchÃ©ho zdrojovÃ©ho kÃ³du.
ÃšvodnÃ­ dÃ­l seriÃ¡lu obsahuje jeho historii, zÃ¡kladnÃ­ principy jazyka, pÅ™Ã­klady pouÅ¾itÃ­ a&nbsp;nutnÃ© pÅ™edpoklady pro zvlÃ¡dnutÃ­ tohoto geniÃ¡lnÃ­ho nÃ¡stroje.">
<meta name="author" content="Josef KubÃ­n">
</head>
<body>
<div class="design-page__content">
<div class=" js-sticker-init layout-main--has-sidebar--default layout-main--has-sidebar  layout-main main">
<div class="js-sticker-compare-wrapper layout-columns layout-main__content">
<div class="layout-columns__item--main layout-columns__item">

<div class="design-tile--version-1 design-tile" itemtype="http://schema.org/Article" itemref="microdata-authors microdata-publisher" itemscope>

<!-- Sklik-kontext-start -->
<h1 class="detail__heading design-heading--level-1 design-heading" itemprop="headline">GenerovÃ¡nÃ­ kÃ³du v M4: Ãºvod</h1>

<div class="detail__perex">
	<div class=" perex">
		<div  style="max-width: 468px"  class=" element-print-hidden  perex__img" itemprop="image" itemtype="http://schema.org/ImageObject" itemscope>
			<img src="../img/m4tux.png" itemprop="url" width="468" height="263" alt=" ">
			<meta itemprop="width" content="468">
			<meta itemprop="height" content="263">
		</div>
		<div class=" perex__text--has-reading-duration  perex__text--detail perex__text">
			<div class="perex__text-content">
				<div class="perex__impressum">
						<span class="perex__author">Josef KubÃ­n</span>
						<span class="perex__date">
							<svg class="icon icon-time" viewBox="0 0 100 100" width="20" height="20">
								<use xlink:href="#svg-sprite-time">
<svg viewBox="0 0 110.97 111" preserveAspectRatio="xMidYMid" id="svg-sprite-time" xmlns="http://www.w3.org/2000/svg"><path d="M55.484 111.003c-30.65 0-55.496-24.847-55.496-55.496C-.012 24.857 24.834.01 55.484.01c30.649 0 55.496 24.847 55.496 55.497 0 30.649-24.847 55.496-55.496 55.496zm0-94.263c-21.376 0-38.766 17.391-38.766 38.767 0 21.376 17.39 38.766 38.766 38.766 21.376 0 38.766-17.39 38.766-38.766 0-21.376-17.39-38.767-38.766-38.767zm18.512 45.04H55.485a6.274 6.274 0 0 1-4.456-1.856L36.782 45.557a6.276 6.276 0 0 1 .037-8.872 6.276 6.276 0 0 1 8.875.037l12.405 12.511h15.897a6.274 6.274 0 0 1 0 12.547z"></path></svg>
								</use>
							</svg>
							<span itemprop="datePublished">11. 1. 2020</span>
						</span>
				</div>
				<p itemprop="description">Makro procesor M4 se pouÅ¾Ã­vÃ¡ ke generovÃ¡nÃ­ libovolnÄ› sloÅ¾itÃ©ho kÃ³du z&nbsp;jednoduchÃ©ho zdrojovÃ©ho kÃ³du.
ÃšvodnÃ­ dÃ­l seriÃ¡lu obsahuje jeho historii, zÃ¡kladnÃ­ principy jazyka, pÅ™Ã­klady pouÅ¾itÃ­ a&nbsp;nutnÃ© pÅ™edpoklady pro zvlÃ¡dnutÃ­ tohoto geniÃ¡lnÃ­ho nÃ¡stroje.</p>
				<div class="perex__reading-duration">
					Doba ÄtenÃ­: <strong>123 minut</strong>
				</div>
			</div>
		</div>
	</div>
</div>

<div class="detail__article" itemprop="articleBody">

<!-- Sklik-kontext-start -->
<div class=" layout-article-content">
<div class="php-urs urs">
<!-- subordinate style sheet -->
<style>.urs .m4-tip::before{content:"Pozn: ";color:#969696;}.urs .m4-top{text-decoration:none;}.urs .m4-jmp{text-decoration:none;font-size:.5em;vertical-align:super;}.urs .m4-un{text-decoration:underline;}.urs .m4-bl{color:blue;}</style>
<!-- table of content -->
<h2 id="m4-toc-capt">Obsah&nbsp;(<a href="../generating-code-in-m4-introduction/preview.html">English version</a>)</h2>
<p id="m4-toc-uvod"><a href="#m4-uvod">1&nbsp;&nbsp;Ãšvod</a></p>
<p id="m4-toc-priklady-pro-ctenare">&nbsp;&nbsp;&nbsp;<a href="#m4-priklady-pro-ctenare">1.1&nbsp;&nbsp;PÅ™Ã­klady pro ÄtenÃ¡Å™e</a></p>
<p id="m4-toc-historie-makro-jazyku"><a href="#m4-historie-makro-jazyku">2&nbsp;&nbsp;Historie makro jazykÅ¯</a></p>
<p id="m4-toc-zaklady-jazyka-m4"><a href="#m4-zaklady-jazyka-m4">3&nbsp;&nbsp;ZÃ¡klady jazyka M4</a></p>
<p id="m4-toc-bezkontextova-gramatika">&nbsp;&nbsp;&nbsp;<a href="#m4-bezkontextova-gramatika">3.1&nbsp;&nbsp;BezkontextovÃ¡ gramatika</a></p>
<p id="m4-toc-automaty">&nbsp;&nbsp;&nbsp;<a href="#m4-automaty">3.2&nbsp;&nbsp;Automaty</a></p>
<p id="m4-toc-vystupni-fronty">&nbsp;&nbsp;&nbsp;<a href="#m4-vystupni-fronty">3.3&nbsp;&nbsp;VÃ½stupnÃ­ fronty</a></p>
<p id="m4-toc-hlavni-pouziti-m4"><a href="#m4-hlavni-pouziti-m4">4&nbsp;&nbsp;HlavnÃ­ pouÅ¾itÃ­ M4</a></p>
<p id="m4-toc-generovani-kodu">&nbsp;&nbsp;&nbsp;<a href="#m4-generovani-kodu">4.1&nbsp;&nbsp;GenerovÃ¡nÃ­ kÃ³du</a></p>
<p id="m4-toc-preprocesor">&nbsp;&nbsp;&nbsp;<a href="#m4-preprocesor">4.2&nbsp;&nbsp;Preprocesor</a></p>
<p id="m4-toc-predpoklady-pro-zvladnuti-m4"><a href="#m4-predpoklady-pro-zvladnuti-m4">5&nbsp;&nbsp;PÅ™edpoklady pro zvlÃ¡dnutÃ­ M4</a></p>
<p id="m4-toc-zaklady-gramatik">&nbsp;&nbsp;&nbsp;<a href="#m4-zaklady-gramatik">5.1&nbsp;&nbsp;ZÃ¡klady gramatik</a></p>
<p id="m4-toc-zaklady-automatu">&nbsp;&nbsp;&nbsp;<a href="#m4-zaklady-automatu">5.2&nbsp;&nbsp;ZÃ¡klady automatÅ¯</a></p>
<p id="m4-toc-gnu-make">&nbsp;&nbsp;&nbsp;<a href="#m4-gnu-make">5.3&nbsp;&nbsp;(GNU) make</a></p>
<p id="m4-toc-vim">&nbsp;&nbsp;&nbsp;<a href="#m4-vim">5.4&nbsp;&nbsp;Vim</a></p>
<p id="m4-toc-talent-a-cas">&nbsp;&nbsp;&nbsp;<a href="#m4-talent-a-cas">5.5&nbsp;&nbsp;Talent a Äas</a></p>
<p id="m4-toc-refs"><a href="#m4-refs">6&nbsp;&nbsp;Odkazy</a></p>
<hr>
<p id="m4-toc-priklady-generovani-kodu"><a href="#m4-priklady-generovani-kodu">A&nbsp;&nbsp;PÅ™Ã­klady generovÃ¡nÃ­ kÃ³du</a></p>
<p id="m4-toc-priklady-preprocesoru"><a href="#m4-priklady-preprocesoru">B&nbsp;&nbsp;PÅ™Ã­klady preprocesoru</a></p>
<p id="m4-toc-m4-priklady"><a href="#m4-m4-priklady">C&nbsp;&nbsp;M4 â€“ pÅ™Ã­klady</a></p>
<p id="m4-toc-proc-pouzivat-m4-a-proc-ne"><a href="#m4-proc-pouzivat-m4-a-proc-ne">D&nbsp;&nbsp;ProÄ pouÅ¾Ã­vat M4 a proÄ ne?</a></p>
<!-- article content -->
<h2 id="m4-uvod"><a href="#m4-uvod" title="âš“">1</a>&nbsp;&nbsp;Ãšvod&nbsp;<a href="#m4-toc-uvod" title="Obsah" class="m4-jmp">â˜°</a></h2>
<p>ÄŒtenÃ¡Å™i tohoto seriÃ¡lu se nauÄÃ­ psÃ¡t skripty pro strojovÃ© generovÃ¡nÃ­ kÃ³du.
StrojovÄ› generovanÃ½ kÃ³d mÅ¯Å¾e bÃ½t libovolnÄ› sloÅ¾itÃ½ a&nbsp;mÅ¯Å¾e obsahovat dalÅ¡Ã­ vnitÅ™nÃ­ zÃ¡vislosti.
VzÃ¡jemnÄ› zÃ¡vislÃ© soubory se sloÅ¾itÃ½m kÃ³dem jsou pro ÄlovÄ›ka jen tÄ›Å¾ce udrÅ¾itelnÃ© v&nbsp;konzistentnÃ­m stavu.
Proto je vhodnÃ© pouÅ¾Ã­t nÄ›jakÃ½ mechanismus pro generovÃ¡nÃ­ kÃ³du.
GenerovÃ¡nÃ­ kÃ³du provÃ¡dÃ­ nÃ¡stroj urÄenÃ½ pro transformaci textu â€“ <strong>makro procesor</strong>.</p>
<p>SeriÃ¡l je zamÄ›Å™en na praktickÃ© pouÅ¾itÃ­ <strong>univerzÃ¡lnÃ­ho makro procesoru M4</strong> (dÃ¡le jen M4) pomocÃ­ malÃ½ch, ukÃ¡zkovÃ½ch pÅ™Ã­kladÅ¯.
Popisuje tÃ©Å¾ teoretickÃ½ zÃ¡klad vÅ¡ech implementacÃ­.
CÃ­lem seriÃ¡lu je seznÃ¡mit ÄtenÃ¡Å™e s&nbsp;tÃ­mto <abbr title="m4 â€“ je program pÅ™Ã­kazovÃ© Å™Ã¡dky">nÃ¡strojem</abbr> a takÃ© programovacÃ­m <abbr title="M4 â€“ je programovacÃ­ jazyk">jazykem</abbr>.<br>
<a href="#m4-hlavni-pouziti-m4" title="HlavnÃ­ pouÅ¾itÃ­ M4">Na co se pouÅ¾Ã­vÃ¡</a>, jak se v nÄ›m programuje a jakÃ© jsou jeho <a href="#m4-proc-generovat-kod-v-m4" title="ğŸ‘ ProÄ generovat kÃ³d v M4">vÃ½hody</a> a&nbsp;<a href="#m4-proc-se-vyhnout-m4" title="ğŸ‘ ProÄ se vyhnout M4">nevÃ½hody</a>.</p>
<div title="vÃ½sledkem seriÃ¡lu je Å¡ablona napsanÃ¡ v M4" class="rs-tip-major m4-tip">VÃ­cejazyÄnÃ½ seriÃ¡l â€<strong>GenerovÃ¡nÃ­ kÃ³du v M4</strong>â€œ je generovÃ¡n M4 skripty<sup><a href="http://github.com/jkubin/m4root" title="GenerovÃ¡nÃ­ kÃ³du v M4">[1]</a></sup>,
kterÃ© (moÅ¾nÃ¡) usnadnÃ­ psanÃ­ ÄlÃ¡nkÅ¯ a&nbsp;seriÃ¡lÅ¯ pro <a href="https://www.root.cz/" title="Root.cz â€“ informace nejen ze svÄ›ta Linuxu">www.root.cz</a> takÃ© jinÃ½m autorÅ¯m.</div>
<p>ÃšvodnÃ­ dÃ­l popisuje zÃ¡kladnÃ­ principy jazyka na jednoduchÃ½ch pÅ™Ã­kladech.
VÅ¡echny pÅ™Ã­klady pouÅ¾Ã­vajÃ­ pÅ™episovacÃ­ pravidla <a href="#m4-bezkontextova-gramatika" title="BezkontextovÃ¡ gramatika">bezkontextovÃ© gramatiky</a>.
PozdÄ›ji se nauÄÃ­me pouÅ¾Ã­vat <a href="#m4-vystupni-fronty" title="VÃ½stupnÃ­ fronty">vÃ½stupnÃ­ fronty</a>,
<a href="#m4-automaty" title="Automaty">automaty</a>, asociativnÃ­ pamÄ›ti, zÃ¡sobnÃ­ky a&nbsp;zÃ¡sobnÃ­kovÃ© automaty.
NauÄÃ­me se takÃ© psÃ¡t <a href="#m4-testovaci-automat" title="TestovacÃ­ automat">testovacÃ­ automaty</a> pro testovÃ¡nÃ­ vstupnÃ­ch dat.</p>
<h3 id="m4-priklady-pro-ctenare"><a href="#m4-priklady-pro-ctenare" title="âš“">1.1</a>&nbsp;&nbsp;PÅ™Ã­klady pro ÄtenÃ¡Å™e&nbsp;<a href="#m4-toc-priklady-pro-ctenare" title="Obsah" class="m4-jmp">â˜°</a></h3>
<p>PÅ™Ã­klady pro ÄtenÃ¡Å™e tvoÅ™Ã­ komplementÃ¡rnÃ­ ÄÃ¡st seriÃ¡lu a&nbsp;budou do jistÃ© mÃ­ry vytvÃ¡Å™eny na zÃ¡kladÄ› podnÄ›tÅ¯ v&nbsp;diskuzi pod ÄlÃ¡nkem.
Na zaÄÃ¡tku kaÅ¾dÃ©ho dÃ­lu je popsÃ¡na nÄ›jakÃ¡ ÄÃ¡st jazyka M4 doplnÄ›nÃ¡ sadou pÅ™Ã­kladÅ¯ na konci.
KaÅ¾dÃ½ dÃ­l je moÅ¾nÃ© ÄÃ­st v&nbsp;libovolnÃ©m poÅ™adÃ­.</p>
<ul>
<li><a href="#m4-priklady-generovani-kodu" title="PÅ™Ã­klady generovÃ¡nÃ­ kÃ³du">PÅ™Ã­klady generovÃ¡nÃ­ kÃ³du</a></li>
<li><a href="#m4-priklady-preprocesoru" title="PÅ™Ã­klady preprocesoru">PÅ™Ã­klady preprocesoru</a></li>
<li><a href="#m4-m4-priklady" title="M4 â€“ pÅ™Ã­klady">M4 â€“ pÅ™Ã­klady</a></li>
<li><a href="#m4-proc-pouzivat-m4-a-proc-ne" title="ProÄ pouÅ¾Ã­vat M4 a proÄ ne?">ProÄ pouÅ¾Ã­vat M4 a proÄ ne?</a></li>
<li><a href="http://github.com/jkubin/m4root" title="GenerovÃ¡nÃ­ kÃ³du v M4">http://github.com/jkubin/m4root</a> â€“ sloÅ¾itÄ›jÅ¡Ã­ projekt generujÃ­cÃ­ HTML tohoto seriÃ¡lu</li>
</ul>
<h2 id="m4-historie-makro-jazyku"><a href="#m4-historie-makro-jazyku" title="âš“">2</a>&nbsp;&nbsp;Historie makro jazykÅ¯&nbsp;<a href="#m4-toc-historie-makro-jazyku" title="Obsah" class="m4-jmp">â˜°</a></h2>
<p>Makro jazyky byly vynalezeny v dobÄ›, kdy dominoval jazyk symbolickÃ½ch instrukcÃ­ (<abbr title="Jazyk SymbolickÃ½ch Adres (assembler)">JSA</abbr>, assembler).
ZÃ¡pis kÃ³du <abbr title="Jazyk SymbolickÃ½ch Adres (assembler)">JSA</abbr> uÅ¾ nebyl tak pracnÃ½, protoÅ¾e bylo moÅ¾nÃ© seskupit opakovanÃ© sekvence instrukcÃ­ do jednoho slova, do jednÃ© <strong>makro instrukce</strong> s parametry.
PozdÄ›ji byly pouÅ¾ity k rozÅ¡Ã­Å™enÃ­ kompilovanÃ½ch programovacÃ­ch jazykÅ¯, protoÅ¾e umoÅ¾nily psÃ¡t zdrojovÃ½ kÃ³d na vyÅ¡Å¡Ã­ Ãºrovni abstrakce neÅ¾ samotnÃ½ programovacÃ­ jazyk.</p>
<h3 id="m4-gpm-general-purpose-macro-genera"><a href="#m4-gpm-general-purpose-macro-genera" title="âš“">Â»</a>&nbsp;GPM (General Purpose Macro-generator)</h3>
<p>ZÃ¡kladnÃ­ myÅ¡lenku pÅ™episovÃ¡nÃ­ textovÃ½ch Å™etÄ›zcÅ¯ s&nbsp;argumenty, kterÃ© se pÅ™epÃ­Å¡Ã­ do dalÅ¡Ã­ch rekurzivnÄ› pÅ™episovatelnÃ½ch Å™etÄ›zcÅ¯ pÅ™edstavil
<a href="https://en.wikipedia.org/wiki/Christopher_Strachey" title="Wikipedie"><span class="rs-person">Christopher Strachey</span></a> ve svÃ©m
<abbr title="General Purpose Macro-generator">GPM</abbr><sup><a href="http://dx.doi.org/10.1093/comjnl/8.3.225" title="A&nbsp;General Purpose Macro-generator">[2]</a></sup> v&nbsp;roce 1965.
DalÅ¡Ã­ generace makro procesorÅ¯ M3 a&nbsp;M4 pÅ¯vodnÃ­ <abbr title="General Purpose Macro-generator">GPM</abbr> v&nbsp;podstatÄ› uÅ¾ jen rozÅ¡iÅ™ovaly.
ZÃ¡kladnÃ­ myÅ¡lenka pÅ¯vodnÃ­ho nÃ¡vrhu ale zÅ¯stala stejnÃ¡.</p>
<h3 id="m4-m3"><a href="#m4-m3" title="âš“">Â»</a>&nbsp;M3</h3>
<p><a href="https://cs.wikipedia.org/wiki/Dennis_Ritchie" title="Wikipedie"><span class="rs-person">Dennis Ritchie</span></a> pÅ™evzal zÃ¡kladnÃ­ myÅ¡lenku <abbr title="General Purpose Macro-generator">GPM</abbr> a&nbsp;napsal vylepÅ¡enÃ½ makro procesor pro generovÃ¡nÃ­ zdrojovÃ©ho kÃ³du programovacÃ­ho jazyka C (1972), kterÃ½ sÃ¡m navrhl.
NovÃ½ <strong class="m4-un">m</strong>akroprocesor napsal pro minipoÄÃ­taÄ AP-<strong class="m4-un">3</strong> â€“ odtud jmÃ©no <strong>M3</strong>.
Tento pÅ™Ã­mÃ½ pÅ™edchÅ¯dce souÄasnÃ©ho M4 dokÃ¡zal vÃ½raznÄ› uÅ¡etÅ™it tÄ›Å¾kou a&nbsp;ÄasovÄ› nÃ¡roÄnou prÃ¡ci, ÄÃ­mÅ¾ zaujal vÃ½vojÃ¡Å™e programujÃ­cÃ­ v&nbsp;jinÃ½ch jazycÃ­ch (<abbr title="FORmula TRANslation">FORTRAN</abbr>, <abbr title="COmmon Business-Oriented Language">COBOL</abbr>, <abbr title="Programming Language One">PL/I</abbr>, â€¦).
VÃ½vojÃ¡Å™i upravovali M3 pro tyto jazyky ÄÃ­mÅ¾ ho promÄ›nili na univerzÃ¡lnÄ› pouÅ¾itelnÃ½ makro procesor M4.</p>
<div title="m4 âˆˆ {mnoÅ¾ina nÃ¡strojÅ¯ UNIX-u}" class="rs-tip-major m4-tip"><span class="rs-person">Dennis Ritchie</span> byl takÃ© spolutvÅ¯rcem operaÄnÃ­ho systÃ©mu UNIX a&nbsp;proto:<ul>
<li>M4 je minimalistickÃ½ a&nbsp;rychlÃ½, <a href="https://cs.wikipedia.org/wiki/Filosofie_Unixu" title="Filosofie UNIX-u">dÄ›lÃ¡ jednu vÄ›c a&nbsp;tu dÄ›lÃ¡ dobÅ™e</a></li>
<li>vÃ½hradnÄ› spolÃ©hÃ¡ na neinteraktivnÃ­ rozhranÃ­ pÅ™Ã­kazovÃ© Å™Ã¡dky</li>
<li>parametry a&nbsp;zÃ¡vislosti M4 skriptÅ¯ popisuje <code>Makefile</code></li>
<li>znakem <code>#</code> zaÄÃ­nÃ¡ jednoÅ™Ã¡dkovÃ½ komentÃ¡Å™ jako v&nbsp;UNIX-ovÃ©m shell-u</li>
<li>promÄ›nnÃ© <code>$@</code>, <code>$*</code>, <code>$#</code>, <code>$0</code>, <code>$1</code>, <code>$2</code>, â€¦ majÃ­ podobnÃ½ vÃ½znam jako v&nbsp;shell-u</li>
<li>oddÄ›lovaÄ argumentÅ¯ je ÄÃ¡rka</li>
</ul>
</div>
<p>Makro procesor M3 rozÅ¡Ã­Å™il takÃ© <span class="rs-person">Jim E. Weythman</span>, autor programovÃ© konstrukce, kterÃ¡ se pouÅ¾Ã­vÃ¡ tÃ©mÄ›Å™ v&nbsp;kaÅ¾dÃ©m M4 skriptu:</p>
<pre title="idiomatickÃ½ kÃ³d M4">
divert(-1)
â€¦
define(â€¦)
â€¦
divert(0)dnl
â€¦
</pre>
<div title="divert(-1), divert(0), divert(1), â€¦, divert(2147483647)" class="rs-tip-major m4-tip">KlÃ­ÄovÃ© slovo <code>divert(<a href="https://cs.wikipedia.org/wiki/Cel%C3%A9_%C4%8D%C3%ADslo" title="celÃ© ÄÃ­slo">â„¤</a>)</code> pÅ™epÃ­nÃ¡ vÃ½stupnÃ­ fronty.
Argument <code>-1</code> zcela vypne jakÃ½koliv textovÃ½ vÃ½stup.
Argument <code>0</code> pÅ™epne vÃ½stup na <code>stdout</code>.</div>
<h3 id="m4-m4"><a href="#m4-m4" title="âš“">Â»</a>&nbsp;M4</h3>
<p><a href="https://cs.wikipedia.org/wiki/Brian_Kernighan" title="Wikipedie"><span class="rs-person">Brian Kernighan</span></a> makro procesor M3 rozÅ¡Ã­Å™il na <a href="https://cs.wikipedia.org/wiki/Preprocesor" title="Wikipedie">preprocesor</a> jazyka FORTRAN 66,
aby mohl vytvoÅ™it hybridnÃ­ jazykovou nadstavbu pojmenovanou <abbr title="RATional FORtran"><strong>RATFOR</strong></abbr><sup><a href="https://wolfram.schneider.org/bsd/7thEdManVol2/ratfor/ratfor.pdf" title="RATFOR â€” A Preprocessor for a Rational Fortran">[3]</a></sup>.
ZÃ¡kladnÃ­ programovÃ© konstrukce tÃ©to nadstavby (podmÃ­nky, cykly) jsou stejnÃ© jako v&nbsp;jazyce C.
ProgramovÃ¡nÃ­ v&nbsp;RATFOR-u se tak podobÃ¡ programovÃ¡nÃ­ v&nbsp;â€cÃ©Äkuâ€œ.
Makro procesor zdrojovÃ½ kÃ³d pÅ™eklÃ¡dÃ¡ zpÃ¡tky do FORTRAN-u, potÃ© kompilÃ¡tor provede pÅ™eklad do strojovÃ©ho kÃ³du.</p>
<div title="M4 doplÅˆuje jazyk C" class="rs-tip-major m4-tip">VÅ¡imnÄ›te si <a href="#m4-ba-preprocesor-jazyka-c-a-m4" title="`' Preprocesor jazyka C a M4">tÃ©mÄ›Å™ dokonalÃ© symbiÃ³zy</a> s&nbsp;jazykem C<ul>
<li>direktivy <abbr title="Preprocesor jazyka C">CPP</abbr> <code>#define</code>, <code>#include</code>, <code>#ifdef</code>, â€¦ jsou pro M4 komentÃ¡Å™e</li>
<li>klÃ­ÄovÃ¡ slova oddÄ›lenÃ¡ od zÃ¡vorek mezerou, ztrÃ¡cÃ­ svÅ¯j pÅ¯vodnÃ­ vÃ½znam
<ul>
<li>M4 napÅ™Ã­klad ignoruje funkci <code>void define (char c, int i) {â€¦}</code></li>
</ul></li>
<li>argumenty maker oddÄ›lujÃ­ ÄÃ¡rky stejnÄ› jako argumenty funkcÃ­ jazyka&nbsp;C
<ul>
<li>je-li definovÃ¡no makro <code>FUNC(char c, int i)</code>, jeho promÄ›nnÃ© jsou:<br>
<code>$# â†’ 2</code>, <code>$0 â†’ FUNC</code>, <code>$1 â†’ char c</code>, <code>$2 â†’ int i</code>
</li>
</ul><li><strong>levÃ½</strong> <a href="#m4-rizeni-expanze-neterminalu" title="Å˜Ã­zenÃ­ expanze neterminÃ¡lÅ¯">Å™Ã­dÃ­cÃ­ znak</a> <code>`</code> pro neterminÃ¡ly nenÃ­ souÄÃ¡stÃ­ syntaxe rodiny jazykÅ¯&nbsp;C</li>
<li><strong>pravÃ½</strong> Å™Ã­dÃ­cÃ­ znak <code>'</code> nevadÃ­, nenÃ­-li souÄÃ¡stÃ­ makra
<ul><li>oba Å™Ã­dÃ­cÃ­ znaky lze skrÃ½t do uÅ¾ivatelsky definovanÃ½ch maker <code>LQ()</code>, <code>RQ()</code></li></ul></li>
<li>makra se pÃ­Å¡Ã­ <code>VELKYMI_PISMENY</code>, stejnÄ› jako <a href="https://cs.wikipedia.org/wiki/Termin%C3%A1ln%C3%AD_a_netermin%C3%A1ln%C3%AD_symbol" title="Wikipedie">neterminÃ¡lnÃ­ symboly</a>
<ul><li>tÃ­m je vymezen jejich jmennÃ½ prostor</li></ul></li>
</ul>
</div>
<p>UÅ¾ivatelskÃ½ manuÃ¡l<sup><a href="https://wolfram.schneider.org/bsd/7thEdManVol2/m4/m4.pdf" title="The M4 Macro Processor">[4]</a></sup> zmiÅˆuje jeÅ¡tÄ› dalÅ¡Ã­, zde neuvedenÃ© spoluautory.
Bylo by tedy znaÄnÄ› nespravedlivÃ© napsat, Å¾e autory makro procesoru M4 (1977) jsou <em>pouze</em> dva lidÃ©.</p>
<img src="../img/authors.jpg" alt="&#160;" width="960" height="400" id="m4-the-authors" title="Christopher Strachey, Dennis Ritchie, Brian Kernighan">
<p><em>ObrÃ¡zek <a href="#m4-the-authors" title="âš“">1</a>: Christopher Strachey<sup><a href="https://www.computerhope.com/people/christopher_strachey.htm" title="Christopher Strachey">[5]</a></sup>,
Dennis Ritchie<sup><a href="https://pc.zoznam.sk/novinka/zomrel-tvorca-unixu-jazyka-c" title="Dennis Ritchie">[6]</a></sup>,
Brian Kernighan<sup><a href="https://www.cs.cmu.edu/~mihaib/kernighan-interview/" title="Brian Kernighan">[7]</a></sup></em></p>
<h3 id="m4-gnu-m4"><a href="#m4-gnu-m4" title="âš“">Â»</a>&nbsp;GNU M4</h3>
<p>Dnes existuje nÄ›kolik implementacÃ­ liÅ¡Ã­cÃ­ se od pÅ¯vodnÃ­ implementace spÃ­Å¡e drobnostmi.
NejrozÅ¡Ã­Å™enÄ›jÅ¡Ã­ implementace M4 je <strong>GNU M4</strong> pouÅ¾Ã­vanÃ¡ pro <a href="https://en.wikipedia.org/wiki/GNU_Build_System" title="Wikipedie">Autotools</a>
a&nbsp;pro pÅ™eklad jednoduchÃ©ho konfiguraÄnÃ­ho souboru <code>sendmail.mc</code> na sloÅ¾itÃ½ <code>sendmail.cf</code>.
Autorem tÃ©to implementace z&nbsp;roku 1990 je <a href="https://www.seindal.dk/rene/gnu/"><span class="rs-person">RenÃ© Seindal</span></a>.
<abbr title="m4 s malÃ½m â€mâ€œ je nÃ¡stroj"><strong>m4</strong></abbr> nainstalujeme nÃ¡sledujÃ­cÃ­m pÅ™Ã­kazem:</p>
<pre id="m4-install" title="pÅ™Ã­kaz nainstaluje takÃ© dalÅ¡Ã­ balÃ­Äky">
~]# <strong>dnf -y install make m4 pinfo</strong>
</pre>
<p>PodrobnÃ½ popis klÃ­ÄovÃ½ch slov naleznete v&nbsp;dokumentaci<sup><a href="https://www.gnu.org/software/m4/manual/" title="GNU M4 - GNU macro processor">[8]</a></sup>:</p>
<pre>
~]$ <strong>pinfo m4</strong>
~]$ <strong>man m4</strong>
~]$ <strong>m4 --help</strong>
</pre>
<h2 id="m4-zaklady-jazyka-m4"><a href="#m4-zaklady-jazyka-m4" title="âš“">3</a>&nbsp;&nbsp;ZÃ¡klady jazyka M4&nbsp;<a href="#m4-toc-zaklady-jazyka-m4" title="Obsah" class="m4-jmp">â˜°</a></h2>
<p>ZÃ¡kladem jazyka M4 je <strong>bezkontextovÃ¡ gramatika</strong>, <strong>automaty</strong>, <strong>zÃ¡sobnÃ­ky</strong> a&nbsp;<strong>vÃ½stupnÃ­ fronty</strong>.
Pro pochopenÃ­ jazyka M4 je proto velmi dÅ¯leÅ¾itÃ© rozumÄ›t zÃ¡kladnÃ­m pojmÅ¯m teorie formÃ¡lnÃ­ch jazykÅ¯.
Co jsou <a href="https://cs.wikipedia.org/wiki/Termin%C3%A1ln%C3%AD_a_netermin%C3%A1ln%C3%AD_symbol" title="Wikipedie">terminÃ¡lnÃ­ symboly</a> (struÄnÄ› <strong>terminÃ¡ly</strong>) a neterminÃ¡lnÃ­ symboly (struÄnÄ› <strong>neterminÃ¡ly</strong>).
ZmÃ­nÄ›nÃ© pojmy si podrobnÄ›ji vysvÄ›tlÃ­me nÄ›kdy pozdÄ›ji.
CÃ­lem tohoto ÃºvodnÃ­ho dÃ­lu je hlavnÄ› ukÃ¡zat praktickÃ© pouÅ¾itÃ­ M4 na pÅ™Ã­kladech.</p>
<h3 id="m4-bezkontextova-gramatika"><a href="#m4-bezkontextova-gramatika" title="âš“">3.1</a>&nbsp;&nbsp;BezkontextovÃ¡ gramatika&nbsp;<a href="#m4-toc-bezkontextova-gramatika" title="Obsah" class="m4-jmp">â˜°</a></h3>
<p>BezkontextovÃ¡ gramatika (krÃ¡tce <abbr title="Context-Free Grammar â€“ bezkontextovÃ¡ gramatika">CFG</abbr>) je <a href="#m4-formalni-gramatika-chomskeho-typ" title="FormÃ¡lnÃ­ gramatika (ChomskÃ©ho typu)">formÃ¡lnÃ­ gramatika</a>, ve kterÃ© majÃ­ vÅ¡echna pÅ™episovacÃ­ pravidla tvar <code>A&nbsp;â†’&nbsp;Î²</code>.
NeterminÃ¡l <code>A</code> se pÅ™epÃ­Å¡e na libovolnÄ› dlouhÃ½ Å™etÄ›zec <abbr title="pravÃ¡ strana pÅ™episovacÃ­ho pravidla"><code>Î²</code></abbr> sloÅ¾enÃ½ z&nbsp;terminÃ¡lÅ¯ nebo neterminÃ¡lÅ¯.
<a href="https://en.wikipedia.org/wiki/Kleene_star" title="Wikipedie">Kleene hvÄ›zda</a> <code>*</code> znamenÃ¡, Å¾e se neterminÃ¡l <code>A</code> mÅ¯Å¾e pÅ™epsat na <abbr title="epsilon â€“ prÃ¡zdnÃ½ symbol"><code>Îµ</code></abbr>.</p>
<pre title="formÃ¡t pÅ™episovacÃ­ch pravidel bezkontextovÃ© gramatiky">
P: A â†’ Î²
   A âˆˆ N
   Î² âˆˆ (N âˆª Î£)*
</pre>
<h4 id="m4-prepisovaci-pravidla-m4"><a href="#m4-prepisovaci-pravidla-m4" title="âš“">Â»</a>&nbsp;PÅ™episovacÃ­ pravidla M4</h4>
<p>PÅ™episovacÃ­ pravidla M4 jsou stejnÃ¡ jako pÅ™episovacÃ­ pravidla bezkontextovÃ© gramatiky.</p>
<pre title="formÃ¡t pÅ™episovacÃ­ch pravidel M4">
# A â†’ Î²
define(`A', `Î²')

# A â†’ Îµ
define(`A')
define(`A', `')
</pre>
<p>VÅ¡echna klÃ­ÄovÃ¡ slova M4 jsou neterminÃ¡ly (makra), provedou nÄ›jakou akci (zmÄ›nÃ­ vnitÅ™nÃ­ stav makro procesoru) a pÅ™epÃ­Å¡Ã­ se na <abbr title="epsilon â€“ prÃ¡zdnÃ½ symbol"><code>Îµ</code></abbr>.
KlÃ­ÄovÃ¡ slova mohou bÃ½t pÅ™ejmenovÃ¡na.</p>
<pre title="vÅ¡echna klÃ­ÄovÃ¡ slova jazyka M4 jsou neterminÃ¡ly">
divert(â„¤) â†’ Îµ
define(`A', `Î²') â†’ Îµ
ifelse(`', `', `yes', `no') â†’ yes
â€¦
</pre>
<h4 id="m4-rizeni-expanze-neterminalu"><a href="#m4-rizeni-expanze-neterminalu" title="âš“">Â»</a>&nbsp;Å˜Ã­zenÃ­ expanze neterminÃ¡lÅ¯</h4>
<p>VÃ½chozÃ­ dvojice znakÅ¯ <code>`'</code> v&nbsp;M4 Å™Ã­dÃ­ expanzi neterminÃ¡lÅ¯.
KlÃ­ÄovÃ© slovo <code>changequote()</code> je mÅ¯Å¾e zmÄ›nit na jinÃ© znaky, napÅ™Ã­klad {<code>[]</code>, <strong><code>â‚â†</code></strong>, <code>ã€–ã€—</code>}.
NeterminÃ¡ly, kterÃ© nechceme (ihned) expandovat, jsou obklopeny touto dvojicÃ­ znakÅ¯.
PÅ™i prÅ¯chodu makro procesorem jsou vÅ¡echny symboly mezi touto dvojicÃ­ znakÅ¯ <strong class="m4-un">terminÃ¡lnÃ­mi symboly</strong> a vnÄ›jÅ¡Ã­ dvojice znakÅ¯ je odstranÄ›na.
DalÅ¡Ã­ prÅ¯chod jiÅ¾ zpÅ¯sobÃ­ expanzi pÅ¯vodnÄ› chrÃ¡nÄ›nÃ½ch neterminÃ¡lÅ¯.
Dvojice Å™Ã­dÃ­cÃ­ch znakÅ¯ se nastavuje na zaÄÃ¡tku koÅ™enovÃ©ho souboru.</p>
<h4 id="m4-automaty"><a href="#m4-automaty" title="âš“">3.2</a>&nbsp;&nbsp;Automaty&nbsp;<a href="#m4-toc-automaty" title="Obsah" class="m4-jmp">â˜°</a></h4>
<p>Automaty pouÅ¾Ã­vajÃ­ pÅ™episovacÃ­ pravidla gramatiky jako uzly a&nbsp;mÄ›nÃ­ svÃ© stavy podle vstupnÃ­ch symbolÅ¯.
AktuÃ¡lnÄ› pouÅ¾Ã­vanÃ© pÅ™episovacÃ­ pravidlo produkuje do vÃ½stupnÃ­ fronty (nebo do nÄ›kolika vÃ½stupnÃ­ch front)
specifickÃ½ kÃ³d, dokud automat nepÅ™ejde do jinÃ©ho uzlu s&nbsp;jinÃ½m pÅ™episovacÃ­m pravidlem.
Automaty slouÅ¾Ã­ jako â€pÅ™epÃ­naÄeâ€œ pravidel gramatiky.
<a href="#m4-generujici-automat" title="GenerujÃ­cÃ­ automat">GenerujÃ­cÃ­ automat</a> je v&nbsp;pÅ™Ã­loze.</p>
<h4 id="m4-vystupni-fronty"><a href="#m4-vystupni-fronty" title="âš“">3.3</a>&nbsp;&nbsp;VÃ½stupnÃ­ fronty&nbsp;<a href="#m4-toc-vystupni-fronty" title="Obsah" class="m4-jmp">â˜°</a></h4>
<p>VÃ½stupnÃ­ fronty jsou doÄasnÃ© ÃºloÅ¾iÅ¡tÄ› pro ÄÃ¡sti vÃ½slednÃ©ho kÃ³du.
Tyto ÄÃ¡sti vÃ½slednÃ©ho kÃ³du jsou produkovÃ¡ny pÅ™episovacÃ­mi pravidly gramatiky, kterÃ© pÅ™episujÃ­ vstupnÃ­ symboly.
KlÃ­ÄovÃ© slovo <code>divert(â„¤)</code> nastavuje aktuÃ¡lnÃ­ vÃ½stupnÃ­ frontu.
Na zÃ¡vÄ›r jsou vÅ¡echny neprÃ¡zdnÃ© fronty vypsÃ¡ny ve vzestupnÃ©m poÅ™adÃ­ na standardnÃ­ vÃ½stup a&nbsp;sloÅ¾Ã­ vÃ½slednÃ½ kÃ³d z&nbsp;ÄÃ¡stÃ­ kÃ³du.
<a href="#m4-html-vystupni-fronty" title="[] HTML â€“ vÃ½stupnÃ­ fronty">VÃ½stupnÃ­ fronty</a> jsou ukÃ¡zÃ¡ny v&nbsp;pÅ™Ã­loze.</p>
<div class="rs-tip-major m4-tip"><strong>ZÃ¡sobnÃ­ky</strong> si ukÃ¡Å¾eme pozdÄ›ji.</div>
<h2 id="m4-hlavni-pouziti-m4"><a href="#m4-hlavni-pouziti-m4" title="âš“">4</a>&nbsp;&nbsp;HlavnÃ­ pouÅ¾itÃ­ M4&nbsp;<a href="#m4-toc-hlavni-pouziti-m4" title="Obsah" class="m4-jmp">â˜°</a></h2>
<p>M4 se pouÅ¾Ã­vÃ¡ ke generovÃ¡nÃ­ zdrojovÃ©ho kÃ³du libovolnÃ©ho programovacÃ­ho jazyka nebo jako preprocesor jakÃ©hokoliv zdrojovÃ©ho kÃ³du.</p>
<h3 id="m4-generovani-kodu"><a href="#m4-generovani-kodu" title="âš“">4.1</a>&nbsp;&nbsp;GenerovÃ¡nÃ­ kÃ³du&nbsp;<a href="#m4-toc-generovani-kodu" title="Obsah" class="m4-jmp">â˜°</a></h3>
<p>M4 transformuje vstupnÃ­ data ze souborÅ¯ <abbr title="Macro Configuration"><code>.mc</code></abbr> na vÃ½slednÃ¡ data nÃ¡sledujÃ­cÃ­m pÅ™Ã­kazem:</p>
<pre id="m4-files-on-command-line" title="â† nejobecnÄ›jÅ¡Ã­.m4 â€¦ nejspeciÃ¡lnÄ›jÅ¡Ã­.m4 â†’">
~]$ <strong>m4 root.m4 stem.m4 branch.m4 leaf.m4 input1.mc input2.mc &gt; output.file</strong>
</pre>
<p>BÄ›hem naÄÃ­tÃ¡nÃ­ souborÅ¯ jsou provÃ¡dÄ›ny dvÄ› zÃ¡kladnÃ­ operace:</p>
<ol>
<li>ÄtenÃ­ transformaÄnÃ­ch pravidel ze souborÅ¯ s&nbsp;pÅ™Ã­ponou <code>.m4</code></li>
<li>expanze maker uvnitÅ™ souborÅ¯ s&nbsp;pÅ™Ã­ponou <code>.mc</code></li>
</ol>
<p>Soubory <code>input1.mc</code> a&nbsp;<code>input2.mc</code> obsahujÃ­ <strong>vstupnÃ­ data</strong> ve specifickÃ©m formÃ¡tu, kterÃ½ umoÅ¾Åˆuje jejich transformaci na <strong>vÃ½stupnÃ­ data</strong> podle pravidel v&nbsp;pÅ™edchozÃ­ch <code>.m4</code> souborech.
DatovÃ© soubory <code>.mc</code> obvykle neobsahujÃ­ Å¾Ã¡dnÃ¡ transformaÄnÃ­ pravidla.</p>
<p>VstupnÃ­ data mohou takÃ© pÅ™ichÃ¡zet z kolony:</p>
<pre title="vstupnÃ­ kÃ³d â†’ generovÃ¡nÃ­ zdrojovÃ©ho kÃ³du â†’ soubor">
~]$ <strong>cat input.mc | m4 root.m4 stem.m4 branch.m4 leaf.m4 - &gt; output.file</strong>
</pre>
<pre title="vstupnÃ­ kÃ³d â†’ generovÃ¡nÃ­ zdrojovÃ©ho kÃ³du â†’ kompilace">
~]$ <strong>cat input.mc | m4 root.m4 stem.m4 branch.m4 leaf.m4 - | gcc -x c -o progr -</strong>
</pre>
<p>VyzkouÅ¡ejte: <a href="#m4-priklady-generovani-kodu" title="PÅ™Ã­klady generovÃ¡nÃ­ kÃ³du">PÅ™Ã­klady generovÃ¡nÃ­ kÃ³du</a></p>
<h4 id="m4-preprocesor"><a href="#m4-preprocesor" title="âš“">4.2</a>&nbsp;&nbsp;Preprocesor&nbsp;<a href="#m4-toc-preprocesor" title="Obsah" class="m4-jmp">â˜°</a></h4>
<p>M4 mÅ¯Å¾e pracovat v&nbsp;reÅ¾imu preprocesoru.
VstupnÃ­ zdrojovÃ½ kÃ³d jÃ­m prochÃ¡zÃ­ beze zmÄ›ny s&nbsp;vÃ½jimkou neterminÃ¡lnÃ­ch symbolÅ¯.
NalezenÃ© neterminÃ¡ly jsou expandovÃ¡ny na terminÃ¡ly a&nbsp;odchÃ¡zÃ­ spolu se zdrojovÃ½m kÃ³dem na vÃ½stup.
M4 mÅ¯Å¾e rozÅ¡Ã­Å™it jakÃ½koliv jinÃ½ jazyk, kde je preprocesor nedostateÄnÃ½ (bez rekurze) nebo Å¾Ã¡dnÃ½.
DÅ¯leÅ¾itÃ© je zvolit vhodnÃ½ levÃ½ znak pro Å™Ã­zenÃ­ expanze neterminÃ¡lÅ¯, kterÃ½ nesmÃ­ kolidovat se znakem vstupnÃ­ho zdrojovÃ©ho kÃ³du.
Kolize znaku je ale snadno Å™eÅ¡itelnÃ¡.</p>
<pre title="M4 jako preprocesor â€“ obecnÄ›">
~]$ <strong>m4 root.m4 stem.m4 branch.m4 leaf.m4 file.c &gt; preproc.file.c</strong>
</pre>
<pre title="M4 jako preprocesor â€“ bez doÄasnÃ©ho souboru">
~]$ <strong>m4 root.m4 stem.m4 branch.m4 leaf.m4 file.c | gcc -x c -o progr -</strong>
</pre>
<p>M4 v&nbsp;reÅ¾imu preprocesoru mÅ¯Å¾e bÃ½t souÄÃ¡stÃ­ kolony.
KonfliktnÃ­ znak <code>`</code> ze vstupnÃ­ho zdrojovÃ©ho kÃ³du je skryt do makra, napÅ™Ã­klad <code>`'LQ()</code>.
PrÃ¡zdnÃ½ pÃ¡r Å™Ã­dÃ­cÃ­ch znakÅ¯ <code>`'</code> pÅ™ed makrem slouÅ¾Ã­ jako <a href="#m4-h-zavorky-h-dnl" title="[] .h â€“ zÃ¡vorky [], [,], [#], [dnl]">oddÄ›lovaÄ symbolÅ¯</a>.</p>
<pre title="M4 jako preprocesor s Å™Ã­dÃ­cÃ­mi znaky: `'">
~]$ <strong>sed 's/`/`'\''<code>LQ()</code>/g' any_src.code | m4 rootq.m4 leaf.m4 - | gcc â€¦</strong>
</pre>
<p>PÅ™i prÅ¯chodu zdrojovÃ©ho kÃ³du makro procesorem se makro <code>`'LQ()</code> pÅ™epÃ­Å¡e zpÃ¡tky na pÅ¯vodnÃ­ znak <code>`</code> a&nbsp;prÃ¡zdnÃ½ pÃ¡r <code>`'</code> je odstranÄ›n.
PouÅ¾ijeme-li pro Å™Ã­zenÃ­ expanze neterminÃ¡lÅ¯ hranatÃ© zÃ¡vorky, skryjeme stejnÃ½m zpÅ¯sobem levou <code>[</code> hranatou zÃ¡vorku.</p>
<pre title="M4 jako preprocesor s Å™Ã­dÃ­cÃ­mi znaky: []">
~]$ <strong>sed 's/\[/<code>[]LB()</code>/g' any_src.code | m4 rootb.m4 leaf.m4 - | gcc â€¦</strong>
</pre>
<p>Pro Å™Ã­zeni expanze neterminÃ¡lÅ¯ lze pouÅ¾Ã­t netisknutelnÃ© znaky <strong><code>â‚</code></strong> (<samp>0x02</samp>) a <strong><code>â†</code></strong> (<samp>0x06</samp>).
Tyto znaky nemohou kolidovat s tisknutelnÃ½mi znaky zdrojovÃ©ho kÃ³du.</p>
<pre title="M4 jako preprocesor s Å™Ã­dÃ­cÃ­mi znaky: â‚â†">
~]$ <strong>m4 rootn.m4 leaf.m4 any_src.code | gcc â€¦</strong>
</pre>
<p>VyzkouÅ¡ejte: <a href="#m4-priklady-preprocesoru" title="PÅ™Ã­klady preprocesoru">PÅ™Ã­klady preprocesoru</a></p>
<h4 id="m4-smiseny-rezim"><a href="#m4-smiseny-rezim" title="âš“">Â»</a>&nbsp;SmÃ­Å¡enÃ½ reÅ¾im</h4>
<p>SmÃ­Å¡enÃ½ reÅ¾im je kombinacÃ­ pÅ™edchozÃ­ch reÅ¾imÅ¯ a&nbsp;je pouÅ¾Ã­vÃ¡n hlavnÄ› na pokusy.
Data nejsou oddÄ›lena od transformaÄnÃ­ch pravidel.
ListovÃ½ soubor <code>leaf.m4</code> obsahuje definice tÄ›chto pravidel spolu se vstupnÃ­mi daty.</p>
<pre title="jak se nauÄit M4">
~]$ <strong>m4 root.m4 leaf.m4</strong>
</pre>
<p>VyzkouÅ¡ejte: <a href="#m4-m4-priklady" title="M4 â€“ pÅ™Ã­klady">M4 â€“ pÅ™Ã­klady</a></p>
<h2 id="m4-predpoklady-pro-zvladnuti-m4"><a href="#m4-predpoklady-pro-zvladnuti-m4" title="âš“">5</a>&nbsp;&nbsp;PÅ™edpoklady pro zvlÃ¡dnutÃ­ M4&nbsp;<a href="#m4-toc-predpoklady-pro-zvladnuti-m4" title="Obsah" class="m4-jmp">â˜°</a></h2>
<p>Pro ÃºspÄ›Å¡nÃ© zvlÃ¡dnutÃ­ tohoto makro-jazyka je dÅ¯leÅ¾itÃ© splnit nÄ›kolik pÅ™edpokladÅ¯.
M4 nenÃ­ jednoduchÃ½ jazyk, protoÅ¾e nenÃ­ moÅ¾nÃ© v&nbsp;nÄ›m myslet a&nbsp;programovat jako v&nbsp;bÄ›Å¾nÃ©m programovacÃ­m jazyce.
NejdÅ¯leÅ¾itÄ›jÅ¡Ã­ je uvÄ›domit si, Å¾e se v&nbsp;nÄ›m programujÃ­ pÅ™episovacÃ­ pravidla gramatiky.
KaÅ¾dÃ½ Å™etÄ›zec je buÄ terminÃ¡lnÃ­ nebo neterminÃ¡lnÃ­ symbol vÄetnÄ› vÅ¡ech klÃ­ÄovÃ½ch slov jazyka (<code>#</code> a <code>,</code> jsou speciÃ¡lnÃ­ pÅ™Ã­pady neterminÃ¡lÅ¯).</p>
<div class="rs-tip-major m4-tip">M4 zÃ¡mÄ›rnÄ› nemÃ¡ klÃ­ÄovÃ¡ slova pro <strong>cykly</strong> (<code>for</code>/<code>while</code>), protoÅ¾e jeho zÃ¡klad je zcela jinÃ½, neÅ¾ jakÃ½ majÃ­ procedurÃ¡lnÃ­ nebo funkcionÃ¡lnÃ­ jazyky.<hr>
<ul>
<li><strong>cykly</strong> jsou pouze levo-rekurzivnÃ­ nebo pravo-rekurzivnÃ­</li>
<li><strong>vÄ›tvÃ­</strong> se <a href="#m4-vetveni-gramatikou" title="[] VÄ›tvenÃ­ gramatikou">Å™etÄ›zenÃ­m symbolÅ¯</a> nebo klÃ­ÄovÃ½mi slovy <code>ifelse()</code>, <code>ifdef()</code></li>
</ul>
</div>
<h3 id="m4-zaklady-gramatik"><a href="#m4-zaklady-gramatik" title="âš“">5.1</a>&nbsp;&nbsp;ZÃ¡klady gramatik&nbsp;<a href="#m4-toc-zaklady-gramatik" title="Obsah" class="m4-jmp">â˜°</a></h3>
<p>ZÃ¡kladem vÅ¡ech gramatik jsou pÅ™episovacÃ­ pravidla, jejichÅ¾ podobu obecnÄ› popisuje:</p>
<h4 id="m4-formalni-gramatika-chomskeho-typ"><a href="#m4-formalni-gramatika-chomskeho-typ" title="âš“">Â»</a>&nbsp;FormÃ¡lnÃ­ gramatika (ChomskÃ©ho typu)</h4>
<pre>
G = (N, Î£, P, S)
N: neprÃ¡zdnÃ¡ koneÄnÃ¡ mnoÅ¾ina neterminÃ¡lnÃ­ch symbolÅ¯
Î£: koneÄnÃ¡ mnoÅ¾ina terminÃ¡lnÃ­ch symbolÅ¯
   N âˆ© Î£ = Ã¸
P: koneÄnÃ¡ mnoÅ¾ina pÅ™episovacÃ­ch pravidel
   (N âˆª Î£)* N (N âˆª Î£)* â†’ (N âˆª Î£)*
S: je poÄÃ¡teÄnÃ­ (startovacÃ­) symbol
   S âˆˆ N
</pre>
<p><a href="https://cs.wikipedia.org/wiki/FormÃ¡lnÃ­_gramatika" title="Wikipedie">FormÃ¡lnÃ­ gramatika</a> popisuje <a href="https://cs.wikipedia.org/wiki/Chomsk%C3%A9ho_hierarchie" title="ChomskÃ©ho hierarchie">podmnoÅ¾iny</a> pÅ™episovacÃ­ch pravidel <a href="https://cs.wikipedia.org/wiki/Form%C3%A1ln%C3%AD_jazyk" title="Wikipedie">formÃ¡lnÃ­ho jazyka</a>.
Jedna z&nbsp;podmnoÅ¾in se jmenuje <a href="https://cs.wikipedia.org/wiki/Bezkontextov%C3%A1_gramatika" title="Wikipedie">bezkontextovÃ¡ gramatika</a>, krÃ¡tce <abbr title="Context-Free Grammar â€“ bezkontextovÃ¡ gramatika">CFG</abbr>.
PÅ™episovacÃ­ pravidla CFG pracujÃ­ stejnÄ› jako pÅ™episovacÃ­ pravidla jazyka M4.
NÄ›kterÃ½ z&nbsp;nÃ¡sledujÃ­cÃ­ch dÃ­lÅ¯ seriÃ¡lu se podrobnÄ›ji zamÄ›Å™Ã­ na formÃ¡lnÃ­ gramatiky.</p>
<h4 id="m4-zaklady-automatu"><a href="#m4-zaklady-automatu" title="âš“">5.2</a>&nbsp;&nbsp;ZÃ¡klady automatÅ¯&nbsp;<a href="#m4-toc-zaklady-automatu" title="Obsah" class="m4-jmp">â˜°</a></h4>
<p>Schopnost pouÅ¾Ã­vat pÅ™evÃ¡Å¾nÄ› dvoustavovÃ© automaty je zÃ¡sadnÃ­ vÄ›c pro psanÃ­ jednoduchÃ½ch M4 skriptÅ¯, protoÅ¾e pÅ™evÃ¡Å¾nÃ¡ vÄ›tÅ¡ina skriptÅ¯ pouÅ¾Ã­vÃ¡ <a href="#m4-c-maly-automat" title="[] C â€“ malÃ½ automat">malÃ© automaty</a>.</p>
<h4 id="m4-testovaci-automat"><a href="#m4-testovaci-automat" title="âš“">Â»</a>&nbsp;TestovacÃ­ automat</h4>
<p>PoÅ™adÃ­ vstupnÃ­ch symbolÅ¯ nebo jejich kontext lze otestovat automatem.
SplÅˆujÃ­-li vstupnÃ­ symboly poÅ¾adovanÃ© vlastnosti, automat skonÄÃ­ v&nbsp;uzlu s&nbsp;dvojitÃ½m krouÅ¾kem (oznaÄuje akceptujÃ­cÃ­ stav nebo stavy).</p>
<img src="../img/dfa.png" alt="&#160;" width="274" height="155" id="m4-dfa-img" title="deterministickÃ½ koneÄnÃ½ automat">
<p><em>ObrÃ¡zek <a href="#m4-dfa-img" title="âš“">2</a>: PÅ™Ã­klad automatu<sup><a href="https://cs.wikipedia.org/wiki/Teorie_automat%C5%AF" title="Teorie automatÅ¯">[9]</a></sup> akceptujÃ­cÃ­ sudÃ½ poÄet (Å¾Ã¡dnÃ½ je takÃ© sudÃ½) symbolÅ¯ <code>0</code>, ignorujÃ­cÃ­ symboly <code>1</code>.
Automat je shodnÃ½ s&nbsp;regulÃ¡rnÃ­m vÃ½razem <code>(1*01*01*)*</code>.</em></p>
<p>PÅ™edchozÃ­ automat lze zapsat jako ASCII art doprovÃ¡zejÃ­cÃ­ M4 skript:</p>
<pre title="jak dokumentovat M4 kÃ³d">
#          ____1
#         |   /
#      ___V__/   0    ____
# ---&gt;// S1 \\------&gt;/ S2 \---.1
#     \\____//&lt;------\____/&lt;--'
#                0
</pre>
<h4 id="m4-generujici-automat"><a href="#m4-generujici-automat" title="âš“">Â»</a>&nbsp;GenerujÃ­cÃ­ automat</h4>
<p>VstupnÃ­ symboly mÄ›nÃ­ uzly automatu, ÄÃ­mÅ¾ zÃ¡roveÅˆ mÄ›nÃ­ pÅ™episovacÃ­ pravidla pro generovÃ¡nÃ­ kÃ³du.
<a href="#m4-json-generujici-automat" title="[] JSON â€“ generujÃ­cÃ­ automat">Tento pÅ™Ã­klad</a> naleznete v&nbsp;pÅ™Ã­loze:</p>
<pre title="ASCII-art generujÃ­cÃ­ho automatu">
#      _______      ___________
# ---&gt;/ ERROR \---&gt;/ NEXT_ITEM \---.
#     \_______/    \___________/&lt;--'
</pre>
<p>PrvnÃ­ symbol ve stavu <code>ERROR</code> vygeneruje zÃ¡hlavÃ­ a&nbsp;prvnÃ­ poloÅ¾ku.
PotÃ© automat pÅ™ejde do stavu <code>NEXT_ITEM</code>, ve kterÃ©m se pÅ™idÃ¡vajÃ­ dalÅ¡Ã­ poloÅ¾ky.
Automat zÅ¯stÃ¡vÃ¡ v tomto stavu, dokud nejsou zpracovÃ¡na vÅ¡echna data.</p>
<h4 id="m4-gnu-make"><a href="#m4-gnu-make" title="âš“">5.3</a>&nbsp;&nbsp;(GNU) make&nbsp;<a href="#m4-toc-gnu-make" title="Obsah" class="m4-jmp">â˜°</a></h4>
<p>DobÅ™e navrÅ¾enÃ½ generÃ¡tor kÃ³du se obvykle sklÃ¡dÃ¡ z&nbsp;nÄ›kolika menÅ¡Ã­ch souborÅ¯, jejichÅ¾ poÅ™adÃ­, zÃ¡vislosti a&nbsp;parametry se zapisujÃ­ do souboru <code>Makefile</code>.
DobrÃ¡ znalost tvorby <code>Makefile</code> je proto zÃ¡kladnÃ­m pÅ™edpokladem pro zvlÃ¡dnutÃ­ M4.
ÄŒtenÃ­ a ÃºdrÅ¾ba zdrojovÃ©ho kÃ³du celkovÄ› zabere vÅ¾dy vÃ­ce Äasu neÅ¾ jeho tvorba.
DobÅ™e strukturovanÃ½ <code>Makefile</code> proto zÃ¡sadnÃ­m zpÅ¯sobem pÅ™ispÃ­vÃ¡ k&nbsp;celkovÃ© pÅ™ehlednosti vÃ½slednÃ©ho generÃ¡toru kÃ³du.</p>
<div title="vÃ­ce v kapitole: â€PracovnÃ­ postupâ€œ" class="rs-tip-major m4-tip">SpouÅ¡tÄ›nÃ­ <code>make</code><sup><a href="https://www.gnu.org/software/make/manual/make.html" title="GNU Make Manual">[10]</a></sup> z&nbsp;editoru kÃ³du pomocÃ­ vhodnÃ© klÃ¡vesovÃ© zkratky zÃ¡sadnÄ› urychluje vÃ½voj M4 kÃ³du.
Soubor <code>~/.vimrc</code> obsahuje <code>nnoremap &lt;c-j&gt; :make&lt;cr&gt;</code>.</div>
<h4 id="m4-vim"><a href="#m4-vim" title="âš“">5.4</a>&nbsp;&nbsp;Vim&nbsp;<a href="#m4-toc-vim" title="Obsah" class="m4-jmp">â˜°</a></h4>
<p>ZvlÃ¡dnutÃ­ editoru Vim<sup><a href="https://www.vim.org/" title="Vim â€“ vÅ¡udypÅ™Ã­tomnÃ½ textovÃ½ editor">[11]</a></sup> je dÅ¯leÅ¾itÃ½m pÅ™edpokladem pro pohodlÃ­ a&nbsp;rychlost psanÃ­ kÃ³du M4.
Vim zkratky, definovanÃ© klÃ­ÄovÃ½m slovem <code>iabbrev</code>, uÅ¡etÅ™Ã­ velkÃ© mnoÅ¾stvÃ­ zbyteÄnÄ› napsanÃ©ho textu.
Tyto zkratky takÃ© vÃ½znamnÄ› sniÅ¾ujÃ­ vÃ½skyt tÃ©mÄ›Å™ neviditelnÃ½ch chyb zpÅ¯sobenÃ½ch nepÃ¡rovou zÃ¡vorkou, ÄÃ­mÅ¾ Å¡etÅ™Ã­ ztracenÃ½ Äas vynaloÅ¾enÃ½ na ladÄ›nÃ­ kÃ³du.</p>
<h4 id="m4-talent-a-cas"><a href="#m4-talent-a-cas" title="âš“">5.5</a>&nbsp;&nbsp;Talent a Äas&nbsp;<a href="#m4-toc-talent-a-cas" title="Obsah" class="m4-jmp">â˜°</a></h4>
<p>M4 nejde zvlÃ¡dnout pÅ™es vÃ­kend, zvlÃ¡Å¡tÄ› chybÃ­-li zÃ¡klady<sup><a href="https://is.muni.cz/elportal/estud/fi/js06/ib005/Formalni_jazyky_a_automaty_I.pdf" title="Automaty a&nbsp;formÃ¡lnÃ­ jazyky I">[12]</a></sup>
<a href="https://cs.wikipedia.org/wiki/Teorie_automat%C5%AF" title="Wikipedie">teorie&nbsp;automatÅ¯</a> a&nbsp;<a href="https://cs.wikipedia.org/wiki/Form%C3%A1ln%C3%AD_gramatika" title="Wikipedie">formÃ¡lnÃ­ch&nbsp;gramatik</a>.
Pro zvlÃ¡dnutÃ­ M4 je nutnÃ© â€odpÅ™emÃ½Å¡let siâ€œ delÅ¡Ã­ obdobÃ­ a&nbsp;napsat velkÃ© mnoÅ¾stvÃ­ Å¡patnÃ©ho (sloÅ¾itÃ©ho) M4 kÃ³du, kterÃ½ z&nbsp;vlastnÃ­ vÅ¯le pÅ™epÃ­Å¡ete kvÅ¯li lepÅ¡Ã­mu nÃ¡padu.
TÃ­mto zpÅ¯sobem je moÅ¾nÃ© postupnÄ› zÃ­skat urÄitou praxi.</p>
<blockquote title="M4 je tÄ›Å¾kÃ½ âš  jazyk!">Disclaimer ğŸ•±: <strong>VÄ›tÅ¡Ã­ M4 projekty vyÅ¾adujÃ­ praxi!</strong></blockquote>

<!-- article references -->
<h2 id="m4-refs"><a href="#m4-refs" title="âš“">6</a>&nbsp;&nbsp;Odkazy&nbsp;<a href="#m4-toc-refs" title="Obsah" class="m4-jmp">â˜°</a></h2>
<ol>
<li id="m4-ref1"><strong>GenerovÃ¡nÃ­ kÃ³du v M4</strong>, vÃ­cejazyÄnÃ¡ Å¡ablona s&nbsp;pÅ™Ã­klady pro <a href="https://www.root.cz" title="Root.cz â€“ informace nejen ze svÄ›ta Linuxu">www.root.cz</a><br>
<a href="http://github.com/jkubin/m4root">http://github.com/jkubin/m4root</a></li>
<li id="m4-ref2"><strong>A&nbsp;General Purpose Macro-generator</strong>, Computer Journal 8, 3 (1965), 225â€“41<br>
<a href="http://dx.doi.org/10.1093/comjnl/8.3.225">http://dx.doi.org/10.1093/comjnl/8.3.225</a></li>
<li id="m4-ref3"><strong>RATFOR â€” A Preprocessor for a Rational Fortran</strong>, Brian W. Kernighan<br>
<a href="https://wolfram.schneider.org/bsd/7thEdManVol2/ratfor/ratfor.pdf">https://wolfram.schneider.org/bsd/7thEdManVol2/ratfor/ratfor.pdf</a></li>
<li id="m4-ref4"><strong>The M4 Macro Processor</strong>, Bell Laboratories (1977)<br>
<a href="https://wolfram.schneider.org/bsd/7thEdManVol2/m4/m4.pdf">https://wolfram.schneider.org/bsd/7thEdManVol2/m4/m4.pdf</a></li>
<li id="m4-ref5"><strong>Christopher Strachey</strong>, Computer Hope â€“ Free computer help since 1998<br>
<a href="https://www.computerhope.com/people/christopher_strachey.htm">https://www.computerhope.com/people/christopher_strachey.htm</a></li>
<li id="m4-ref6"><strong>Dennis Ritchie</strong>, Zomrel tvorca Unixu a&nbsp;jazyka&nbsp;C<br>
<a href="https://pc.zoznam.sk/novinka/zomrel-tvorca-unixu-jazyka-c">https://pc.zoznam.sk/novinka/zomrel-tvorca-unixu-jazyka-c</a></li>
<li id="m4-ref7"><strong>Brian Kernighan</strong>, An Interview with Brian Kernighan<br>
<a href="https://www.cs.cmu.edu/~mihaib/kernighan-interview/">https://www.cs.cmu.edu/~mihaib/kernighan-interview/</a></li>
<li id="m4-ref8"><strong>GNU M4 - GNU macro processor</strong>, Free Software Foundation<br>
<a href="https://www.gnu.org/software/m4/manual/">https://www.gnu.org/software/m4/manual/</a></li>
<li id="m4-ref9"><strong>Teorie automatÅ¯</strong>, From Wikipedia, the free encyclopedia<br>
<a href="https://cs.wikipedia.org/wiki/Teorie_automat%C5%AF">https://cs.wikipedia.org/wiki/Teorie_automat%C5%AF</a></li>
<li id="m4-ref10"><strong>GNU Make Manual</strong>, Free Software Foundation<br>
<a href="https://www.gnu.org/software/make/manual/make.html">https://www.gnu.org/software/make/manual/make.html</a></li>
<li id="m4-ref11"><strong>Vim â€“ vÅ¡udypÅ™Ã­tomnÃ½ textovÃ½ editor</strong>, editujÃ­ce text rychlostÃ­ myÅ¡lenky<br>
<a href="https://www.vim.org/">https://www.vim.org/</a></li>
<li id="m4-ref12"><strong>Automaty a&nbsp;formÃ¡lnÃ­ jazyky I</strong>, UÄebnÃ­ text FI MU<br>
<a href="https://is.muni.cz/elportal/estud/fi/js06/ib005/Formalni_jazyky_a_automaty_I.pdf">https://is.muni.cz/elportal/estud/fi/js06/ib005/Formalni_jazyky_a_automaty_I.pdf</a></li>
<li id="m4-ref13"><strong>Automaty a&nbsp;gramatiky</strong>, Michal Chytil, 1. vydÃ¡nÃ­, Praha, 331 s. 1984.<br>
<a href="https://is.muni.cz/publication/173173">https://is.muni.cz/publication/173173</a></li>
<li id="m4-ref14"><strong>Chomsky hierarchy</strong>, cover image<br>
<a href="https://www.researchgate.net/figure/The-four-classes-of-grammars-in-the-Chomsky-hierarchy-of-transformational-grammars_fig1_244429893">https://www.researchgate.net/figure/The-four-classes-of-grammars-in-the-Chomsky-hierarchy-of-transformational-grammars_fig1_244429893</a></li>
</ol>
<!-- annex content -->
<h2 id="m4-priklady-generovani-kodu"><a href="#m4-priklady-generovani-kodu" title="âš“">A</a>&nbsp;&nbsp;PÅ™Ã­klady generovÃ¡nÃ­ kÃ³du&nbsp;<a href="#m4-toc-priklady-generovani-kodu" title="Obsah" class="m4-jmp">â˜°</a></h2>
<div class="rs-tip-major m4-tip">Znaky {<code>`'</code>, <code>[]</code>, <strong><code>â‚â†</code></strong>, <code>ã€–ã€—</code>} v&nbsp;nÃ¡zvu pÅ™Ã­kladu <a href="#m4-rizeni-expanze-neterminalu" title="Å˜Ã­zenÃ­ expanze neterminÃ¡lÅ¯">Å™Ã­dÃ­ expanzi neterminÃ¡lÅ¯</a>.</div>
<p id="m4-toc-csv-nejjednodussi-priklad">&nbsp;&nbsp;&nbsp;<a href="#m4-csv-nejjednodussi-priklad">A.1&nbsp;&nbsp;<code>[]</code> CSV â€“ nejjednoduÅ¡Å¡Ã­ pÅ™Ã­klad</a></p>
<p id="m4-toc-csv-pocitadlo">&nbsp;&nbsp;&nbsp;<a href="#m4-csv-pocitadlo">A.2&nbsp;&nbsp;<code>[]</code> CSV â€“ poÄÃ­tadlo</a></p>
<p id="m4-toc-specialni-znaky-vystupniho-kodu">&nbsp;&nbsp;&nbsp;<a href="#m4-specialni-znaky-vystupniho-kodu">A.3&nbsp;&nbsp;<code title="Å™eÅ¡enÃ­">ğŸ’¡</code> SpeciÃ¡lnÃ­ znaky vÃ½stupnÃ­ho kÃ³du</a></p>
<p id="m4-toc-c-vystupni-fronta">&nbsp;&nbsp;&nbsp;<a href="#m4-c-vystupni-fronta">A.4&nbsp;&nbsp;<code>[]</code> C â€“ vÃ½stupnÃ­ fronta</a></p>
<p id="m4-toc-ini-externi-prikaz">&nbsp;&nbsp;&nbsp;<a href="#m4-ini-externi-prikaz">A.5&nbsp;&nbsp;<code>[]</code> INI â€“ externÃ­ pÅ™Ã­kaz</a></p>
<p id="m4-toc-h-hex-pocitadlo">&nbsp;&nbsp;&nbsp;<a href="#m4-h-hex-pocitadlo">A.6&nbsp;&nbsp;<code>[]</code> .h â€“ hex poÄÃ­tadlo</a></p>
<p id="m4-toc-c-maly-automat">&nbsp;&nbsp;&nbsp;<a href="#m4-c-maly-automat">A.7&nbsp;&nbsp;<code>[]</code> C â€“ malÃ½ automat</a></p>
<p id="m4-toc-c-maly-automat-2">&nbsp;&nbsp;&nbsp;<a href="#m4-c-maly-automat-2">A.8&nbsp;&nbsp;<code>[]</code> C â€“ malÃ½ automat 2</a></p>
<p id="m4-toc-html-vystupni-fronty">&nbsp;&nbsp;&nbsp;<a href="#m4-html-vystupni-fronty">A.9&nbsp;&nbsp;<code>[]</code> HTML â€“ vÃ½stupnÃ­ fronty</a></p>
<p id="m4-toc-vetveni-gramatikou">&nbsp;&nbsp;&nbsp;<a href="#m4-vetveni-gramatikou">A.10&nbsp;&nbsp;<code>[]</code> VÄ›tvenÃ­ gramatikou</a></p>
<p id="m4-toc-json-generujici-automat">&nbsp;&nbsp;&nbsp;<a href="#m4-json-generujici-automat">A.11&nbsp;&nbsp;<code>[]</code> JSON â€“ generujÃ­cÃ­ automat</a></p>
<p id="m4-toc-json-pojmenovane-fronty">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#m4-json-pojmenovane-fronty">A.11.1&nbsp;&nbsp;<code>[]</code> JSON â€“ pojmenovanÃ© fronty</a></p>
<p id="m4-toc-json-generovane-indexy-front">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#m4-json-generovane-indexy-front">A.11.2&nbsp;&nbsp;<code>[]</code> JSON â€“ generovanÃ© indexy front</a></p>
<p id="m4-toc-ini-nespojity-index-front">&nbsp;&nbsp;&nbsp;<a href="#m4-ini-nespojity-index-front">A.12&nbsp;&nbsp;<code>[]</code> INI â€“ nespojitÃ½ index front</a></p>
<p id="m4-toc-xml-smisene-zpravy">&nbsp;&nbsp;&nbsp;<a href="#m4-xml-smisene-zpravy">A.13&nbsp;&nbsp;<code>[]</code> XML â€“ smÃ­Å¡enÃ© zprÃ¡vy</a></p>
<p id="m4-toc-xml-oddelene-zpravy">&nbsp;&nbsp;&nbsp;<a href="#m4-xml-oddelene-zpravy">A.14&nbsp;&nbsp;<code>[]</code> XML â€“ oddÄ›lenÃ© zprÃ¡vy</a></p>
<p id="m4-toc-bash-cmd-echo-retezec">&nbsp;&nbsp;&nbsp;<a href="#m4-bash-cmd-echo-retezec">A.15&nbsp;&nbsp;<code>[]</code> Bash <code>~]$ echo &quot;Å™etÄ›zec&quot;</code></a></p>
<p id="m4-toc-bash-cmd-echo-aretezeca">&nbsp;&nbsp;&nbsp;<a href="#m4-bash-cmd-echo-aretezeca">A.16&nbsp;&nbsp;<code>[]</code> Bash <code>~]$ echo 'Å™etÄ›zec'</code></a></p>
<div class="rs-tip-major m4-tip">PÅ™Ã­klady v&nbsp;tÃ©to pÅ™Ã­loze jsou sloÅ¾itÄ›jÅ¡Ã­ a&nbsp;jejich cÃ­lem je ukÃ¡zat praktickÃ© pouÅ¾itÃ­ jazyka M4.
PodrobnÄ›ji budou vysvÄ›tleny pozdÄ›ji.</div>
<h3 id="m4-vstupni-zdrojovy-kod"><a href="#m4-vstupni-zdrojovy-kod" title="âš“">Â»</a>&nbsp;VstupnÃ­ zdrojovÃ½ kÃ³d</h3>
<p>VstupnÃ­ zdrojovÃ½ kÃ³d je podobnÃ½ <abbr title="Comma Separated Values">CSV</abbr>, kterÃ½ se pÅ™evede na libovolnÄ› sloÅ¾itÃ½ cÃ­lovÃ½ kÃ³d jinÃ©ho jazyka pomocÃ­ <abbr title="Context-Free Grammar â€“ bezkontextovÃ¡ gramatika">CFG</abbr>, automatÅ¯ a&nbsp;vÃ½stupnÃ­ch front.
ZÃ¡sobnÃ­ky v&nbsp;pÅ™Ã­kladech nejsou pouÅ¾ity.</p>
<pre title="messages_raw.mc  âš  obsahuje speciÃ¡lnÃ­ znaky âš "># 2018/05/15 Josef Kubin

ERROR([COMPLEX],     [!"#$%&amp;'()*+ ,-./:;&lt;=&gt;?@[\]^_`{|}~])
QUERY([READABLE],    [Is badly written M4 code readable [N/y]?])
ERROR([SUCCESS],     [Complex M4 code failed successfully.])
WARNING([ADDICTIVE], [Programming in M4 is addictive!])
ERROR([NOFAULT],     [It's not a language fault!])
WARNING([NO_ERRORS], [No other errors detected.])</pre>
<div class="rs-tip-major m4-tip">VstupnÃ­ soubor mÅ¯Å¾e obsahovat poznÃ¡mky, kterÃ© nemusÃ­ bÃ½t skrytÃ© v&nbsp;komentÃ¡Å™Ã­ch <code>#</code>, <code>dnl</code>, <code>ifelse([â€¦])</code> nebo <code>[â€¦ nÄ›kde uvnitÅ™ zÃ¡vorek â€¦]</code>.</div>
<h3 id="m4-csv-nejjednodussi-priklad"><a href="#m4-csv-nejjednodussi-priklad" title="âš“">A.1</a>&nbsp;&nbsp;<code>[]</code> CSV â€“ nejjednoduÅ¡Å¡Ã­ pÅ™Ã­klad&nbsp;<a href="#m4-toc-csv-nejjednodussi-priklad" title="Obsah" class="m4-jmp">â˜°</a></h3>
<p>Tento pÅ™Ã­klad nepouÅ¾Ã­vÃ¡ vÃ½stupnÃ­ fronty, pouze generuje <abbr title="Comma Separated Values">CSV</abbr> oddÄ›lenÃ© znakem <code>TAB</code>.</p>
<pre title="hello.csv.m4"># A â†’ Î²
define([ERROR], [

	divert(0)dnl
[$1]	$2
divert(-1)
])</pre>
<table class="table"><tbody><tr><th style="width:100%" title="vstupnÃ­ soubory"><a href="../gfiles/rootb.m4" title="localhost">rootb.m4</a>&nbsp;&nbsp;&nbsp;<a href="../messages/hello.csv.m4" title="localhost">hello.csv.m4</a>&nbsp;&nbsp;&nbsp;<a href="../messages/messages_raw.mc" title="localhost">messages_raw.mc</a></th><th title="vÃ½stupnÃ­ soubor"><a href="../messages/hello.csv" title="localhost">hello.csv</a></th></tr></tbody></table>
<pre title="pÅ™Ã­kaz">
~]$ <strong>m4 rootb.m4 hello.csv.m4 messages_raw.mc &gt; hello.csv</strong>
</pre>
<pre title="hello.csv">COMPLEX	!"#$%&amp;'()*+,-./:;&lt;=&gt;?@[\]^_`{|}~
SUCCESS	Complex M4 code failed successfully.
NOFAULT	It's not a language fault!</pre>
<h3 id="m4-csv-pocitadlo"><a href="#m4-csv-pocitadlo" title="âš“">A.2</a>&nbsp;&nbsp;<code>[]</code> CSV â€“ poÄÃ­tadlo&nbsp;<a href="#m4-toc-csv-pocitadlo" title="Obsah" class="m4-jmp">â˜°</a></h3>
<p>PÅ™Ã­klad pouÅ¾Ã­vÃ¡ makro <code>COUNT_UP</code> z&nbsp;koÅ™enovÃ©ho souboru, jehoÅ¾ <abbr title="pravÃ¡ strana pÅ™episovacÃ­ho pravidla"><code>Î²</code></abbr> se zkopÃ­ruje do pravÃ© strany makra <code>COUNTER</code>.
BÄ›hem prvnÃ­ expanze <code>COUNTER</code> probÄ›hne inicializace jeho startovacÃ­ hodnoty.
DalÅ¡Ã­ expanze vrÃ¡tÃ­ ÄÃ­selnÃ½ terminÃ¡lnÃ­ symbol a&nbsp;probÄ›hne zvÃ½Å¡enÃ­ pomocnÃ©ho (globÃ¡lnÃ­ho) symbolu o&nbsp;jedniÄku.
<code>COUNTER</code> je malÃ½ automat.</p>
<pre title="counter.csv.m4"># A â†’ Î²
define([COUNTER], defn([COUNT_UP]))

# init counter
COUNTER(1)

# A â†’ Î²
define([ERROR], [

	divert(0)dnl
ERR_[]COUNTER	[$1]	$2
divert(-1)
])</pre>
<table class="table"><tbody><tr><th style="width:100%" title="vstupnÃ­ soubory"><a href="../gfiles/rootb.m4" title="localhost">rootb.m4</a>&nbsp;&nbsp;&nbsp;<a href="../messages/counter.csv.m4" title="localhost">counter.csv.m4</a>&nbsp;&nbsp;&nbsp;<a href="../messages/messages_raw.mc" title="localhost">messages_raw.mc</a></th><th title="vÃ½stupnÃ­ soubor"><a href="../messages/counter.csv" title="localhost">counter.csv</a></th></tr></tbody></table>
<pre title="pÅ™Ã­kaz">
~]$ <strong>m4 rootb.m4 counter.csv.m4 messages_raw.mc &gt; counter.csv</strong>
</pre>
<pre title="counter.csv">ERR_1	COMPLEX	!"#$%&amp;'()*+,-./:;&lt;=&gt;?@[\]^_`{|}~
ERR_2	SUCCESS	Complex M4 code failed successfully.
ERR_3	NOFAULT	It's not a language fault!</pre>
<h3 id="m4-specialni-znaky-vystupniho-kodu"><a href="#m4-specialni-znaky-vystupniho-kodu" title="âš“">A.3</a>&nbsp;&nbsp;<code title="Å™eÅ¡enÃ­">ğŸ’¡</code> SpeciÃ¡lnÃ­ znaky vÃ½stupnÃ­ho kÃ³du&nbsp;<a href="#m4-toc-specialni-znaky-vystupniho-kodu" title="Obsah" class="m4-jmp">â˜°</a></h3>
<p>KaÅ¾dÃ½ typ vÃ½stupnÃ­ho kÃ³du vyÅ¾aduje Ãºpravu speciÃ¡lnÃ­ch znakÅ¯.
PouÅ¾itÃ­ klÃ­ÄovÃ©ho slova <code>patsubst()</code> je nevhodnÃ© pro tento Ãºkol.
VstupnÃ­ zdrojovÃ½ kÃ³d proto napÅ™ed upravÃ­me regulÃ¡rnÃ­m vÃ½razem a&nbsp;vÅ¡echny speciÃ¡lnÃ­ znaky schovÃ¡me do maker.</p>
<h4 id="m4-upraveny-vstupni-kod"><a href="#m4-upraveny-vstupni-kod" title="âš“">Â»</a>&nbsp;UpravenÃ½ vstupnÃ­ kÃ³d</h4>
<table class="table"><tbody><tr><th><a href="../messages/messages.mc" title="localhost">messages.mc</a></th><th style="width:100%">speciÃ¡lnÃ­ znaky vstupnÃ­ho kÃ³du jsou skryty do maker</th></tr></tbody></table>
<pre title="messages.mc"># 2018/05/15 Josef Kubin

ERROR([COMPLEX],     [[]EX()[]DQ()[#]$%[]AMP()[]AP()()*+[,]-./:;[]LT()=[]GT()?@[]LB()[]BS()[]RB()^_[]BQ(){|}~])
QUERY([READABLE],    [Is badly written M4 code readable []LB()N/y[]RB()?])
ERROR([SUCCESS],     [Complex M4 code failed successfully.])
WARNING([ADDICTIVE], [Programming in M4 is addictive[]EX()])
ERROR([NOFAULT],     [It[]AP()s not a language fault[]EX()])
WARNING([NO_ERRORS], [No other errors detected.])</pre>
<p>VytvoÅ™Ã­me soubory pÅ™evÃ¡dÄ›jÃ­cÃ­ makra na speciÃ¡lnÃ­ znaky podle typu cÃ­lovÃ©ho kÃ³du.</p>
<h4 id="m4-xml-xslt-html"><a href="#m4-xml-xslt-html" title="âš“">Â»</a>&nbsp;<code>[]</code> XML, XSLT, HTML</h4>
<p><code><a href="../messages/markup.m4" title="localhost">markup.m4</a></code> â€“ pÅ™evodnÃ­ soubor pro znaÄkovacÃ­ jazyky</p>
<pre title="markup.m4"># A â†’ Î²
define([AMP], [&amp;amp;])
define([AP], ['])
define([BQ], [`])
define([BS], [\])
define([DQ], ["])
define([EX], [!])
define([GT], [&amp;gt;])
define([LT], [&amp;lt;])</pre>
<h4 id="m4-c-json-ini-retezec"><a href="#m4-c-json-ini-retezec" title="âš“">Â»</a>&nbsp;<code>[]</code> C, JSON, INI â€“ <code>&quot;Å™etÄ›zec&quot;</code></h4>
<table class="table"><tbody><tr><th><a href="../messages/code.m4" title="localhost">code.m4</a></th><th style="width:100%">pÅ™evodnÃ­ soubor</th></tr></tbody></table>
<pre title="code.m4"># A â†’ Î²
define([AMP], [&amp;])
define([AP], ['])
define([BQ], [`])
define([BS], [\\])
define([DQ], [\"])
define([EX], [!])
define([GT], [&gt;])
define([LT], [&lt;])</pre>
<h4 id="m4-bash-retezec"><a href="#m4-bash-retezec" title="âš“">Â»</a>&nbsp;<code>[]</code> Bash â€“ <code>&quot;Å™etÄ›zec&quot;</code></h4>
<table class="table"><tbody><tr><th><a href="../messages/doubleq.m4" title="localhost">doubleq.m4</a></th><th style="width:100%">pÅ™evodnÃ­ soubor</th></tr></tbody></table>
<pre title="doubleq.m4"># A â†’ Î²
define([AMP], [&amp;])
define([AP], ['])
define([BQ], [\`])
define([BS], [\\])
define([DQ], [\"])
define([EX], ["\!"])
define([GT], [&gt;])
define([LT], [&lt;])</pre>
<h4 id="m4-bash-aretezeca"><a href="#m4-bash-aretezeca" title="âš“">Â»</a>&nbsp;<code>[]</code> Bash â€“ <code>'Å™etÄ›zec'</code></h4>
<table class="table"><tbody><tr><th><a href="../messages/apost.m4" title="localhost">apost.m4</a></th><th style="width:100%">pÅ™evodnÃ­ soubor</th></tr></tbody></table>
<pre title="apost.m4"># A â†’ Î²
define([AMP], [&amp;])
define([AP], ['\''])
define([BQ], [`])
define([BS], [\])
define([DQ], ["])
define([EX], [!])
define([GT], [&gt;])
define([LT], [&lt;])</pre>
<h4 id="m4-csv-m4"><a href="#m4-csv-m4" title="âš“">Â»</a>&nbsp;<code>[]</code> CSV, M4</h4>
<table class="table"><tbody><tr><th><a href="../messages/unchanged.m4" title="localhost">unchanged.m4</a></th><th style="width:100%">pÅ™evodnÃ­ soubor nezmÄ›nÃ­ speciÃ¡lnÃ­ znaky</th></tr></tbody></table>
<pre title="unchanged.m4"># A â†’ Î²
define([AMP], [&amp;])
define([AP], ['])
define([BQ], [`])
define([BS], [\])
define([DQ], ["])
define([EX], [!])
define([GT], [&gt;])
define([LT], [&lt;])</pre>
<h3 id="m4-c-vystupni-fronta"><a href="#m4-c-vystupni-fronta" title="âš“">A.4</a>&nbsp;&nbsp;<code>[]</code> C â€“ vÃ½stupnÃ­ fronta&nbsp;<a href="#m4-toc-c-vystupni-fronta" title="Obsah" class="m4-jmp">â˜°</a></h3>
<p>PÅ™Ã­klad pouÅ¾Ã­vÃ¡ jednu vÃ½stupnÃ­ frontu na znaky <code>};</code> pro uzavÅ™enÃ­ pole na konci skriptu.</p>
<pre title="array.c.m4"># A â†’ Î²
define([ERROR], [

	divert(0)dnl
	"$2",
divert(-1)
])

divert(0)dnl
/*
 * DONTE()
 */

char *error[[]] = {
divert(1)dnl
};
divert(-1)</pre>
<table class="table"><tbody><tr><th style="width:100%" title="vstupnÃ­ soubory"><a href="../gfiles/rootb.m4" title="localhost">rootb.m4</a>&nbsp;&nbsp;&nbsp;<a href="../messages/array.c.m4" title="localhost">array.c.m4</a>&nbsp;&nbsp;&nbsp;<a href="../messages/code.m4" title="localhost">code.m4</a>&nbsp;&nbsp;&nbsp;<a href="../messages/messages.mc" title="localhost">messages.mc</a></th><th title="vÃ½stupnÃ­ soubor"><a href="../messages/array.c" title="localhost">array.c</a></th></tr></tbody></table>
<pre title="pÅ™Ã­kaz">
~]$ <strong>m4 rootb.m4 array.c.m4 code.m4 messages.mc &gt; array.c</strong>
</pre>
<pre title="array.c">/*
 * DO NOT EDIT! This file is generated automatically!
 */

char *error[] = {
	"!\"#$%&amp;'()*+,-./:;&lt;=&gt;?@[\\]^_`{|}~",
	"Complex M4 code failed successfully.",
	"It's not a language fault!",
};</pre>
<h3 id="m4-ini-externi-prikaz"><a href="#m4-ini-externi-prikaz" title="âš“">A.5</a>&nbsp;&nbsp;<code>[]</code> INI â€“ externÃ­ pÅ™Ã­kaz&nbsp;<a href="#m4-toc-ini-externi-prikaz" title="Obsah" class="m4-jmp">â˜°</a></h3>
<p>PÅ™Ã­klad spustÃ­ externÃ­ pÅ™Ã­kaz <code>date</code> a jeho vÃ½stup umÃ­stÃ­ do hranatÃ½ch zÃ¡vorek.
VÃ½stupem externÃ­ho pÅ™Ã­kazu jsou dvÄ› poloÅ¾ky oddÄ›lenÃ© ÄÃ¡rkou.
Makro <code>FST()</code> vybere prvnÃ­ poloÅ¾ku, protoÅ¾e druhÃ¡ poloÅ¾ka obsahuje neÅ¾Ã¡doucÃ­ znak novÃ©ho Å™Ã¡dku <code>LF</code> (<samp>0x0a</samp>).</p>
<pre title="hello.ini.m4"># A â†’ Î²
define([ERROR], [

	divert(0)dnl
[$1]="$2"
divert(-1)
])

divert(0)dnl
; DONTE()

BRAC(FST(esyscmd([date '+[hello_%Y%m%d],'])))
divert(-1)</pre>
<table class="table"><tbody><tr><th style="width:100%" title="vstupnÃ­ soubory"><a href="../gfiles/rootb.m4" title="localhost">rootb.m4</a>&nbsp;&nbsp;&nbsp;<a href="../messages/hello.ini.m4" title="localhost">hello.ini.m4</a>&nbsp;&nbsp;&nbsp;<a href="../messages/code.m4" title="localhost">code.m4</a>&nbsp;&nbsp;&nbsp;<a href="../messages/messages.mc" title="localhost">messages.mc</a></th><th title="vÃ½stupnÃ­ soubor"><a href="../messages/hello.ini" title="localhost">hello.ini</a></th></tr></tbody></table>
<pre title="pÅ™Ã­kaz">
~]$ <strong>m4 rootb.m4 hello.ini.m4 code.m4 messages.mc &gt; hello.ini</strong>
</pre>
<pre title="hello.ini">; DO NOT EDIT! This file is generated automatically!

[hello_20200111]
COMPLEX="!\"#$%&amp;'()*+,-./:;&lt;=&gt;?@[\\]^_`{|}~"
SUCCESS="Complex M4 code failed successfully."
NOFAULT="It's not a language fault!"</pre>
<h3 id="m4-h-hex-pocitadlo"><a href="#m4-h-hex-pocitadlo" title="âš“">A.6</a>&nbsp;&nbsp;<code>[]</code> .h â€“ hex poÄÃ­tadlo&nbsp;<a href="#m4-toc-h-hex-pocitadlo" title="Obsah" class="m4-jmp">â˜°</a></h3>
<p>PÅ™Ã­klad pouÅ¾Ã­vÃ¡ makro <code>COUNTER</code> pro ÄÃ­slovÃ¡nÃ­ vÃ½slednÃ½ch <abbr title="Preprocesor jazyka C">CPP</abbr> maker a&nbsp;jednu vÃ½stupnÃ­ frontu.
Fronta ÄÃ­slo <code>1</code> obsahuje direktivu preprocesoru <code>#endif</code> pro zakonÄenÃ­ hlaviÄkovÃ©ho souboru.
PÅ™evod dekadickÃ© hodnoty poÄÃ­tadla na dvoumÃ­stnÃ© hex-a ÄÃ­slo provÃ¡dÃ­ klÃ­ÄovÃ© slovo <code>eval()</code>.</p>
<pre title="messages.h.m4"># A â†’ Î²
define([COUNTER], defn([COUNT_UP]))

# init counter
COUNTER(0)

# A â†’ Î²
define([ERROR], [

	divert(0)dnl
[#define $1		0x]eval(COUNTER, 16, 2)
divert(-1)
])

divert(0)dnl
/*
 * DONTE()
 */

#ifndef __ERROR_H
#define __ERROR_H

divert(1)
#endif /* __ERROR_H */
divert(-1)</pre>
<table class="table"><tbody><tr><th style="width:100%" title="vstupnÃ­ soubory"><a href="../gfiles/rootb.m4" title="localhost">rootb.m4</a>&nbsp;&nbsp;&nbsp;<a href="../messages/messages.h.m4" title="localhost">messages.h.m4</a>&nbsp;&nbsp;&nbsp;<a href="../messages/messages.mc" title="localhost">messages.mc</a></th><th title="vÃ½stupnÃ­ soubor"><a href="../messages/messages.h" title="localhost">messages.h</a></th></tr></tbody></table>
<pre title="pÅ™Ã­kaz">
~]$ <strong>m4 rootb.m4 messages.h.m4 messages.mc &gt; messages.h</strong>
</pre>
<pre title="messages.h">/*
 * DO NOT EDIT! This file is generated automatically!
 */

#ifndef __ERROR_H
#define __ERROR_H

#define COMPLEX		0x00
#define SUCCESS		0x01
#define NOFAULT		0x02

#endif /* __ERROR_H */</pre>
<h3 id="m4-c-maly-automat"><a href="#m4-c-maly-automat" title="âš“">A.7</a>&nbsp;&nbsp;<code>[]</code> C â€“ malÃ½ automat&nbsp;<a href="#m4-toc-c-maly-automat" title="Obsah" class="m4-jmp">â˜°</a></h3>
<p>PÅ™Ã­klad pouÅ¾Ã­vÃ¡ malÃ½ automat <code>NEW_LINE</code> pro generovÃ¡nÃ­ znaku novÃ©ho Å™Ã¡dku <code>\n</code> a&nbsp;jednu vÃ½stupnÃ­ frontu ÄÃ­slo <code>1</code> do kterÃ© se vloÅ¾Ã­ znaky <code>";</code> pro uzavÅ™enÃ­ vÃ½slednÃ©ho Å™etÄ›zce.
PoprvÃ© se <code>NEW_LINE</code> pÅ™epÃ­Å¡e na <abbr title="epsilon â€“ prÃ¡zdnÃ½ symbol"><code>Îµ</code></abbr>, podruhÃ© se pÅ™epÃ­Å¡e na <code>\n</code>.</p>
<pre title="stringl.c.m4">#     NEW_LINE automaton
#      ___      ____
# ---&gt;/ Îµ \---&gt;/ \n \---.
#     \___/    \____/&lt;--'

# A â†’ Î²
define([NEW_LINE], [define([$0], [\n])])

# A â†’ Î²
define([ERROR], [

	divert(0)NEW_LINE[]$2[]dnl
divert(-1)
])

divert(0)dnl
/*
 * DONTE()
 */

char error[[]] =
"divert(1)";
divert(-1)</pre>
<table class="table"><tbody><tr><th style="width:100%" title="vstupnÃ­ soubory"><a href="../gfiles/rootb.m4" title="localhost">rootb.m4</a>&nbsp;&nbsp;&nbsp;<a href="../messages/stringl.c.m4" title="localhost">stringl.c.m4</a>&nbsp;&nbsp;&nbsp;<a href="../messages/code.m4" title="localhost">code.m4</a>&nbsp;&nbsp;&nbsp;<a href="../messages/messages.mc" title="localhost">messages.mc</a></th><th title="vÃ½stupnÃ­ soubor"><a href="../messages/stringl.c" title="localhost">stringl.c</a></th></tr></tbody></table>
<pre title="pÅ™Ã­kaz">
~]$ <strong>m4 rootb.m4 stringl.c.m4 code.m4 messages.mc &gt; stringl.c</strong>
</pre>
<pre title="stringl.c">/*
 * DO NOT EDIT! This file is generated automatically!
 */

char error[] =
"!\"#$%&amp;'()*+,-./:;&lt;=&gt;?@[\\]^_`{|}~\nComplex M4 code failed successfully.\nIt's not a language fault!";</pre>
<h3 id="m4-c-maly-automat-2"><a href="#m4-c-maly-automat-2" title="âš“">A.8</a>&nbsp;&nbsp;<code>[]</code> C â€“ malÃ½ automat 2&nbsp;<a href="#m4-toc-c-maly-automat-2" title="Obsah" class="m4-jmp">â˜°</a></h3>
<p>Tento pÅ™Ã­klad je podobnÃ½ pÅ™edchozÃ­mu, avÅ¡ak kaÅ¾dÃ½ Å™etÄ›zec je na novÃ©m Å™Ã¡dku.</p>
<pre title="string.c.m4">#      NEW_LINE automaton
#      ___      ________
# ---&gt;/ Îµ \---&gt;/ \n"LF" \---.
#     \___/    \________/&lt;--'

# A â†’ Î²
define([NEW_LINE], [define([$0], [\n"
"])])

# A â†’ Î²
define([ERROR], [

	divert(0)NEW_LINE[]$2[]dnl
divert(-1)
])

divert(0)dnl
/*
 * DONTE()
 */

char error[[]] =
"divert(1)";
divert(-1)</pre>
<table class="table"><tbody><tr><th style="width:100%" title="vstupnÃ­ soubory"><a href="../gfiles/rootb.m4" title="localhost">rootb.m4</a>&nbsp;&nbsp;&nbsp;<a href="../messages/string.c.m4" title="localhost">string.c.m4</a>&nbsp;&nbsp;&nbsp;<a href="../messages/code.m4" title="localhost">code.m4</a>&nbsp;&nbsp;&nbsp;<a href="../messages/messages.mc" title="localhost">messages.mc</a></th><th title="vÃ½stupnÃ­ soubor"><a href="../messages/string.c" title="localhost">string.c</a></th></tr></tbody></table>
<pre title="pÅ™Ã­kaz">
~]$ <strong>m4 rootb.m4 string.c.m4 code.m4 messages.mc &gt; string.c</strong>
</pre>
<pre title="string.c">/*
 * DO NOT EDIT! This file is generated automatically!
 */

char error[] =
"!\"#$%&amp;'()*+,-./:;&lt;=&gt;?@[\\]^_`{|}~\n"
"Complex M4 code failed successfully.\n"
"It's not a language fault!";</pre>
<h3 id="m4-html-vystupni-fronty"><a href="#m4-html-vystupni-fronty" title="âš“">A.9</a>&nbsp;&nbsp;<code>[]</code> HTML â€“ vÃ½stupnÃ­ fronty&nbsp;<a href="#m4-toc-html-vystupni-fronty" title="Obsah" class="m4-jmp">â˜°</a></h3>
<p>PÅ™Ã­klad pouÅ¾Ã­vÃ¡ dvÄ› vÃ½stupnÃ­ fronty.
Fronta ÄÃ­slo <code>1</code> obsahuje odstavce, fronta ÄÃ­slo <code>2</code> uzavÃ­racÃ­ znaÄky HTML strÃ¡nky.
NavigaÄnÃ­ odkazy nemusÃ­ bÃ½t nikde uloÅ¾eny, jdou pÅ™Ã­mo na vÃ½stup.
ZprÃ¡vy typu <code>QUERY</code> a&nbsp;<code>WARNING</code> jsou zpracovÃ¡ny stejnÄ› jako zprÃ¡vy typu <code>ERROR</code>.</p>
<pre title="messages.html.m4"># vim:ft=m4

# A â†’ Î²
# Î²
define([ERROR], [

	divert(0)dnl
		[&lt;li&gt;$0: &lt;a href="#$1"&gt;$1&lt;/a&gt;&lt;/li&gt;]
divert(1)dnl
	&lt;p id="[$1]"&gt;$2&lt;/p&gt;
divert(-1)
])

# A â†’ Î²
define([QUERY], defn([ERROR]))
define([WARNING], defn([ERROR]))

divert(0)dnl
&lt;!-- DONTE() --&gt;
&lt;!doctype html&gt;
&lt;html lang="en"&gt;
	&lt;meta charset="utf-8"&gt;
	&lt;title&gt;__file__&lt;/title&gt;
&lt;body&gt;
	&lt;h1&gt;The power of M4&lt;/h1&gt;
	&lt;ul&gt;
divert(1)dnl
	&lt;/ul&gt;
divert(2)dnl
&lt;/body&gt;
&lt;/html&gt;
divert(-1)</pre>
<table class="table"><tbody><tr><th style="width:100%" title="vstupnÃ­ soubory"><a href="../gfiles/rootb.m4" title="localhost">rootb.m4</a>&nbsp;&nbsp;&nbsp;<a href="../messages/messages.html.m4" title="localhost">messages.html.m4</a>&nbsp;&nbsp;&nbsp;<a href="../messages/markup.m4" title="localhost">markup.m4</a>&nbsp;&nbsp;&nbsp;<a href="../messages/messages.mc" title="localhost">messages.mc</a></th><th title="vÃ½stupnÃ­ soubor"><a href="../messages/messages.html" title="localhost">messages.html</a></th></tr></tbody></table>
<pre title="pÅ™Ã­kaz">
~]$ <strong>m4 rootb.m4 messages.html.m4 markup.m4 messages.mc &gt; messages.html</strong>
</pre>
<pre title="messages.html">&lt;!-- DO NOT EDIT! This file is generated automatically! --&gt;
&lt;!doctype html&gt;
&lt;html lang="en"&gt;
	&lt;meta charset="utf-8"&gt;
	&lt;title&gt;messages.html.m4&lt;/title&gt;
&lt;body&gt;
	&lt;h1&gt;The power of M4&lt;/h1&gt;
	&lt;ul&gt;
		&lt;li&gt;ERROR: &lt;a href="#COMPLEX"&gt;COMPLEX&lt;/a&gt;&lt;/li&gt;
		&lt;li&gt;QUERY: &lt;a href="#READABLE"&gt;READABLE&lt;/a&gt;&lt;/li&gt;
		&lt;li&gt;ERROR: &lt;a href="#SUCCESS"&gt;SUCCESS&lt;/a&gt;&lt;/li&gt;
		&lt;li&gt;WARNING: &lt;a href="#ADDICTIVE"&gt;ADDICTIVE&lt;/a&gt;&lt;/li&gt;
		&lt;li&gt;ERROR: &lt;a href="#NOFAULT"&gt;NOFAULT&lt;/a&gt;&lt;/li&gt;
		&lt;li&gt;WARNING: &lt;a href="#NO_ERRORS"&gt;NO_ERRORS&lt;/a&gt;&lt;/li&gt;
	&lt;/ul&gt;
	&lt;p id="COMPLEX"&gt;!"#$%&amp;amp;'()*+,-./:;&amp;lt;=&amp;gt;?@[\]^_`{|}~&lt;/p&gt;
	&lt;p id="READABLE"&gt;Is badly written M4 code readable [N/y]?&lt;/p&gt;
	&lt;p id="SUCCESS"&gt;Complex M4 code failed successfully.&lt;/p&gt;
	&lt;p id="ADDICTIVE"&gt;Programming in M4 is addictive!&lt;/p&gt;
	&lt;p id="NOFAULT"&gt;It's not a language fault!&lt;/p&gt;
	&lt;p id="NO_ERRORS"&gt;No other errors detected.&lt;/p&gt;
&lt;/body&gt;
&lt;/html&gt;</pre>
<h3 id="m4-vetveni-gramatikou"><a href="#m4-vetveni-gramatikou" title="âš“">A.10</a>&nbsp;&nbsp;<code>[]</code> VÄ›tvenÃ­ gramatikou&nbsp;<a href="#m4-toc-vetveni-gramatikou" title="Obsah" class="m4-jmp">â˜°</a></h3>
<p>PÅ™Ã­klad ukazuje <a href="#m4-nonterminals-for-branches">vÄ›tvenÃ­ gramatikou</a>, argumenty maker se ignorujÃ­.
VstupnÃ­ neterminÃ¡ly se pÅ™episujÃ­ na terminÃ¡ly <code title="ğŸ›">ERROR â†’ ğŸ›</code>, <code title="ğŸœ">QUERY â†’ ğŸœ</code>, <code title="ğŸ">WARNING â†’ ğŸ</code>.</p>
<pre title="insect.txt.m4"># A â†’ Î²
# Î²
define([ERROR], [

	divert(0)dnl
$0_INSECT[]dnl
divert(-1)
])

# A â†’ Î²
define([QUERY],   defn([ERROR]))
define([WARNING], defn([ERROR]))
define([ERROR_INSECT],   [ğŸ›])
define([QUERY_INSECT],   [ğŸœ])
define([WARNING_INSECT], [ğŸ])</pre>
<table class="table"><tbody><tr><th style="width:100%" title="vstupnÃ­ soubory"><a href="../gfiles/rootb.m4" title="localhost">rootb.m4</a>&nbsp;&nbsp;&nbsp;<a href="../messages/insect.txt.m4" title="localhost">insect.txt.m4</a>&nbsp;&nbsp;&nbsp;<a href="../messages/messages.mc" title="localhost">messages.mc</a></th><th title="vÃ½stupnÃ­ soubor"><a href="../messages/insect.txt" title="localhost">insect.txt</a></th></tr></tbody></table>
<pre title="pÅ™Ã­kaz">
~]$ <strong>m4 rootb.m4 insect.txt.m4 messages.mc &gt; insect.txt</strong>
</pre>
<pre title="insect.txt">ğŸ›ğŸœğŸ›ğŸğŸ›ğŸ</pre>
<h3 id="m4-json-generujici-automat"><a href="#m4-json-generujici-automat" title="âš“">A.11</a>&nbsp;&nbsp;<code>[]</code> JSON â€“ generujÃ­cÃ­ automat&nbsp;<a href="#m4-toc-json-generujici-automat" title="Obsah" class="m4-jmp">â˜°</a></h3>
<p>PÅ™Ã­klad pouÅ¾Ã­vÃ¡ dvÄ› vÃ½stupnÃ­ fronty a&nbsp;jeden generujÃ­cÃ­ automat.
PrvnÃ­ chybovÃ¡ zprÃ¡va <code>ERROR([â€¦])</code> ve stavu <code>ERROR</code> vygeneruje zÃ¡hlavÃ­ se zÃ¡vorkami a&nbsp;vypÃ­Å¡e na vÃ½stup prvnÃ­ zÃ¡znam.
Automat pÅ™ejde do stavu <code>NEXT_ITEM</code> coÅ¾ je <abbr title="takovÃ© pravidlo se pouÅ¾Ã­vÃ¡ jako pravÃ¡ strana jinÃ©ho pÅ™episovacÃ­ho pravidla"><code>Î²</code> pravidlo</abbr>.
NÃ¡sledujÃ­cÃ­ chybovÃ© zprÃ¡vy ve stavu <code>NEXT_ITEM</code> pouze vypisujÃ­ na vÃ½stup jednotlivÃ© zÃ¡znamy.
Na zÃ¡vÄ›r vÃ½stupnÃ­ fronty ÄÃ­slo <code>1</code> a&nbsp;<code>2</code> vypÃ­Å¡ou znaky <code>]</code> a&nbsp;<code>}}</code> ÄÃ­mÅ¾ zakonÄÃ­ vÃ½slednÃ½ JSON.</p>
<pre title="atm.json.m4">#      _______      ___________
# ---&gt;/ ERROR \---&gt;/ NEXT_ITEM \---.
#     \_______/    \___________/&lt;--'

# A â†’ Î²
define([ERROR], [

	# transition to the next node
	define([$0], defn([NEXT_ITEM]))

	divert(0),
	"error": LB()
		{"[$1]": "$2"}dnl
divert(1)
	RB()
divert(-1)
])

# Î²
define([NEXT_ITEM], [

	divert(0),
		{"[$1]": "$2"}dnl
divert(-1)
])

divert(0)dnl
{"generating_automaton": {
	"_comment": "DONTE()"dnl
divert(2)dnl
}}
divert(-1)</pre>
<table class="table"><tbody><tr><th style="width:100%" title="vstupnÃ­ soubory"><a href="../gfiles/rootb.m4" title="localhost">rootb.m4</a>&nbsp;&nbsp;&nbsp;<a href="../messages/atm.json.m4" title="localhost">atm.json.m4</a>&nbsp;&nbsp;&nbsp;<a href="../messages/code.m4" title="localhost">code.m4</a>&nbsp;&nbsp;&nbsp;<a href="../messages/messages.mc" title="localhost">messages.mc</a></th><th title="vÃ½stupnÃ­ soubor"><a href="../messages/atm.json" title="localhost">atm.json</a></th></tr></tbody></table>
<pre title="pÅ™Ã­kaz">
~]$ <strong>m4 rootb.m4 atm.json.m4 code.m4 messages.mc &gt; atm.json</strong>
</pre>
<pre title="atm.json">{"generating_automaton": {
	"_comment": "DO NOT EDIT! This file is generated automatically!",
	"error": [
		{"COMPLEX": "!\"#$%&amp;'()*+,-./:;&lt;=&gt;?@[\\]^_`{|}~"},
		{"SUCCESS": "Complex M4 code failed successfully."},
		{"NOFAULT": "It's not a language fault!"}
	]
}}</pre>
<h4 id="m4-json-pojmenovane-fronty"><a href="#m4-json-pojmenovane-fronty" title="âš“">A.11.1</a>&nbsp;&nbsp;<code>[]</code> JSON â€“ pojmenovanÃ© fronty&nbsp;<a href="#m4-toc-json-pojmenovane-fronty" title="Obsah" class="m4-jmp">â˜°</a></h4>
<p>PÅ™Ã­klad zpracovÃ¡vÃ¡ dalÅ¡Ã­ zprÃ¡vy typu <code>QUERY</code> a&nbsp;<code>WARNING</code>.
PouÅ¾Ã­vÃ¡ tÅ™i automaty a&nbsp;Å¡est vÃ½stupnÃ­ch front.
Generujeme-li sloÅ¾itÄ›jÅ¡Ã­ zdrojovÃ½ kÃ³d, brzy narazÃ­me na problÃ©m udrÅ¾enÃ­ konzistence indexÅ¯ pro vÃ½stupnÃ­ fronty.
Abychom se vyhnuli zmatku, fronty si pojmenujeme a&nbsp;mÃ­sto ÄÃ­sel pouÅ¾Ã­vÃ¡me jmÃ©na.</p>
<p>Abychom nemuseli definovat podobnÃ¡ pravidla, zkopÃ­rujeme si pravou stranu <code>ERROR</code><br>(je to takÃ© <abbr title="takovÃ© pravidlo se pouÅ¾Ã­vÃ¡ jako pravÃ¡ strana jinÃ©ho pÅ™episovacÃ­ho pravidla"><code>Î²</code> pravidlo</abbr>) do pravÃ© strany pravidel <code>QUERY</code> a&nbsp;<code>WARNING</code>.
PromÄ›nnÃ¡ <code>$0</code> se pÅ™epÃ­Å¡e na jmÃ©no makra a&nbsp;zÅ™etÄ›zÃ­ se s&nbsp;dalÅ¡Ã­m symbolem.
NovÄ› vzniklÃ½ neterminÃ¡l se pÅ™epÃ­Å¡e na odpovÃ­dajÃ­cÃ­ terminÃ¡lnÃ­ symbol.
TÃ­mto zpÅ¯sobem se provÃ¡dÃ­ vÄ›tvenÃ­.</p>
<pre id="m4-nonterminals-for-branches" title="vÄ›tvenÃ­ gramatikou v M4">
$0_QU â†’ ERROR_QU â†’ 2
$0_END â†’ ERROR_END â†’ 3
$0_NAME â†’ ERROR_NAME â†’ error
$0_QU â†’ QUERY_QU â†’ 0
$0_END â†’ QUERY_END â†’ 1
$0_NAME â†’ QUERY_NAME â†’ query
â€¦
</pre>
<pre title="qnames.json.m4"># DO NOT WRITE INDEXES MANUALLY, use counter!
define([QUERY_QU],     0)
define([QUERY_END],    1)
define([ERROR_QU],     2)
define([ERROR_END],    3)
define([WARNING_QU],   4)
define([WARNING_END],  5)
define([LAST_QUEUE],   6)

# names of message types
define([WARNING_NAME], [warning])
define([ERROR_NAME],   [error])
define([QUERY_NAME],   [query])

#      _________      ___________
# ---&gt;/  ERROR  \---&gt;/ NEXT_ITEM \---.
#     |  QUERY  |    \___________/&lt;--'
#     \_WARNING_/

# A â†’ Î²
# Î²
define([ERROR], [

	# transition to the next node
	define([$0], defn([NEXT_ITEM]))

	divert($0_QU),
	"$0_NAME": LB()
		{"[$1]": "$2"}dnl
divert($0_END)
	RB()dnl
divert(-1)
])

# Î²
define([NEXT_ITEM], [

	divert($0_QU),
		{"[$1]": "$2"}dnl
divert(-1)
])

# A â†’ Î²
define([QUERY],        defn([ERROR]))
define([WARNING],      defn([ERROR]))

divert(0)dnl
{"queue_names": {
	"_comment": "DONTE()"dnl
divert(LAST_QUEUE)
}}
divert(-1)</pre>
<table class="table"><tbody><tr><th style="width:100%" title="vstupnÃ­ soubory"><a href="../gfiles/rootb.m4" title="localhost">rootb.m4</a>&nbsp;&nbsp;&nbsp;<a href="../messages/qnames.json.m4" title="localhost">qnames.json.m4</a>&nbsp;&nbsp;&nbsp;<a href="../messages/code.m4" title="localhost">code.m4</a>&nbsp;&nbsp;&nbsp;<a href="../messages/messages.mc" title="localhost">messages.mc</a></th><th title="vÃ½stupnÃ­ soubor"><a href="../messages/qnames.json" title="localhost">qnames.json</a></th></tr></tbody></table>
<pre title="pÅ™Ã­kaz">
~]$ <strong>m4 rootb.m4 qnames.json.m4 code.m4 messages.mc &gt; qnames.json</strong>
</pre>
<pre title="qnames.json">{"queue_names": {
	"_comment": "DO NOT EDIT! This file is generated automatically!",
	"query": [
		{"READABLE": "Is badly written M4 code readable [N/y]?"}
	],
	"error": [
		{"COMPLEX": "!\"#$%&amp;'()*+,-./:;&lt;=&gt;?@[\\]^_`{|}~"},
		{"SUCCESS": "Complex M4 code failed successfully."},
		{"NOFAULT": "It's not a language fault!"}
	],
	"warning": [
		{"ADDICTIVE": "Programming in M4 is addictive!"},
		{"NO_ERRORS": "No other errors detected."}
	]
}}</pre>
<h4 id="m4-json-generovane-indexy-front"><a href="#m4-json-generovane-indexy-front" title="âš“">A.11.2</a>&nbsp;&nbsp;<code>[]</code> JSON â€“ generovanÃ© indexy front&nbsp;<a href="#m4-toc-json-generovane-indexy-front" title="Obsah" class="m4-jmp">â˜°</a></h4>
<p>BÄ›hem vÃ½voje se Äasto mÄ›nÃ­ poÅ™adÃ­ a&nbsp;poÄet vÃ½stupnÃ­ch front, coÅ¾ takÃ© vyÅ¾aduje Äastou zmÄ›nu jejich indexÅ¯.
Indexy je proto vhodnÃ© generovat.
MÅ¯Å¾eme pak pouÅ¾Ã­vat prakticky neomezenÃ½ poÄet front.
NÃ¡sledujÃ­cÃ­ pÅ™Ã­klad ukazuje, jak se tyto indexy generujÃ­.</p>
<pre title="queues.m4"># defines a counter for output queues
# A â†’ Î²
define([QUEUE_INDEX], defn([COUNT_UP]))

# initial index of the first output queue
QUEUE_INDEX(0)

# symbolic names for indices of output queues
# A â†’ Î²
define([QUERY_QU],     QUEUE_INDEX)
define([QUERY_END],    QUEUE_INDEX)
define([ERROR_QU],     QUEUE_INDEX)
define([ERROR_END],    QUEUE_INDEX)
define([WARNING_QU],   QUEUE_INDEX)
define([WARNING_END],  QUEUE_INDEX)
# Keep it last!
define([LAST_QUEUE],   QUEUE_INDEX)

# names of message types
# A â†’ Î²
define([WARNING_NAME], [warning])
define([ERROR_NAME],   [error])
define([QUERY_NAME],   [query])</pre>
<pre title="messages.json.m4">#      _________      ___________
# ---&gt;/  ERROR  \---&gt;/ NEXT_ITEM \---.
#     |  QUERY  |    \___________/&lt;--'
#     \_WARNING_/

# A â†’ Î²
# Î²
define([ERROR], [

	# transition to the next node
	define([$0], defn([NEXT_ITEM]))

	divert($0_QU),
	"$0_NAME": LB()
		{"[$1]": "$2"}dnl
divert($0_END)
	RB()dnl
divert(-1)
])

# Î²
define([NEXT_ITEM], [

	divert($0_QU),
		{"[$1]": "$2"}dnl
divert(-1)
])

# A â†’ Î²
define([QUERY],   defn([ERROR]))
define([WARNING], defn([ERROR]))

divert(0)dnl
{"messages": {
	"_comment": "DONTE()"dnl
divert(LAST_QUEUE)
}}
divert(-1)</pre>
<table class="table"><tbody><tr><th style="width:100%" title="vstupnÃ­ soubory"><a href="../gfiles/rootb.m4" title="localhost">rootb.m4</a>&nbsp;&nbsp;&nbsp;<a href="../messages/queues.m4" title="localhost">queues.m4</a>&nbsp;&nbsp;&nbsp;<a href="../messages/messages.json.m4" title="localhost">messages.json.m4</a>&nbsp;&nbsp;&nbsp;<a href="../messages/code.m4" title="localhost">code.m4</a>&nbsp;&nbsp;&nbsp;<a href="../messages/messages.mc" title="localhost">messages.mc</a></th><th title="vÃ½stupnÃ­ soubor"><a href="../messages/messages.json" title="localhost">messages.json</a></th></tr></tbody></table>
<pre title="pÅ™Ã­kaz">
~]$ <strong>m4 rootb.m4 queues.m4 messages.json.m4 code.m4 messages.mc &gt; messages.json</strong>
</pre>
<pre title="messages.json">{"messages": {
	"_comment": "DO NOT EDIT! This file is generated automatically!",
	"query": [
		{"READABLE": "Is badly written M4 code readable [N/y]?"}
	],
	"error": [
		{"COMPLEX": "!\"#$%&amp;'()*+,-./:;&lt;=&gt;?@[\\]^_`{|}~"},
		{"SUCCESS": "Complex M4 code failed successfully."},
		{"NOFAULT": "It's not a language fault!"}
	],
	"warning": [
		{"ADDICTIVE": "Programming in M4 is addictive!"},
		{"NO_ERRORS": "No other errors detected."}
	]
}}</pre>
<h3 id="m4-ini-nespojity-index-front"><a href="#m4-ini-nespojity-index-front" title="âš“">A.12</a>&nbsp;&nbsp;<code>[]</code> INI â€“ nespojitÃ½ index front&nbsp;<a href="#m4-toc-ini-nespojity-index-front" title="Obsah" class="m4-jmp">â˜°</a></h3>
<p>PÅ™Ã­klad pouÅ¾Ã­vÃ¡ tÅ™i automaty a&nbsp;dvÄ› vÃ½stupnÃ­ fronty ÄÃ­slo <code>2</code> a <code>4</code> definovanÃ© v oddÄ›lenÃ©m souboru.
NÃ¡zvy INI sekcÃ­ jsou generovÃ¡ny Å™etÄ›zenÃ­m symbolÅ¯.
PÅ™Ã­klad pouÅ¾Ã­vÃ¡ stejnÃ½ soubor pro vÃ½stupnÃ­ fronty jako <a href="#m4-json-generovane-indexy-front" title="[] JSON â€“ generovanÃ© indexy front">pÅ™Ã­klad</a> pro generovÃ¡nÃ­ JSON.</p>
<pre title="messages.ini.m4">#      _________      ___________
# ---&gt;/  ERROR  \---&gt;/ NEXT_ITEM \---.
#     |  QUERY  |    \___________/&lt;--'
#     \_WARNING_/

# A â†’ Î²
# Î²
define([ERROR], [

	divert($0_QU)
BRAC($0_NAME)
[$1]="$2"
divert(-1)

	# transition to the next node
	define([$0], defn([NEXT_ITEM]))
])

# A â†’ Î²
define([QUERY],   defn([ERROR]))
define([WARNING], defn([ERROR]))

# A â†’ Î²
define([NEXT_ITEM], [

	divert($0_QU)dnl
[$1]="$2"
divert(-1)
])

divert(0)dnl
; DONTE()
divert(-1)</pre>
<table class="table"><tbody><tr><th style="width:100%" title="vstupnÃ­ soubory"><a href="../gfiles/rootb.m4" title="localhost">rootb.m4</a>&nbsp;&nbsp;&nbsp;<a href="../messages/messages.ini.m4" title="localhost">messages.ini.m4</a>&nbsp;&nbsp;&nbsp;<a href="../messages/queues.m4" title="localhost">queues.m4</a>&nbsp;&nbsp;&nbsp;<a href="../messages/code.m4" title="localhost">code.m4</a>&nbsp;&nbsp;&nbsp;<a href="../messages/messages.mc" title="localhost">messages.mc</a></th><th title="vÃ½stupnÃ­ soubor"><a href="../messages/messages.ini" title="localhost">messages.ini</a></th></tr></tbody></table>
<pre title="pÅ™Ã­kaz">
~]$ <strong>m4 rootb.m4 messages.ini.m4 queues.m4 code.m4 messages.mc &gt; messages.ini</strong>
</pre>
<pre title="messages.ini">; DO NOT EDIT! This file is generated automatically!

[query]
READABLE="Is badly written M4 code readable [N/y]?"

[error]
COMPLEX="!\"#$%&amp;'()*+,-./:;&lt;=&gt;?@[\\]^_`{|}~"
SUCCESS="Complex M4 code failed successfully."
NOFAULT="It's not a language fault!"

[warning]
ADDICTIVE="Programming in M4 is addictive!"
NO_ERRORS="No other errors detected."</pre>
<h3 id="m4-xml-smisene-zpravy"><a href="#m4-xml-smisene-zpravy" title="âš“">A.13</a>&nbsp;&nbsp;<code>[]</code> XML â€“ smÃ­Å¡enÃ© zprÃ¡vy&nbsp;<a href="#m4-toc-xml-smisene-zpravy" title="Obsah" class="m4-jmp">â˜°</a></h3>
<p>PÅ™Ã­klad pouÅ¾Ã­vÃ¡ jednu vÃ½stupnÃ­ frontu ÄÃ­slo <code>1</code> pro uzavÃ­racÃ­ znaÄku <code>&lt;/messages&gt;</code>.</p>
<pre title="mixed.xml.m4"># A â†’ Î²
# Î²
define([ERROR], [

	divert(0)dnl
	&lt;$0_NAME&gt;
		&lt;name&gt;[$1]&lt;/name&gt;
		&lt;value&gt;$2&lt;/value&gt;
	&lt;/$0_NAME&gt;
divert(-1)
])

# A â†’ Î²
define([QUERY], defn([ERROR]))
define([WARNING], defn([ERROR]))

divert(0)dnl
&lt;!-- DONTE() --&gt;
&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;messages&gt;
divert(1)dnl
&lt;/messages&gt;
divert(-1)</pre>
<table class="table"><tbody><tr><th style="width:100%" title="vstupnÃ­ soubory"><a href="../gfiles/rootb.m4" title="localhost">rootb.m4</a>&nbsp;&nbsp;&nbsp;<a href="../messages/queues.m4" title="localhost">queues.m4</a>&nbsp;&nbsp;&nbsp;<a href="../messages/mixed.xml.m4" title="localhost">mixed.xml.m4</a>&nbsp;&nbsp;&nbsp;<a href="../messages/markup.m4" title="localhost">markup.m4</a>&nbsp;&nbsp;&nbsp;<a href="../messages/messages.mc" title="localhost">messages.mc</a></th><th title="vÃ½stupnÃ­ soubor"><a href="../messages/mixed.xml" title="localhost">mixed.xml</a></th></tr></tbody></table>
<pre title="pÅ™Ã­kaz">
~]$ <strong>m4 rootb.m4 queues.m4 mixed.xml.m4 markup.m4 messages.mc &gt; mixed.xml</strong>
</pre>
<pre title="mixed.xml">&lt;!-- DO NOT EDIT! This file is generated automatically! --&gt;
&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;messages&gt;
	&lt;error&gt;
		&lt;name&gt;COMPLEX&lt;/name&gt;
		&lt;value&gt;!"#$%&amp;amp;'()*+,-./:;&amp;lt;=&amp;gt;?@[\]^_`{|}~&lt;/value&gt;
	&lt;/error&gt;
	&lt;query&gt;
		&lt;name&gt;READABLE&lt;/name&gt;
		&lt;value&gt;Is badly written M4 code readable [N/y]?&lt;/value&gt;
	&lt;/query&gt;
	&lt;error&gt;
		&lt;name&gt;SUCCESS&lt;/name&gt;
		&lt;value&gt;Complex M4 code failed successfully.&lt;/value&gt;
	&lt;/error&gt;
	&lt;warning&gt;
		&lt;name&gt;ADDICTIVE&lt;/name&gt;
		&lt;value&gt;Programming in M4 is addictive!&lt;/value&gt;
	&lt;/warning&gt;
	&lt;error&gt;
		&lt;name&gt;NOFAULT&lt;/name&gt;
		&lt;value&gt;It's not a language fault!&lt;/value&gt;
	&lt;/error&gt;
	&lt;warning&gt;
		&lt;name&gt;NO_ERRORS&lt;/name&gt;
		&lt;value&gt;No other errors detected.&lt;/value&gt;
	&lt;/warning&gt;
&lt;/messages&gt;</pre>
<h3 id="m4-xml-oddelene-zpravy"><a href="#m4-xml-oddelene-zpravy" title="âš“">A.14</a>&nbsp;&nbsp;<code>[]</code> XML â€“ oddÄ›lenÃ© zprÃ¡vy&nbsp;<a href="#m4-toc-xml-oddelene-zpravy" title="Obsah" class="m4-jmp">â˜°</a></h3>
<p>PÅ™Ã­klad seskupuje zprÃ¡vy podle jejich typu pomocÃ­ vÃ½stupnÃ­ch front.</p>
<pre title="messages.xml.m4"># A â†’ Î²
# Î²
define([ERROR], [

	# transition to the next node
	define([$0], defn([NEXT_ITEM]))

	divert($0_QU)dnl
	&lt;$0_NAME&gt;
		&lt;item&gt;
			&lt;name&gt;[$1]&lt;/name&gt;
			&lt;value&gt;$2&lt;/value&gt;
		&lt;/item&gt;
divert($0_END)dnl
	&lt;/$0_NAME&gt;
divert(-1)
])

# Î²
define([NEXT_ITEM], [

	divert($0_QU)dnl
		&lt;item&gt;
			&lt;name&gt;[$1]&lt;/name&gt;
			&lt;value&gt;$2&lt;/value&gt;
		&lt;/item&gt;
divert(-1)
])

# A â†’ Î²
define([QUERY],        defn([ERROR]))
define([WARNING],      defn([ERROR]))

divert(0)dnl
&lt;!-- DONTE() --&gt;
&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;messages&gt;
divert(LAST_QUEUE)dnl
&lt;/messages&gt;
divert(-1)</pre>
<table class="table"><tbody><tr><th style="width:100%" title="vstupnÃ­ soubory"><a href="../gfiles/rootb.m4" title="localhost">rootb.m4</a>&nbsp;&nbsp;&nbsp;<a href="../messages/queues.m4" title="localhost">queues.m4</a>&nbsp;&nbsp;&nbsp;<a href="../messages/messages.xml.m4" title="localhost">messages.xml.m4</a>&nbsp;&nbsp;&nbsp;<a href="../messages/markup.m4" title="localhost">markup.m4</a>&nbsp;&nbsp;&nbsp;<a href="../messages/messages.mc" title="localhost">messages.mc</a></th><th title="vÃ½stupnÃ­ soubor"><a href="../messages/messages.xml" title="localhost">messages.xml</a></th></tr></tbody></table>
<pre title="pÅ™Ã­kaz">
~]$ <strong>m4 rootb.m4 queues.m4 messages.xml.m4 markup.m4 messages.mc &gt; messages.xml</strong>
</pre>
<pre title="messages.xml">&lt;!-- DO NOT EDIT! This file is generated automatically! --&gt;
&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;messages&gt;
	&lt;query&gt;
		&lt;item&gt;
			&lt;name&gt;READABLE&lt;/name&gt;
			&lt;value&gt;Is badly written M4 code readable [N/y]?&lt;/value&gt;
		&lt;/item&gt;
	&lt;/query&gt;
	&lt;error&gt;
		&lt;item&gt;
			&lt;name&gt;COMPLEX&lt;/name&gt;
			&lt;value&gt;!"#$%&amp;amp;'()*+,-./:;&amp;lt;=&amp;gt;?@[\]^_`{|}~&lt;/value&gt;
		&lt;/item&gt;
		&lt;item&gt;
			&lt;name&gt;SUCCESS&lt;/name&gt;
			&lt;value&gt;Complex M4 code failed successfully.&lt;/value&gt;
		&lt;/item&gt;
		&lt;item&gt;
			&lt;name&gt;NOFAULT&lt;/name&gt;
			&lt;value&gt;It's not a language fault!&lt;/value&gt;
		&lt;/item&gt;
	&lt;/error&gt;
	&lt;warning&gt;
		&lt;item&gt;
			&lt;name&gt;ADDICTIVE&lt;/name&gt;
			&lt;value&gt;Programming in M4 is addictive!&lt;/value&gt;
		&lt;/item&gt;
		&lt;item&gt;
			&lt;name&gt;NO_ERRORS&lt;/name&gt;
			&lt;value&gt;No other errors detected.&lt;/value&gt;
		&lt;/item&gt;
	&lt;/warning&gt;
&lt;/messages&gt;</pre>
<h3 id="m4-bash-cmd-echo-retezec"><a href="#m4-bash-cmd-echo-retezec" title="âš“">A.15</a>&nbsp;&nbsp;<code>[]</code> Bash <code>~]$ echo &quot;Å™etÄ›zec&quot;</code>&nbsp;<a href="#m4-toc-bash-cmd-echo-retezec" title="Obsah" class="m4-jmp">â˜°</a></h3>
<pre title="doubleq.sh.m4"># A â†’ Î²
# Î²
define([ERROR], [

	divert(0)dnl
echo "$2"
divert(-1)
])

# A â†’ Î²
define([QUERY], defn([ERROR]))
define([WARNING], defn([ERROR]))

divert(0)dnl
#!/bin/bash
#
[#] DONTE()

divert(-1)</pre>
<table class="table"><tbody><tr><th style="width:100%" title="vstupnÃ­ soubory"><a href="../gfiles/rootb.m4" title="localhost">rootb.m4</a>&nbsp;&nbsp;&nbsp;<a href="../messages/doubleq.sh.m4" title="localhost">doubleq.sh.m4</a>&nbsp;&nbsp;&nbsp;<a href="../messages/doubleq.m4" title="localhost">doubleq.m4</a>&nbsp;&nbsp;&nbsp;<a href="../messages/messages.mc" title="localhost">messages.mc</a></th><th title="vÃ½stupnÃ­ soubor"><a href="../messages/doubleq.sh" title="localhost">doubleq.sh</a></th></tr></tbody></table>
<pre title="pÅ™Ã­kaz">
~]$ <strong>m4 rootb.m4 doubleq.sh.m4 doubleq.m4 messages.mc &gt; doubleq.sh</strong>
</pre>
<pre title="doubleq.sh">#!/bin/bash
#
# DO NOT EDIT! This file is generated automatically!

echo ""\!"\"#$%&amp;'()*+,-./:;&lt;=&gt;?@[\\]^_\`{|}~"
echo "Is badly written M4 code readable [N/y]?"
echo "Complex M4 code failed successfully."
echo "Programming in M4 is addictive"\!""
echo "It's not a language fault"\!""
echo "No other errors detected."</pre>
<h3 id="m4-bash-cmd-echo-aretezeca"><a href="#m4-bash-cmd-echo-aretezeca" title="âš“">A.16</a>&nbsp;&nbsp;<code>[]</code> Bash <code>~]$ echo 'Å™etÄ›zec'</code>&nbsp;<a href="#m4-toc-bash-cmd-echo-aretezeca" title="Obsah" class="m4-jmp">â˜°</a></h3>
<pre title="apost.sh.m4"># A â†’ Î²
# Î²
define([ERROR], [

	divert(0)dnl
echo '$2'
divert(-1)
])

# A â†’ Î²
define([QUERY], defn([ERROR]))
define([WARNING], defn([ERROR]))

divert(0)dnl
#!/bin/bash
#
[#] DONTE()

divert(-1)</pre>
<table class="table"><tbody><tr><th style="width:100%" title="vstupnÃ­ soubory"><a href="../gfiles/rootb.m4" title="localhost">rootb.m4</a>&nbsp;&nbsp;&nbsp;<a href="../messages/apost.sh.m4" title="localhost">apost.sh.m4</a>&nbsp;&nbsp;&nbsp;<a href="../messages/apost.m4" title="localhost">apost.m4</a>&nbsp;&nbsp;&nbsp;<a href="../messages/messages.mc" title="localhost">messages.mc</a></th><th title="vÃ½stupnÃ­ soubor"><a href="../messages/apost.sh" title="localhost">apost.sh</a></th></tr></tbody></table>
<pre title="pÅ™Ã­kaz">
~]$ <strong>m4 rootb.m4 apost.sh.m4 apost.m4 messages.mc &gt; apost.sh</strong>
</pre>
<pre title="apost.sh">#!/bin/bash
#
# DO NOT EDIT! This file is generated automatically!

echo '!"#$%&amp;'\''()*+,-./:;&lt;=&gt;?@[\]^_`{|}~'
echo 'Is badly written M4 code readable [N/y]?'
echo 'Complex M4 code failed successfully.'
echo 'Programming in M4 is addictive!'
echo 'It'\''s not a language fault!'
echo 'No other errors detected.'</pre>
<h2 id="m4-priklady-preprocesoru"><a href="#m4-priklady-preprocesoru" title="âš“">B</a>&nbsp;&nbsp;PÅ™Ã­klady preprocesoru&nbsp;<a href="#m4-toc-priklady-preprocesoru" title="Obsah" class="m4-jmp">â˜°</a></h2>
<div class="rs-tip-major m4-tip">Znaky {<code>`'</code>, <code>[]</code>, <strong><code>â‚â†</code></strong>, <code>ã€–ã€—</code>} v&nbsp;nÃ¡zvu pÅ™Ã­kladu <a href="#m4-rizeni-expanze-neterminalu" title="Å˜Ã­zenÃ­ expanze neterminÃ¡lÅ¯">Å™Ã­dÃ­ expanzi neterminÃ¡lÅ¯</a>.</div>
<p id="m4-toc-ba-preprocesor-jazyka-c-a-m4">&nbsp;&nbsp;&nbsp;<a href="#m4-ba-preprocesor-jazyka-c-a-m4">B.1&nbsp;&nbsp;<code>`'</code> Preprocesor jazyka C&nbsp;a&nbsp;M4</a></p>
<p id="m4-toc-ba-css-komentare">&nbsp;&nbsp;&nbsp;<a href="#m4-ba-css-komentare">B.2&nbsp;&nbsp;<code>`'</code> CSS â€“ komentÃ¡Å™e</a></p>
<p id="m4-toc-bash-netisknutelne-znaky">&nbsp;&nbsp;&nbsp;<a href="#m4-bash-netisknutelne-znaky">B.3&nbsp;&nbsp;<strong><code>â‚â†</code></strong> Bash â€“ netisknutelnÃ© znaky</a></p>
<h3 id="m4-ba-preprocesor-jazyka-c-a-m4"><a href="#m4-ba-preprocesor-jazyka-c-a-m4" title="âš“">B.1</a>&nbsp;&nbsp;<code>`'</code> Preprocesor jazyka C&nbsp;a&nbsp;M4&nbsp;<a href="#m4-toc-ba-preprocesor-jazyka-c-a-m4" title="Obsah" class="m4-jmp">â˜°</a></h3>
<p>Direktivy <a href="https://cs.wikipedia.org/wiki/Preprocesor_jazyka_C" title="Preprocesor jazyka C">CPP</a> jsou pro M4 jednoÅ™Ã¡dkovÃ½ komentÃ¡Å™, coÅ¾ brÃ¡nÃ­ neÅ¾Ã¡doucÃ­ expanzi stejnÄ› pojmenovanÃ½ch maker.
Definujeme-li bezpeÄnÄ›jÅ¡Ã­ makro <code>SAF()</code>, stejnÄ› pojmenovanÃ© makro <code>SAF ()</code> nebude pÅ™epsÃ¡no.
JmennÃ½ prostor <abbr title="Preprocesor jazyka C">CPP</abbr> tak <strong>mÅ¯Å¾e</strong> bÃ½t zcela oddÄ›len od jmennÃ©ho prostoru M4.
ProblematickÃ½ znak <code>`</code> je skryt do makra <code>LQ()</code>.
Apostrof <code>'</code> ve zdrojovÃ©m kÃ³du niÄemu nevadÃ­.
Apostrof uvnitÅ™ makra <code>ORD</code> je skryt do makra <code>RQ()</code>.
VÅ¡imnÄ›te si jmen funkcÃ­ <code>define ()</code> nebo <code>ifelse ()</code> a&nbsp;kde je expandovÃ¡n <code>SYMBOL</code>.</p>
<pre title="file.c.m4"># ORDinary and SAFe macros have different expansion:

# A â†’ Î²
define(`ORD', `$0_M4 RQ()SYMBOL`'RQ()')
define(`SAF', `ifelse(`$#', `0', ``$0'', `($1) * ($1)	/* $0_M4 SYMBOL */')')

divert(0)dnl</pre>
<pre title="file.c">/*
 * DONTE()
 */

#include &lt;stdio.h&gt;	/* CPP SYMBOL */

#define SYMBOL		/* CPP SYMBOL */
#define SAF(x)		((x) * ((x) - 1))	/* CPP SYMBOL */
#define ORD(x)		CPP SYMBOL x

int a = SAF (1 + 1);	/* CPP */
int b = SAF(2 + 2);	/* M4 */
char chr = 'x';
char foo[] = "Let's say: 'SYMBOL'";
char bar[] = "ORD (args, are, ignored)";

static void define (char *s) { puts(s);}
static void ifelse (char *s) { puts(s);}

int main(void)
{

#ifdef SYMBOL			/* SYMBOL */
	puts("LQ()SYMBOL'");	/* note: `LQ()SYMBOL' */
#endif

	define (foo);		/* SYMBOL */
	ifelse (bar);		/* SYMBOL() */

	return 0;
}</pre>
<table class="table"><tbody><tr><th style="width:100%" title="vstupnÃ­ soubory"><a href="../gfiles/rootq.m4" title="localhost">rootq.m4</a>&nbsp;&nbsp;&nbsp;<a href="../preproc/file.c.m4" title="localhost">file.c.m4</a>&nbsp;&nbsp;&nbsp;<a href="../preproc/file.c" title="localhost">file.c</a></th><th title="vÃ½stupnÃ­ soubor"><a href="../preproc/preproc.file.c" title="localhost">preproc.file.c</a></th></tr></tbody></table>
<pre title="pÅ™Ã­kaz">
~]$ <strong>m4 -DSYMBOL='Hello, world!' rootq.m4 file.c.m4 file.c &gt; preproc.file.c</strong>
</pre>
<pre title="preproc.file.c">/*
 * DO NOT EDIT! This file is generated automatically!
 */

#include &lt;stdio.h&gt;	/* CPP SYMBOL */

#define SYMBOL		/* CPP SYMBOL */
#define SAF(x)		((x) * ((x) - 1))	/* CPP SYMBOL */
#define ORD(x)		CPP SYMBOL x

int a = SAF (1 + 1);	/* CPP */
int b = (2 + 2) * (2 + 2)	/* SAF_M4 Hello, world! */;	/* M4 */
char chr = 'x';
char foo[] = "Let's say: 'Hello, world!'";
char bar[] = "ORD_M4 'Hello, world!' (args, are, ignored)";

static void define (char *s) { puts(s);}
static void ifelse (char *s) { puts(s);}

int main(void)
{

#ifdef SYMBOL			/* SYMBOL */
	puts("`Hello, world!'");	/* note: LQ()SYMBOL */
#endif

	define (foo);		/* Hello, world! */
	ifelse (bar);		/* Hello, world! */

	return 0;
}</pre>
<h3 id="m4-ba-css-komentare"><a href="#m4-ba-css-komentare" title="âš“">B.2</a>&nbsp;&nbsp;<code>`'</code> CSS â€“ komentÃ¡Å™e&nbsp;<a href="#m4-toc-ba-css-komentare" title="Obsah" class="m4-jmp">â˜°</a></h3>
<p>CSS pouÅ¾Ã­vÃ¡ znak <code>#</code> pro kÃ³dy barev, coÅ¾ je takÃ© zaÄÃ¡tek jednoÅ™Ã¡dkovÃ©ho M4 komentÃ¡Å™e.
KlÃ­ÄovÃ© slovo <code>changecom(/*,*/)</code> nastavÃ­ vÃ­ceÅ™Ã¡dkovÃ½ komentÃ¡Å™ <code>/* â€¦ */</code> a&nbsp;pÅ™epÃ­Å¡e se na <abbr title="epsilon â€“ prÃ¡zdnÃ½ symbol"><code>Îµ</code></abbr>.
KomentÃ¡Å™e se vypÃ­najÃ­ stejnÃ½m klÃ­ÄovÃ½m slovem <code>changecom</code> bez parametrÅ¯.</p>
<pre title="file.css.m4"># CSS preprocessor

define(`WIDTH', `3px')
define(`TOP', `#f00')
define(`SIDES', `#0f0')
define(`BOTTOM', `#00f')
define(`SITE', `www.root.cz')
define(`FILE', `img.jpg')
define(`PATH', `http://SITE/FILE')

divert(0)dnl</pre>
<pre title="file.css">/* DONTE() */changecom(/*,*/)
/* DONTE() */

div {
	border-width: WIDTH;
	border-color: TOP SIDES BOTTOM; 
	background-image: url('PATH');
}

/* DONTE() */
changecom/* DONTE() */changecom(/*,*/)</pre>
<table class="table"><tbody><tr><th style="width:100%" title="vstupnÃ­ soubory"><a href="../gfiles/rootq.m4" title="localhost">rootq.m4</a>&nbsp;&nbsp;&nbsp;<a href="../preproc/file.css.m4" title="localhost">file.css.m4</a>&nbsp;&nbsp;&nbsp;<a href="../preproc/file.css" title="localhost">file.css</a></th><th title="vÃ½stupnÃ­ soubor"><a href="../preproc/preproc.file.css" title="localhost">preproc.file.css</a></th></tr></tbody></table>
<pre title="pÅ™Ã­kaz">
~]$ <strong>m4 -DSYMBOL='Hello, world!' rootq.m4 file.css.m4 file.css &gt; preproc.file.css</strong>
</pre>
<pre title="preproc.file.css">/* DO NOT EDIT! This file is generated automatically! */
/* DONTE() */

div {
	border-width: 3px;
	border-color: #f00 #0f0 #00f; 
	background-image: url('http://www.root.cz/img.jpg');
}

/* DONTE() */
/* DO NOT EDIT! This file is generated automatically! */</pre>
<h3 id="m4-bash-netisknutelne-znaky"><a href="#m4-bash-netisknutelne-znaky" title="âš“">B.3</a>&nbsp;&nbsp;<strong><code>â‚â†</code></strong> Bash â€“ netisknutelnÃ© znaky&nbsp;<a href="#m4-toc-bash-netisknutelne-znaky" title="Obsah" class="m4-jmp">â˜°</a></h3>
<p>Bash pouÅ¾Ã­vÃ¡ oba znaky <code>`</code> <code>[</code>.
Nechceme-li je skrÃ½vat do makra <code>LQ()</code> nebo <code>LB()</code>, mÅ¯Å¾eme pouÅ¾Ã­t pro <a href="#m4-rizeni-expanze-neterminalu" title="Å˜Ã­zenÃ­ expanze neterminÃ¡lÅ¯">Å™Ã­zenÃ­ expanze neterminÃ¡lÅ¯</a> netisknutelnÃ© znaky, viz. pÅ™Ã­klad:</p>
<pre title="file.sh.m4"># vim:mps+=<strong>â‚</strong>\:<strong>â†</strong>

# A â†’ Î²
define(<strong>â‚</strong>LEFT<strong>â†</strong>, <strong>â‚</strong>$<strong>â‚</strong>#<strong>â†</strong><strong>â†</strong>)
define(<strong>â‚</strong>OP<strong>â†</strong>, <strong>â‚</strong>-eq<strong>â†</strong>)
define(<strong>â‚</strong>RIGHT<strong>â†</strong>, <strong>â‚</strong>0<strong>â†</strong>)

divert(0)dnl</pre>
<pre title="file.sh">#!/bin/bash
#
<strong>â‚</strong>#<strong>â†</strong> DONTE()

HELLO=`echo 'SYMBOL'`

if [[ LEFT OP RIGHT ]]
then
	echo $HELLO
fi</pre>
<table class="table"><tbody><tr><th style="width:100%" title="vstupnÃ­ soubory"><a href="../gfiles/rootn.m4" title="localhost">rootn.m4</a>&nbsp;&nbsp;&nbsp;<a href="../preproc/file.sh.m4" title="localhost">file.sh.m4</a>&nbsp;&nbsp;&nbsp;<a href="../preproc/file.sh" title="localhost">file.sh</a></th><th title="vÃ½stupnÃ­ soubor"><a href="../preproc/preproc.file.sh" title="localhost">preproc.file.sh</a></th></tr></tbody></table>
<pre title="pÅ™Ã­kaz">
~]$ <strong>m4 -DSYMBOL='Hello, world!' rootn.m4 file.sh.m4 file.sh &gt; preproc.file.sh</strong>
</pre>
<pre title="preproc.file.sh">#!/bin/bash
#
# DO NOT EDIT! This file is generated automatically!

HELLO=`echo 'Hello, world!'`

if [[ $# -eq 0 ]]
then
	echo $HELLO
fi</pre>
<h2 id="m4-m4-priklady"><a href="#m4-m4-priklady" title="âš“">C</a>&nbsp;&nbsp;M4 â€“ pÅ™Ã­klady&nbsp;<a href="#m4-toc-m4-priklady" title="Obsah" class="m4-jmp">â˜°</a></h2>
<div class="rs-tip-major m4-tip">Znaky {<code>`'</code>, <code>[]</code>, <strong><code>â‚â†</code></strong>, <code>ã€–ã€—</code>} v&nbsp;nÃ¡zvu pÅ™Ã­kladu <a href="#m4-rizeni-expanze-neterminalu" title="Å˜Ã­zenÃ­ expanze neterminÃ¡lÅ¯">Å™Ã­dÃ­ expanzi neterminÃ¡lÅ¯</a>.</div>
<p id="m4-toc-json-leva-zavorka-b">&nbsp;&nbsp;&nbsp;<a href="#m4-json-leva-zavorka-b">C.1&nbsp;&nbsp;<code>[]</code> JSON â€“ levÃ¡ zÃ¡vorka <code>[</code></a></p>
<p id="m4-toc-bash-pocitadla">&nbsp;&nbsp;&nbsp;<a href="#m4-bash-pocitadla">C.2&nbsp;&nbsp;<code>[]</code> Bash â€“ poÄÃ­tadla</a></p>
<p id="m4-toc-h-zavorky-h-dnl">&nbsp;&nbsp;&nbsp;<a href="#m4-h-zavorky-h-dnl">C.3&nbsp;&nbsp;<code>[]</code> .h â€“ zÃ¡vorky <code>[]</code>, <code>[,]</code>, <code>[#]</code>, <code>[dnl]</code></a></p>
<p id="m4-toc-awk-priklady-bezpecnejsich-maker">&nbsp;&nbsp;&nbsp;<a href="#m4-awk-priklady-bezpecnejsich-maker">C.4&nbsp;&nbsp;<code>[]</code> AWK â€“ pÅ™Ã­klady bezpeÄnÄ›jÅ¡Ã­ch maker</a></p>
<h3 id="m4-json-leva-zavorka-b"><a href="#m4-json-leva-zavorka-b" title="âš“">C.1</a>&nbsp;&nbsp;<code>[]</code> JSON â€“ levÃ¡ zÃ¡vorka <code>[</code>&nbsp;<a href="#m4-toc-json-leva-zavorka-b" title="Obsah" class="m4-jmp">â˜°</a></h3>
<p>UvnitÅ™ hranatÃ½ch zÃ¡vorek <code>[â€¦ se neterminÃ¡ly neexpandujÃ­ â€¦]</code>.
Proto je levÃ¡ hranatÃ¡ zÃ¡vorka <code>[</code> nahrazena makrem <code>LB()</code> z&nbsp;koÅ™enovÃ©ho souboru.</p>
<pre title="json.m4"># JSON

divert(0)dnl
{"foo": {
	"_comment": "DONTE()",
	"bar": LB()
		{"baz": "SYMBOL"}
	]
}}</pre>
<table class="table"><tbody><tr><th style="width:100%" title="vstupnÃ­ soubory"><a href="../gfiles/rootb.m4" title="localhost">rootb.m4</a>&nbsp;&nbsp;&nbsp;<a href="../hello_world/json.m4" title="localhost">json.m4</a></th><th title="vÃ½stupnÃ­ soubor"><a href="../hello_world/hello_world.json" title="localhost">hello_world.json</a></th></tr></tbody></table>
<pre title="pÅ™Ã­kaz">
~]$ <strong>m4 -DSYMBOL='Hello, world!' rootb.m4 json.m4 &gt; hello_world.json</strong>
</pre>
<pre title="hello_world.json">{"foo": {
	"_comment": "DO NOT EDIT! This file is generated automatically!",
	"bar": [
		{"baz": "Hello, world!"}
	]
}}</pre>
<h3 id="m4-bash-pocitadla"><a href="#m4-bash-pocitadla" title="âš“">C.2</a>&nbsp;&nbsp;<code>[]</code> Bash â€“ poÄÃ­tadla&nbsp;<a href="#m4-toc-bash-pocitadla" title="Obsah" class="m4-jmp">â˜°</a></h3>
<p>PoÄÃ­tadla <code>COUNT_UP</code> a <code>COUNT_DOWN</code> jsou definovÃ¡na v koÅ™enovÃ©m souboru.
NeterminÃ¡ly<br><code>[â€¦ uvnitÅ™ zÃ¡vorek â€¦]</code> nebudou expandovÃ¡ny, pouze se odeberou vnÄ›jÅ¡Ã­ zÃ¡vorky.
Nutno pouÅ¾Ã­t makro <code>LB()</code> z&nbsp;koÅ™enovÃ©ho souboru.</p>
<pre title="sh.m4"># A â†’ Î²
define([LEFT], [$[#]])
define([OP], [-eq])
define([RIGHT], [0])

# define two counters
# A â†’ Î²
define([__COUNTUP__], defn([COUNT_UP]))
define([__COUNTDN__], defn([COUNT_DOWN]))

# init counters
__COUNTUP__(10)
__COUNTDN__(10)

divert(0)dnl
#!/bin/bash
#
[#] DONTE()

if [ LEFT OP RIGHT ]
then
	echo '__COUNTUP__] SYMBOL LB()__COUNTDN__'
fi

if test LEFT OP RIGHT
then
	echo '__COUNTUP__] SYMBOL LB()__COUNTDN__'
fi

if LB()LB() LEFT OP RIGHT ]]
then
	echo '__COUNTUP__] SYMBOL LB()__COUNTDN__'
fi</pre>
<table class="table"><tbody><tr><th style="width:100%" title="vstupnÃ­ soubory"><a href="../gfiles/rootb.m4" title="localhost">rootb.m4</a>&nbsp;&nbsp;&nbsp;<a href="../hello_world/sh.m4" title="localhost">sh.m4</a></th><th title="vÃ½stupnÃ­ soubor"><a href="../hello_world/hello_world.sh" title="localhost">hello_world.sh</a></th></tr></tbody></table>
<pre title="pÅ™Ã­kaz">
~]$ <strong>m4 -DSYMBOL='Hello, world!' rootb.m4 sh.m4 &gt; hello_world.sh</strong>
</pre>
<pre title="hello_world.sh">#!/bin/bash
#
# DO NOT EDIT! This file is generated automatically!

if  LEFT OP RIGHT 
then
	echo '10] Hello, world! [10'
fi

if test $# -eq 0
then
	echo '11] Hello, world! [9'
fi

if [[ $# -eq 0 ]]
then
	echo '12] Hello, world! [8'
fi</pre>
<h3 id="m4-h-zavorky-h-dnl"><a href="#m4-h-zavorky-h-dnl" title="âš“">C.3</a>&nbsp;&nbsp;<code>[]</code> .h â€“ zÃ¡vorky <code>[]</code>, <code>[,]</code>, <code>[#]</code>, <code>[dnl]</code>&nbsp;<a href="#m4-toc-h-zavorky-h-dnl" title="Obsah" class="m4-jmp">â˜°</a></h3>
<p>PrÃ¡zdnÃ½ pÃ¡r <code>[]</code> (nebo prÃ¡zdnÃ½ symbol v zÃ¡vorkÃ¡ch <code>[Îµ]</code>) slouÅ¾Ã­ jako oddÄ›lovaÄ symbolÅ¯.
ZÃ¡vorky kolem znaku komentÃ¡Å™e <code>[#]</code> vypnou jeho pÅ¯vodnÃ­ vÃ½znam, stejnÄ› jako vypnou vÃ½znam <em>silnÄ›jÅ¡Ã­ho</em> M4 komentÃ¡Å™e <code>[dnl]</code>.
Vypnou takÃ© pÅ¯vodnÃ­ vÃ½znam ÄÃ¡rky <code>[,]</code> jako oddÄ›lovaÄe argumentÅ¯ maker.
Tyto symboly se stanou obyÄejnÃ½mi terminÃ¡lnÃ­mi symboly bez jakÃ©hokoliv vedlejÅ¡Ã­ho efektu.</p>
<pre title="h.m4"># A â†’ Î²
define([HELLO], [HELLO_WORLD])

divert(0)dnl
/*
 * [dnl] DONTE()
 */

[#]ifndef __[]HELLO[]_H
[#]define __[]HELLO[]_H

[#]define HELLO	SYMBOL

[#endif	/* __]HELLO[_H */]</pre>
<table class="table"><tbody><tr><th style="width:100%" title="vstupnÃ­ soubory"><a href="../gfiles/rootb.m4" title="localhost">rootb.m4</a>&nbsp;&nbsp;&nbsp;<a href="../hello_world/h.m4" title="localhost">h.m4</a></th><th title="vÃ½stupnÃ­ soubor"><a href="../hello_world/hello_world.h" title="localhost">hello_world.h</a></th></tr></tbody></table>
<pre title="pÅ™Ã­kaz">
~]$ <strong>m4 -DSYMBOL='Hello, world!' rootb.m4 h.m4 &gt; hello_world.h</strong>
</pre>
<pre title="hello_world.h">/*
 * dnl DO NOT EDIT! This file is generated automatically!
 */

#ifndef __HELLO_WORLD_H
#define __HELLO_WORLD_H

#define HELLO_WORLD	Hello, world!

#endif	/* __HELLO_WORLD_H */</pre>
<h3 id="m4-awk-priklady-bezpecnejsich-maker"><a href="#m4-awk-priklady-bezpecnejsich-maker" title="âš“">C.4</a>&nbsp;&nbsp;<code>[]</code> AWK â€“ pÅ™Ã­klady bezpeÄnÄ›jÅ¡Ã­ch maker&nbsp;<a href="#m4-toc-awk-priklady-bezpecnejsich-maker" title="Obsah" class="m4-jmp">â˜°</a></h3>
<p>UniverzÃ¡lnÃ­ vÃ½straha <code>DONTE</code> se ignoruje bez zÃ¡vorek, stejnÄ› jako <code>LB</code>, <code>RB</code>, â€¦
TakovÃ¡ makra explicitnÄ› vytvÃ¡Å™Ã­ vÃ½vojÃ¡Å™ skriptÅ¯, prohlÃ©dnÄ›te si koÅ™enovÃ½ soubor.</p>
<pre title="awk.m4"># AWK

divert(0)dnl
#!/bin/awk -f
#
[# DONTE()] ---&gt; "DONTE()"

BEGIN { print "DONTE[]() LB () LB() SYMBOL ]" }</pre>
<table class="table"><tbody><tr><th style="width:100%" title="vstupnÃ­ soubory"><a href="../gfiles/rootb.m4" title="localhost">rootb.m4</a>&nbsp;&nbsp;&nbsp;<a href="../hello_world/awk.m4" title="localhost">awk.m4</a></th><th title="vÃ½stupnÃ­ soubor"><a href="../hello_world/hello_world.awk" title="localhost">hello_world.awk</a></th></tr></tbody></table>
<pre title="pÅ™Ã­kaz">
~]$ <strong>m4 -DSYMBOL='Hello, world!' rootb.m4 awk.m4 &gt; hello_world.awk</strong>
</pre>
<pre title="hello_world.awk">#!/bin/awk -f
#
# DONTE() ---&gt; "DO NOT EDIT! This file is generated automatically!"

BEGIN { print "DONTE() LB () [ Hello, world! ]" }</pre>
<h2 id="m4-proc-pouzivat-m4-a-proc-ne"><a href="#m4-proc-pouzivat-m4-a-proc-ne" title="âš“">D</a>&nbsp;&nbsp;ProÄ pouÅ¾Ã­vat M4 a proÄ ne?&nbsp;<a href="#m4-toc-proc-pouzivat-m4-a-proc-ne" title="Obsah" class="m4-jmp">â˜°</a></h2>
<p id="m4-toc-proc-generovat-kod-v-m4">&nbsp;&nbsp;&nbsp;<a href="#m4-proc-generovat-kod-v-m4">D.1&nbsp;&nbsp;<code>ğŸ‘</code> ProÄ generovat kÃ³d v&nbsp;M4</a></p>
<p id="m4-toc-proc-se-vyhnout-m4">&nbsp;&nbsp;&nbsp;<a href="#m4-proc-se-vyhnout-m4">D.2&nbsp;&nbsp;<code>ğŸ‘</code> ProÄ se vyhnout M4</a></p>
<h3 id="m4-proc-generovat-kod-v-m4"><a href="#m4-proc-generovat-kod-v-m4" title="âš“">D.1</a>&nbsp;&nbsp;<code>ğŸ‘</code> ProÄ generovat kÃ³d v&nbsp;M4&nbsp;<a href="#m4-toc-proc-generovat-kod-v-m4" title="Obsah" class="m4-jmp">â˜°</a></h3>
<ul>
<li>pÅ™Ã­mÃ© pouÅ¾itÃ­ <a href="#m4-bezkontextova-gramatika" title="BezkontextovÃ¡ gramatika">bezkontextovÃ© gramatiky</a> (rekurze zdarma)
<ul><li>k transformaci dat staÄÃ­ napsat minimum M4 kÃ³du</li></ul></li>
<li>pÅ™Ã­mÃ© pouÅ¾itÃ­ automatÅ¯
<ul><li>moÅ¾nost vymodelovat si potÅ™ebnÃ© algoritmy (M4 nepotÅ™ebuje verze)</li></ul></li>
<li>pÅ™Ã­mÃ© pouÅ¾itÃ­ zÃ¡sobnÃ­kÅ¯
<ul><li>zÃ¡sobnÃ­ky propojenÃ© s&nbsp;automaty rozÅ¡iÅ™ujÃ­ moÅ¾nosti generÃ¡toru kÃ³du</li></ul></li>
<li>pÅ™Ã­mÃ© pouÅ¾itÃ­ vÃ½stupnÃ­ch front pro doÄasnÃ© uloÅ¾enÃ­ vÃ½slednÃ½ch ÄÃ¡stÃ­ kÃ³du
<ul><li>jednotlivÃ© fronty jsou na zÃ¡vÄ›r vypsÃ¡ny na vÃ½stup ve vzestupnÃ©m poÅ™adÃ­</li></ul></li>
<li>vyÅ¡Å¡Ã­ rychlost generovÃ¡nÃ­ kÃ³du (ve srovnÃ¡nÃ­ s&nbsp;XSLT)
<ul><li>nÃ­zkÃ© nÃ¡roky na vÃ½poÄetnÃ­ zdroje</li></ul></li>
</ul>
<h3 id="m4-proc-se-vyhnout-m4"><a href="#m4-proc-se-vyhnout-m4" title="âš“">D.2</a>&nbsp;&nbsp;<code>ğŸ‘</code> ProÄ se vyhnout M4&nbsp;<a href="#m4-toc-proc-se-vyhnout-m4" title="Obsah" class="m4-jmp">â˜°</a></h3>
<ul>
<li id="m4-low-level-language">univerzÃ¡lnÃ­ jazyk nÃ­zkÃ© ÃºrovnÄ› (podobnÄ› jako jazyk C)
<ul><li>nemÅ¯Å¾e konkurovat Ãºzce specializovanÃ½m jazykÅ¯m (napÅ™Ã­klad XSLT)</li></ul></li>
<li id="m4-forgotten-language">neexistujÃ­cÃ­ komunita vÃ½vojÃ¡Å™Å¯ (podzim 2019)
<ul><li>M4 je zapomenutÃ½ jazyk, mÃ¡lo existujÃ­cÃ­ch projektÅ¯</li></ul></li>
<li id="m4-unusual-language">neobvyklÃ© programovacÃ­ paradigma vyÅ¾adujÃ­cÃ­ splnÄ›nÃ­ <a href="#m4-predpoklady-pro-zvladnuti-m4" title="PÅ™edpoklady pro zvlÃ¡dnutÃ­ M4">nÄ›kolika pÅ™edpokladÅ¯</a>
<ul><li>M4 je proto tÄ›Å¾kÃ½ jazyk</li></ul></li>
<li id="m4-experience-dependent">produktivita znaÄnÄ› zÃ¡visÃ­ na zkuÅ¡enostech (moÅ¾nÃ½ problÃ©m s&nbsp;termÃ­ny)
<ul><li>schopnost myslet v&nbsp;M4 je nutnost</li></ul></li>
<li id="m4-hard-maintenance">ÃºdrÅ¾ba Å¡patnÄ› napsanÃ©ho M4 kÃ³du je tÄ›Å¾kÃ¡
<ul><li>existujÃ­cÃ­ M4 kÃ³d je snadnÃ© promÄ›nit ve zmatek</li></ul></li>
</ul>
</div>
</div>
<!-- Sklik-kontext-stop -->

</div>
</div>
</div>

<div id="sidebar" class="js-sticker-wrapper sidebar layout-columns__item--sidebar layout-columns__item design-sidebar design-tile--version-2 design-tile">

	<div class="box-actualities--details page-block--actualities page-block design-box">
		<div class="section__header">
			<h2 class="section__heading">
				Autor ÄlÃ¡nku
			</h2>
		</div>

		<div id="microdata-authors">
			<div class="author clearfix" itemprop="author" itemtype="http://schema.org/Person" itemscope="">
				<div class="author__pic avatar-round">
					<a class="avatar__wrap" href="#" title="Profil autora">
						<img class="avatar__img" src="../img/face.png" width="70" height="70" alt="Josef KubÃ­n">
					</a>
				</div>
				<div class="author__info">
					<div class="row">
						<h3 class="author__name">
							<a href="#">
								<span itemprop="name">Josef KubÃ­n</span>
							</a>
						</h3>
	
					</div>
	
					<div class="author__bio urs">
						<p><span class="rs-person">Josef KubÃ­n</span> vystudoval Fakultu&nbsp;informatiky Masarykovy univerzity v BrnÄ›, zabÃ½val se teoretickou informatikou a&nbsp;programovÃ¡nÃ­m hardware.
Pracuje ve spoleÄnosti Red&nbsp;Hat v&nbsp;<abbr title="Global Support Services">GSS</abbr>.</p>
					</div>
				</div>
			</div>
		</div>

		<div class="row design-impressum__item-wrapper--rubrics design-impressum__item-wrapper">
			<h3 class="rubrics__heading rubrics__heading--sidebar">
				<a class="design-label--empty design-label" href="/n/">NÃ¡lepky:</a>
			</h3>
			<ul class="rubrics__list--sidebar rubrics__list design-list--labels design-list list-reset">
				<li>
					<a class="rubrics__item design-label--default design-label" href="/n/m4/">M4</a>
				</li>
				<li>
					<a class="rubrics__item design-label--default design-label" href="/n/vim/">Vim</a>
				</li>
				<li>
					<a class="rubrics__item design-label--default design-label" href="/n/c-c/">C</a>
				</li>
			</ul>
		</div>
	</div>
</div>
</div>
</div>
</div>
</body>
</html>
