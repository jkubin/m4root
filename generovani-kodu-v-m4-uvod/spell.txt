# vim:wrap:spell:spelllang=cs,en
#
# DO NOT EDIT! This file is generated automatically!
#
# __SOURCE([20200502-16:27:12, intro.mc, 5247e25, 07e3329])

7
GenerovÃ¡nÃ­ kÃ³du v M4: Ãºvod

# number of characters in perex (200 Â±10 is recommended): 226
16
Makro procesor M4 se pouÅ¾Ã­vÃ¡ ke generovÃ¡nÃ­ libovolnÄ› sloÅ¾itÃ©ho kÃ³du z jednoduchÃ©ho zdrojovÃ©ho kÃ³du.
ÃšvodnÃ­ dÃ­l seriÃ¡lu obsahuje jeho historii, zÃ¡kladnÃ­ principy jazyka, pÅ™Ã­klady pouÅ¾itÃ­ a nutnÃ© pÅ™edpoklady pro jeho zvlÃ¡dnutÃ­.

24
Ãšvod

30
ÄŒtenÃ¡Å™i tohoto seriÃ¡lu se nauÄÃ­ psÃ¡t skripty pro strojovÃ© generovÃ¡nÃ­ kÃ³du.
StrojovÄ› generovanÃ½ kÃ³d mÅ¯Å¾e bÃ½t libovolnÄ› sloÅ¾itÃ½ a mÅ¯Å¾e obsahovat dalÅ¡Ã­ vnitÅ™nÃ­ zÃ¡vislosti.
VzÃ¡jemnÄ› zÃ¡vislÃ© soubory se sloÅ¾itÃ½m kÃ³dem jsou pro ÄlovÄ›ka jen tÄ›Å¾ce udrÅ¾itelnÃ© v konzistentnÃ­m stavu.
Je uÅ¾ nutnÃ© pouÅ¾Ã­t nÄ›jakÃ½ mechanismus pro generovÃ¡nÃ­ kÃ³du.
GenerovÃ¡nÃ­ kÃ³du provÃ¡dÃ­ nÃ¡stroj urÄenÃ½ pro transformaci textu â€“ makro procesor.

45
SeriÃ¡l je zamÄ›Å™en na praktickÃ© pouÅ¾itÃ­ univerzÃ¡lnÃ­ho makro procesoru M4 (dÃ¡le jen M4) pomocÃ­ malÃ½ch pÅ™Ã­kladÅ¯.
Popisuje takÃ© teoretickÃ½ zÃ¡klad vÅ¡ech implementacÃ­.
CÃ­lem seriÃ¡lu je seznÃ¡mit ÄtenÃ¡Å™e s tÃ­mto nÃ¡strojem (m4 â€“ je program pÅ™Ã­kazovÃ© Å™Ã¡dky) a takÃ© programovacÃ­m jazykem (M4 â€“ je programovacÃ­ jazyk).

Na co se pouÅ¾Ã­vÃ¡, jak se v nÄ›m programuje a jakÃ© jsou jeho vÃ½hody a nevÃ½hody.

59
[poznÃ¡mka]

59
VÃ­cejazyÄnÃ½ seriÃ¡l â€GenerovÃ¡nÃ­ kÃ³du v M4â€œ je generovÃ¡n M4 skripty,
kterÃ© (moÅ¾nÃ¡) usnadnÃ­ psanÃ­ ÄlÃ¡nkÅ¯ a seriÃ¡lÅ¯ pro www.root.cz (Root.cz â€“ informace nejen ze svÄ›ta Linuxu) takÃ© jinÃ½m autorÅ¯m.
VÃ½sledkem seriÃ¡lu je takÃ© sada ukÃ¡zkovÃ½ch skriptÅ¯ pro generovÃ¡nÃ­ kÃ³du.

61
ÃšvodnÃ­ dÃ­l popisuje zÃ¡kladnÃ­ principy jazyka na jednoduchÃ½ch pÅ™Ã­kladech.
VÅ¡echny pÅ™Ã­klady pouÅ¾Ã­vajÃ­ pÅ™episovacÃ­ pravidla bezkontextovÃ© gramatiky.
PozdÄ›ji se nauÄÃ­me pouÅ¾Ã­vat vÃ½stupnÃ­ fronty,
automaty, asociativnÃ­ pamÄ›ti, zÃ¡sobnÃ­ky a zÃ¡sobnÃ­kovÃ© automaty.
NauÄÃ­me se takÃ© psÃ¡t testovacÃ­ automaty pro testovÃ¡nÃ­ vstupnÃ­ch dat.

77
PÅ™Ã­klady pro ÄtenÃ¡Å™e

83
PÅ™Ã­klady pro ÄtenÃ¡Å™e tvoÅ™Ã­ komplementÃ¡rnÃ­ ÄÃ¡st seriÃ¡lu a budou do jistÃ© mÃ­ry vytvÃ¡Å™eny na zÃ¡kladÄ› podnÄ›tÅ¯ v diskuzi pod ÄlÃ¡nkem.
Na zaÄÃ¡tku kaÅ¾dÃ©ho dÃ­lu je popsÃ¡na nÄ›jakÃ¡ ÄÃ¡st jazyka M4 doplnÄ›nÃ¡ sadou pÅ™Ã­kladÅ¯ na konci.
KaÅ¾dÃ½ dÃ­l je moÅ¾nÃ© ÄÃ­st v libovolnÃ©m poÅ™adÃ­.

94
PÅ™Ã­klady generovÃ¡nÃ­ kÃ³du

94
PÅ™Ã­klady preprocesoru

94
M4:  pÅ™Ã­klady

94
ProÄ pouÅ¾Ã­vat M4 a proÄ ne?

94
http://github.com/jkubin/m4root (GenerovÃ¡nÃ­ kÃ³du v M4) â€“ sloÅ¾itÄ›jÅ¡Ã­ projekt generujÃ­cÃ­ HTML5 tohoto seriÃ¡lu

113
Historie makro jazykÅ¯

119
Makro jazyky byly vynalezeny v dobÄ›, kdy dominoval jazyk symbolickÃ½ch adres â€“ JSA (Jazyk SymbolickÃ½ch Adres â€“ assembler).
ZdrojovÃ½ kÃ³d JSA velmi Äasto obsahuje shodnÃ© sekvence instrukcÃ­ odliÅ¡ujÃ­cÃ­ se pouze hodnotami operandÅ¯.
ShodnÃ© sekvence instrukcÃ­ je moÅ¾nÃ© seskupit do jednoho slova, nebo-li makro instrukce.
JmÃ©no obvykle popisuje ÃºÄel skrytÃ© sekvence instrukcÃ­.
Makro instrukce se pÅ™eloÅ¾Ã­ makro procesorem na pÅ¯vodnÃ­ sekvenci instrukcÃ­, kterÃ¡ se poslÃ©ze pÅ™eloÅ¾Ã­ do spustitelnÃ©ho strojovÃ©ho kÃ³du.
ProgramovÃ¡nÃ­ v JSA pomocÃ­ makro instrukcÃ­ je jednoduÅ¡Å¡Ã­, rychlejÅ¡Ã­ a mÃ©nÄ› nÃ¡chylnÃ© k lidskÃ½m chybÃ¡m.

136
PozdÄ›ji byly makro jazyky pouÅ¾ity k rozÅ¡Ã­Å™enÃ­ kompilovanÃ½ch programovacÃ­ch jazykÅ¯, protoÅ¾e umoÅ¾nily psÃ¡t zdrojovÃ½ kÃ³d na vyÅ¡Å¡Ã­ Ãºrovni abstrakce neÅ¾ jakou poskytuje samotnÃ½ programovacÃ­ jazyk.
Rychlost, vÃ½konnost a efektivita sloÅ¾itÃ©ho programovacÃ­ho jazyka niÅ¾Å¡Ã­ ÃºrovnÄ› je zachovÃ¡na dÃ­ky makro jazykÅ¯m.
AvÅ¡ak je dÅ¯leÅ¾itÃ© dobÅ™e rozumÄ›t vÅ¡em vrstvÃ¡m kÃ³du.

147
GPM (General Purpose Macro-generator)

151
ZÃ¡kladnÃ­ myÅ¡lenku pÅ™episovÃ¡nÃ­ textovÃ½ch Å™etÄ›zcÅ¯ s argumenty, kterÃ© se pÅ™epÃ­Å¡Ã­ do dalÅ¡Ã­ch rekurzivnÄ› pÅ™episovatelnÃ½ch Å™etÄ›zcÅ¯, pÅ™edstavil
Christopher Strachey (Wikipedie) ve svÃ©m
GPM (General Purpose Macro-generator) v roce 1965.
DalÅ¡Ã­ generace makro procesorÅ¯ M3 a M4 pÅ¯vodnÃ­ GPM (General Purpose Macro-generator) v podstatÄ› uÅ¾ jen rozÅ¡iÅ™ovaly.
ZÃ¡kladnÃ­ myÅ¡lenka pÅ¯vodnÃ­ho nÃ¡vrhu ale zÅ¯stala stejnÃ¡.

165
M3

169
Dennis Ritchie (Wikipedie) pÅ™evzal zÃ¡kladnÃ­ myÅ¡lenku GPM (General Purpose Macro-generator) a napsal vylepÅ¡enÃ½ makro procesor pro generovÃ¡nÃ­ zdrojovÃ©ho kÃ³du programovacÃ­ho jazyka C (1972), kterÃ½ sÃ¡m navrhl.
NovÃ½ makro procesor napsal pro minipoÄÃ­taÄ AP-3, odtud jmÃ©no M3.
Tento pÅ™Ã­mÃ½ pÅ™edchÅ¯dce souÄasnÃ©ho M4 dokÃ¡zal vÃ½raznÄ› uÅ¡etÅ™it tÄ›Å¾kou a ÄasovÄ› nÃ¡roÄnou prÃ¡ci, ÄÃ­mÅ¾ zaujal vÃ½vojÃ¡Å™e programujÃ­cÃ­ v jinÃ½ch jazycÃ­ch (FORTRAN (FORmula TRANslation), COBOL (COmmon Business-Oriented Language), PL/I (Programming Language One), â€¦).
VÃ½vojÃ¡Å™i upravovali M3 pro tyto jazyky ÄÃ­mÅ¾ ho promÄ›nili na univerzÃ¡lnÄ› pouÅ¾itelnÃ½ makro procesor M4.

182
[m4 âˆˆ {mnoÅ¾ina nÃ¡strojÅ¯ UNIX-u}]

182
Dennis Ritchie byl takÃ© spolutvÅ¯rcem operaÄnÃ­ho systÃ©mu UNIX a proto:

182
M4 je minimalistickÃ½ a rychlÃ½, dÄ›lÃ¡ jednu vÄ›c a tu dÄ›lÃ¡ dobÅ™e (Filosofie UNIX-u)

182
vÃ½hradnÄ› spolÃ©hÃ¡ na neinteraktivnÃ­ rozhranÃ­ pÅ™Ã­kazovÃ© Å™Ã¡dky

182
parametry a zÃ¡vislosti M4 skriptÅ¯ popisuje 

182
znakem  zaÄÃ­nÃ¡ jednoÅ™Ã¡dkovÃ½ komentÃ¡Å™ jako v UNIX-ovÃ©m shell-u

182
promÄ›nnÃ© , , , , , , â€¦ majÃ­ podobnÃ½ vÃ½znam jako v shell-u

182
oddÄ›lovaÄ argumentÅ¯ je ÄÃ¡rka

239
Makro procesor M3 rozÅ¡Ã­Å™il takÃ© Jim E. Weythman, autor programovÃ© konstrukce, kterÃ¡ se pouÅ¾Ã­vÃ¡ tÃ©mÄ›Å™ v kaÅ¾dÃ©m M4 skriptu:

255
[poznÃ¡mka]

255
KlÃ­ÄovÃ© slovo (divert(-1), divert(0), divert(1), â€¦, divert(2147483647)) pÅ™epÃ­nÃ¡ vÃ½stupnÃ­ fronty.
Argument  zcela vypne jakÃ½koliv textovÃ½ vÃ½stup.
Argument  pÅ™epne vÃ½stup na  (standardnÃ­ vÃ½stup).

266
M4

270
Brian Kernighan (Wikipedie) makro procesor M3 rozÅ¡Ã­Å™il na preprocesor (Wikipedie) jazyka FORTRAN 66,
aby mohl vytvoÅ™it hybridnÃ­ jazykovou nadstavbu pojmenovanou RATFOR (RATional FORtran).
ZÃ¡kladnÃ­ programovÃ© konstrukce tÃ©to nadstavby (podmÃ­nky, cykly) jsou stejnÃ© jako v jazyce C.
ProgramovÃ¡nÃ­ v RATFOR-u se tak podobÃ¡ programovÃ¡nÃ­ v â€cÃ©Äkuâ€œ.
Makro procesor zdrojovÃ½ kÃ³d pÅ™eklÃ¡dÃ¡ zpÃ¡tky do FORTRAN-u, potÃ© kompilÃ¡tor provede pÅ™eklad do strojovÃ©ho kÃ³du.

285
[jazyk M4 doplÅˆuje jazyk C]

285
VÅ¡imnÄ›te si tÃ©mÄ›Å™ dokonalÃ© symbiÃ³zy s jazykem C

285
direktivy CPP (Preprocesor jazyka C) , , , â€¦ jsou pro M4 komentÃ¡Å™e

285
klÃ­ÄovÃ¡ slova oddÄ›lenÃ¡ od zÃ¡vorek mezerou, ztrÃ¡cÃ­ svÅ¯j pÅ¯vodnÃ­ vÃ½znam

M4 napÅ™Ã­klad ignoruje funkci 


285
argumenty maker oddÄ›lujÃ­ ÄÃ¡rky stejnÄ› jako argumenty funkcÃ­ jazyka C

je-li definovÃ¡no makro , jeho promÄ›nnÃ© jsou:

, , , 



285
levÃ½ Å™Ã­dÃ­cÃ­ znak  pro neterminÃ¡ly nenÃ­ souÄÃ¡stÃ­ syntaxe rodiny jazykÅ¯ C

285
pravÃ½ Å™Ã­dÃ­cÃ­ znak  nevadÃ­, nenÃ­-li souÄÃ¡stÃ­ makra
oba Å™Ã­dÃ­cÃ­ znaky lze skrÃ½t do uÅ¾ivatelsky definovanÃ½ch maker , 

285
makra se pÃ­Å¡Ã­ , stejnÄ› jako neterminÃ¡lnÃ­ symboly (Wikipedie)
tÃ­m je vymezen jejich jmennÃ½ prostor

364
UÅ¾ivatelskÃ½ manuÃ¡l zmiÅˆuje jeÅ¡tÄ› dalÅ¡Ã­, zde neuvedenÃ© spoluautory.
Bylo by tedy znaÄnÄ› nespravedlivÃ© napsat, Å¾e autory makro procesoru M4 (1977) jsou pouze dva lidÃ©.

373
[Christopher Strachey, Dennis Ritchie, Brian Kernighan]

373
Christopher Strachey,
Dennis Ritchie,
Brian Kernighan

390
GNU M4

394
Dnes existuje nÄ›kolik implementacÃ­ liÅ¡Ã­cÃ­ se od pÅ¯vodnÃ­ implementace spÃ­Å¡e drobnostmi.
NejrozÅ¡Ã­Å™enÄ›jÅ¡Ã­ implementace M4 je GNU M4 pouÅ¾Ã­vanÃ¡ pro Autotools (Wikipedie)
a pro pÅ™eklad jednoduchÃ©ho konfiguraÄnÃ­ho souboru  na sloÅ¾itÃ½ .
Autorem tÃ©to implementace z roku 1990 je RenÃ© Seindal.
NÃ¡sledujÃ­cÃ­ pÅ™Ã­kaz nainstaluje m4 (s malÃ½m â€mâ€œ):

409
[pÅ™Ã­kaz nainstaluje takÃ© dalÅ¡Ã­ dÅ¯leÅ¾itÃ© balÃ­Äky]

413
PodrobnÃ½ popis klÃ­ÄovÃ½ch slov se nachÃ¡zÃ­ v dokumentaci:

427
ZÃ¡klady jazyka M4

433
ZÃ¡kladem jazyka M4 je bezkontextovÃ¡ gramatika, automaty, zÃ¡sobnÃ­ky a vÃ½stupnÃ­ fronty.
Pro pochopenÃ­ jazyka M4 je proto velmi dÅ¯leÅ¾itÃ© rozumÄ›t zÃ¡kladnÃ­m pojmÅ¯m teorie formÃ¡lnÃ­ch jazykÅ¯ â€“
co jsou terminÃ¡lnÃ­ symboly (Wikipedie) (struÄnÄ› terminÃ¡ly) a neterminÃ¡lnÃ­ symboly (struÄnÄ› neterminÃ¡ly).
ZmÃ­nÄ›nÃ© pojmy si podrobnÄ›ji vysvÄ›tlÃ­me nÄ›kdy pozdÄ›ji.
CÃ­lem tohoto ÃºvodnÃ­ho dÃ­lu je hlavnÄ› ukÃ¡zat praktickÃ© pouÅ¾itÃ­ M4 na pÅ™Ã­kladech.

448
BezkontextovÃ¡ gramatika

454
BezkontextovÃ¡ gramatika (krÃ¡tce CFG (Context-Free Grammar â€“ bezkontextovÃ¡ gramatika)) je formÃ¡lnÃ­ gramatika, ve kterÃ© majÃ­ vÅ¡echna pÅ™episovacÃ­ pravidla tvar .
NeterminÃ¡l  se pÅ™epÃ­Å¡e na libovolnÄ› dlouhÃ½ Å™etÄ›zec  (pravÃ¡ strana pÅ™episovacÃ­ho pravidla) sloÅ¾enÃ½ z terminÃ¡lÅ¯  nebo neterminÃ¡lÅ¯ .
Kleeneho hvÄ›zda (Wikipedie) znamenÃ¡, Å¾e se neterminÃ¡l  mÅ¯Å¾e pÅ™epsat na  (epsilon â€“ prÃ¡zdnÃ½ symbol) (pÅ™episovacÃ­ pravidlo ).

465
[pÅ™episovacÃ­ pravidla bezkontextovÃ© gramatiky]

471
PÅ™episovacÃ­ pravidla M4

477
PÅ™episovacÃ­ pravidla M4 jsou stejnÃ¡ jako pÅ™episovacÃ­ pravidla bezkontextovÃ© gramatiky.

484
[pÅ™episovacÃ­ pravidla M4]

493
VÅ¡echna klÃ­ÄovÃ¡ slova M4 jsou neterminÃ¡ly (makra), provedou nÄ›jakou akci a pÅ™epÃ­Å¡Ã­ se na  (epsilon â€“ prÃ¡zdnÃ½ symbol) nebo jinÃ½ symbol.
VÅ¡echna klÃ­ÄovÃ¡ slova lze pÅ™ejmenovat nebo ÃºplnÄ› vypnout.
Tato vlastnost je velmi dÅ¯leÅ¾itÃ¡ pro reÅ¾im preprocesoru.

504
[klÃ­ÄovÃ¡ slova M4 jsou neterminÃ¡ly]

512
Å˜Ã­zenÃ­ expanze neterminÃ¡lÅ¯

518
VÃ½chozÃ­ dvojice znakÅ¯  v M4 Å™Ã­dÃ­ expanzi neterminÃ¡lÅ¯.
KlÃ­ÄovÃ© slovo  je mÅ¯Å¾e zmÄ›nit na jinÃ© znaky, napÅ™Ã­klad {(hranatÃ© zÃ¡vorky), (netisknutelnÃ© znaky), (UTF-8 znaky)}.
NeterminÃ¡ly, kterÃ© nechceme (ihned) expandovat, jsou obklopeny touto dvojicÃ­ znakÅ¯.
PÅ™i prÅ¯chodu makro procesorem jsou vÅ¡echny symboly mezi touto dvojicÃ­ znakÅ¯ terminÃ¡lnÃ­mi symboly a vnÄ›jÅ¡Ã­ dvojice znakÅ¯ je odstranÄ›na.
DalÅ¡Ã­ prÅ¯chod jiÅ¾ zpÅ¯sobÃ­ expanzi pÅ¯vodnÄ› chrÃ¡nÄ›nÃ½ch neterminÃ¡lÅ¯.
Dvojice Å™Ã­dÃ­cÃ­ch znakÅ¯ se nastavuje na zaÄÃ¡tku koÅ™enovÃ©ho souboru.

536
Automaty

542
Automaty slouÅ¾Ã­ jako â€pÅ™epÃ­naÄeâ€œ pravidel gramatiky.
PouÅ¾Ã­vajÃ­ pÅ™episovacÃ­ pravidla gramatiky jako uzly a mÄ›nÃ­ svÃ© stavy podle vstupnÃ­ch symbolÅ¯.
AktuÃ¡lnÄ› pouÅ¾Ã­vanÃ© pÅ™episovacÃ­ pravidlo produkuje do vÃ½stupnÃ­ fronty (nebo do nÄ›kolika vÃ½stupnÃ­ch front)
specifickÃ½ kÃ³d, dokud automat nepÅ™ejde do jinÃ©ho uzlu s jinÃ½m pÅ™episovacÃ­m pravidlem.
PÅ™Ã­klady generujÃ­cÃ­ch automatÅ¯ jsou ukÃ¡zÃ¡ny v pÅ™Ã­loze.

557
VÃ½stupnÃ­ fronty

563
VÃ½stupnÃ­ fronty jsou doÄasnÃ© ÃºloÅ¾iÅ¡tÄ› pro ÄÃ¡sti vÃ½slednÃ©ho kÃ³du.
Tyto ÄÃ¡sti vÃ½slednÃ©ho kÃ³du jsou produkovÃ¡ny pÅ™episovacÃ­mi pravidly gramatiky, kterÃ© pÅ™episujÃ­ vstupnÃ­ symboly.
KlÃ­ÄovÃ© slovo  nastavuje aktuÃ¡lnÃ­ vÃ½stupnÃ­ frontu.
Na zÃ¡vÄ›r jsou vÅ¡echny neprÃ¡zdnÃ© fronty vypsÃ¡ny ve vzestupnÃ©m poÅ™adÃ­ na standardnÃ­ vÃ½stup a sloÅ¾Ã­ vÃ½slednÃ½ kÃ³d z ÄÃ¡stÃ­ kÃ³du.
VÃ½stupnÃ­ fronty jsou ukÃ¡zÃ¡ny v pÅ™Ã­loze.

579
[pro informaci]

579
ZÃ¡sobnÃ­ky si ukÃ¡Å¾eme pozdÄ›ji.

587
HlavnÃ­ pouÅ¾itÃ­ M4

593
M4 se pouÅ¾Ã­vÃ¡ ke generovÃ¡nÃ­ zdrojovÃ©ho kÃ³du libovolnÃ©ho programovacÃ­ho jazyka nebo jako preprocesor jakÃ©hokoliv zdrojovÃ©ho kÃ³du.

601
GenerovÃ¡nÃ­ kÃ³du

607
M4 transformuje vstupnÃ­ data ze souborÅ¯  (Macro Configuration) na vÃ½slednÃ¡ data nÃ¡sledujÃ­cÃ­m pÅ™Ã­kazem:

614
[â† nejobecnÄ›jÅ¡Ã­.m4 â€¦ nejspeciÃ¡lnÄ›jÅ¡Ã­.m4 â†’]

618
BÄ›hem naÄÃ­tÃ¡nÃ­ souborÅ¯ jsou provÃ¡dÄ›ny dvÄ› zÃ¡kladnÃ­ operace:

625
ÄtenÃ­ transformaÄnÃ­ch pravidel ze souborÅ¯ s pÅ™Ã­ponou 

625
expanze maker uvnitÅ™ souborÅ¯ s pÅ™Ã­ponou 

643
Soubory  a  obsahujÃ­ vstupnÃ­ data ve specifickÃ©m formÃ¡tu, kterÃ½ umoÅ¾Åˆuje jejich transformaci na vÃ½stupnÃ­ data podle pravidel v pÅ™edchozÃ­ch  souborech.
DatovÃ© soubory  obvykle neobsahujÃ­ Å¾Ã¡dnÃ¡ transformaÄnÃ­ pravidla.

652
VstupnÃ­ data mohou takÃ© pÅ™ichÃ¡zet z kolony:

659
[vstupnÃ­ kÃ³d â†’ generovÃ¡nÃ­ zdrojovÃ©ho kÃ³du â†’ soubor]

663
[vstupnÃ­ kÃ³d â†’ generovÃ¡nÃ­ zdrojovÃ©ho kÃ³du â†’ program]

667
VyzkouÅ¡ejte: PÅ™Ã­klady generovÃ¡nÃ­ kÃ³du

675
Preprocesor

681
M4 mÅ¯Å¾e pracovat v reÅ¾imu preprocesoru a mÅ¯Å¾e bÃ½t takÃ© souÄÃ¡stÃ­ kolony.
VstupnÃ­ zdrojovÃ½ kÃ³d jÃ­m prochÃ¡zÃ­ beze zmÄ›ny s vÃ½jimkou neterminÃ¡lnÃ­ch symbolÅ¯.
NalezenÃ© neterminÃ¡ly jsou expandovÃ¡ny na terminÃ¡ly a odchÃ¡zÃ­ spolu se zdrojovÃ½m kÃ³dem na vÃ½stup.
M4 mÅ¯Å¾e rozÅ¡Ã­Å™it jakÃ½koliv jinÃ½ jazyk, kde je preprocesor nedostateÄnÃ½ (bez rekurze) nebo Å¾Ã¡dnÃ½.
DÅ¯leÅ¾itÃ© je zvolit vhodnÃ½ levÃ½ znak pro Å™Ã­zenÃ­ expanze neterminÃ¡lÅ¯, kterÃ½ nesmÃ­ kolidovat se znakem vstupnÃ­ho zdrojovÃ©ho kÃ³du.
Kolize znaku je ale snadno Å™eÅ¡itelnÃ¡ regulÃ¡rnÃ­m vÃ½razem.

698
[M4 jako preprocesor â€“ obecnÄ›]

702
[M4 jako preprocesor â€“ bez doÄasnÃ©ho souboru]

707
 VÃ½chozÃ­ znaky

713
KonfliktnÃ­ znak  ze vstupnÃ­ho zdrojovÃ©ho kÃ³du je skryt do makra .
PrÃ¡zdnÃ½ pÃ¡r Å™Ã­dÃ­cÃ­ch znakÅ¯  pÅ™ed makrem  slouÅ¾Ã­ jako oddÄ›lovaÄ symbolÅ¯.
PÅ™i prÅ¯chodu zdrojovÃ©ho kÃ³du makro procesorem se makro  pÅ™epÃ­Å¡e zpÃ¡tky na pÅ¯vodnÃ­ znak  a prÃ¡zdnÃ½ pÃ¡r  je odstranÄ›n.

727
[M4 jako preprocesor s Å™Ã­dÃ­cÃ­mi znaky: `']

731
VyskytujÃ­-li se ve vstupnÃ­m kÃ³du komentÃ¡Å™e  nebo , je nutnÃ© je skrÃ½t.
Znaky  vypnou pÅ¯vodnÃ­ vÃ½znam komentÃ¡Å™Å¯ a budou odebrÃ¡ny pÅ™i prÅ¯chodu makro procesorem.

KomentÃ¡Å™e M4  a  jsou skryty mezi vÃ½chozÃ­ znaky:  

742
[M4 jako preprocesor s Å™Ã­dÃ­cÃ­mi znaky: `']

746
[M4 jako preprocesor s Å™Ã­dÃ­cÃ­mi znaky jinak: `']

751
 HranatÃ© zÃ¡vorky

757
PouÅ¾ijeme-li pro Å™Ã­zenÃ­ expanze neterminÃ¡lÅ¯ hranatÃ© zÃ¡vorky, stejnÃ½m zpÅ¯sobem je skryta levÃ¡  hranatÃ¡ zÃ¡vorka.
VÅ¡e ostatnÃ­ platÃ­ jako pro vÃ½chozÃ­ znaky .

766
[M4 jako preprocesor s Å™Ã­dÃ­cÃ­mi znaky: []]

770
KomentÃ¡Å™e M4  a  jsou skryty mezi zÃ¡vorkami:  

777
[M4 jako preprocesor s Å™Ã­dÃ­cÃ­mi znaky: []]

781
[M4 jako preprocesor s Å™Ã­dÃ­cÃ­mi znaky jinak: []]

786
 NetisknutelnÃ© znaky

792
Pro Å™Ã­zenÃ­ expanze neterminÃ¡lÅ¯ lze pouÅ¾Ã­t netisknutelnÃ© znaky  () a  ().
Tyto znaky nemohou kolidovat s tisknutelnÃ½mi znaky zdrojovÃ©ho kÃ³du.

801
[M4 jako preprocesor s Å™Ã­dÃ­cÃ­mi znaky: â‚â†]

805
KomentÃ¡Å™e M4  a  jsou skryty mezi netisknutelnÃ© znaky:  

812
[M4 jako preprocesor s Å™Ã­dÃ­cÃ­mi znaky: â‚â†]

816
[M4 jako preprocesor s Å™Ã­dÃ­cÃ­mi znaky jinak: â‚â†]

821
 UTF-8 znaky

827
Expanzi neterminÃ¡lÅ¯ mÅ¯Å¾e takÃ© Å™Ã­dit vhodnÄ› zvolenÃ½ pÃ¡r UTF-8 znakÅ¯.
BÄ›Å¾nÃ½ zdrojovÃ½ kÃ³d takovÃ© znaky neobsahuje, proto nemusÃ­me Å™eÅ¡it kolizi levÃ©ho  znaku.
UTF-8 znaky nabÃ­zÃ­ podobnÃ© vÃ½hody jako netisknutelnÃ© znaky.

838
[M4 jako preprocesor s Å™Ã­dÃ­cÃ­mi znaky: âŸ¦âŸ§]

842
KomentÃ¡Å™e M4  a  jsou skryty mezi UTF-8 znaky:  

849
[M4 jako preprocesor s Å™Ã­dÃ­cÃ­mi znaky: âŸ¦âŸ§]

853
[M4 jako preprocesor s Å™Ã­dÃ­cÃ­mi znaky jinak: âŸ¦âŸ§]

859
VyzkouÅ¡ejte: PÅ™Ã­klady preprocesoru

863
SmÃ­Å¡enÃ½ reÅ¾im

869
SmÃ­Å¡enÃ½ reÅ¾im je kombinacÃ­ pÅ™edchozÃ­ch reÅ¾imÅ¯ a je pouÅ¾Ã­vÃ¡n hlavnÄ› na pokusy.
Data nejsou oddÄ›lena od transformaÄnÃ­ch pravidel.
ListovÃ½ soubor  obsahuje definice tÄ›chto pravidel spolu se vstupnÃ­mi daty.

880
[jak se nauÄit M4]

884
VyzkouÅ¡ejte: M4:  pÅ™Ã­klady

889
PÅ™edpoklady pro zvlÃ¡dnutÃ­ M4

895
Pro ÃºspÄ›Å¡nÃ© zvlÃ¡dnutÃ­ tohoto makro jazyka je dÅ¯leÅ¾itÃ© splnit nÄ›kolik pÅ™edpokladÅ¯.
M4 nenÃ­ jednoduchÃ½ jazyk, protoÅ¾e nenÃ­ moÅ¾nÃ© v nÄ›m myslet a programovat jako v bÄ›Å¾nÃ©m programovacÃ­m jazyce.
NejdÅ¯leÅ¾itÄ›jÅ¡Ã­ je uvÄ›domit si, Å¾e se v nÄ›m programujÃ­ pÅ™episovacÃ­ pravidla gramatiky.
KaÅ¾dÃ½ Å™etÄ›zec je buÄ terminÃ¡lnÃ­ nebo neterminÃ¡lnÃ­ symbol vÄetnÄ› vÅ¡ech klÃ­ÄovÃ½ch slov jazyka (symboly  a  jsou speciÃ¡lnÃ­ pÅ™Ã­pady neterminÃ¡lÅ¯).

908
[poznÃ¡mka]

908
M4 zÃ¡mÄ›rnÄ› nemÃ¡ klÃ­ÄovÃ¡ slova pro cykly (/), protoÅ¾e jeho zÃ¡klad je zcela jinÃ½, neÅ¾ jakÃ½ majÃ­ procedurÃ¡lnÃ­ nebo funkcionÃ¡lnÃ­ jazyky.

908
cykly jsou pouze levorekurzivnÃ­ nebo pravorekurzivnÃ­

908
vÄ›tvÃ­ se Å™etÄ›zenÃ­m symbolÅ¯ nebo klÃ­ÄovÃ½mi slovy , 

940
ZÃ¡klady gramatik

946
ZÃ¡kladem vÅ¡ech gramatik jsou pÅ™episovacÃ­ pravidla, jejichÅ¾ podobu obecnÄ› popisuje:

953
FormÃ¡lnÃ­ gramatika (ChomskÃ©ho typu)

970
FormÃ¡lnÃ­ gramatika (Wikipedie) popisuje podmnoÅ¾iny (ChomskÃ©ho hierarchie
(Wikipedie))
pÅ™episovacÃ­ch pravidel formÃ¡lnÃ­ho jazyka (Wikipedie).
Jedna z podmnoÅ¾in se jmenuje bezkontextovÃ¡ gramatika (Wikipedie),
krÃ¡tce CFG (Context-Free Grammar â€“ bezkontextovÃ¡ gramatika).
Jak jiÅ¾ bylo dÅ™Ã­ve zmÃ­nÄ›no, pÅ™episovacÃ­ pravidla CFG pracujÃ­ stejnÄ› jako pÅ™episovacÃ­ pravidla jazyka M4.
NÄ›kterÃ½ z nÃ¡sledujÃ­cÃ­ch dÃ­lÅ¯ seriÃ¡lu se podrobnÄ›ji zamÄ›Å™Ã­ na formÃ¡lnÃ­ gramatiky.

990
ZÃ¡klady automatÅ¯

996
Schopnost pouÅ¾Ã­vat pÅ™evÃ¡Å¾nÄ› dvoustavovÃ© automaty je zÃ¡sadnÃ­ vÄ›c pro psanÃ­ jednoduchÃ½ch M4 skriptÅ¯, protoÅ¾e pÅ™evÃ¡Å¾nÃ¡ vÄ›tÅ¡ina skriptÅ¯ pouÅ¾Ã­vÃ¡ malÃ© automaty.

1003
TestovacÃ­ automat

1009
PoÅ™adÃ­ vstupnÃ­ch symbolÅ¯ nebo jejich kontext lze otestovat automatem.
SplÅˆujÃ­-li vstupnÃ­ symboly poÅ¾adovanÃ© vlastnosti, automat skonÄÃ­ v uzlu s dvojitÃ½m krouÅ¾kem, kterÃ½m se oznaÄuje akceptujÃ­cÃ­ stav.

1018
[deterministickÃ½ koneÄnÃ½ automat (DFA)]

1018
PÅ™Ã­klad automatu akceptujÃ­cÃ­ sudÃ½ poÄet (Å¾Ã¡dnÃ½ je takÃ© sudÃ½) symbolÅ¯ , ignorujÃ­cÃ­ symboly .
Automat je shodnÃ½ s regulÃ¡rnÃ­m vÃ½razem .

1033
PÅ™edchozÃ­ automat lze zapsat jako ASCII art doprovÃ¡zejÃ­cÃ­ M4 skript:

1040
[ASCII art jako dokumentace M4 kÃ³du]

1049
GenerujÃ­cÃ­ automat

1055
VstupnÃ­ symboly mÄ›nÃ­ uzly automatu, ÄÃ­mÅ¾ zÃ¡roveÅˆ mÄ›nÃ­ pÅ™episovacÃ­ pravidla pro generovÃ¡nÃ­ kÃ³du.
PÅ™Ã­klad generujÃ­cÃ­ho automatu naleznete v pÅ™Ã­loze:

1064
[ASCII art generujÃ­cÃ­ho automatu]

1082
(GNU) make

1088
DobÅ™e navrÅ¾enÃ½ generÃ¡tor kÃ³du se obvykle sklÃ¡dÃ¡ z nÄ›kolika menÅ¡Ã­ch souborÅ¯, jejichÅ¾ poÅ™adÃ­, zÃ¡vislosti a parametry se zapisujÃ­ do souboru .
DobrÃ¡ znalost tvorby  je proto zÃ¡kladnÃ­m pÅ™edpokladem pro zvlÃ¡dnutÃ­ M4.
ÄŒtenÃ­ a ÃºdrÅ¾ba zdrojovÃ©ho kÃ³du celkovÄ› zabere vÅ¾dy vÃ­ce Äasu neÅ¾ jeho tvorba.
DobÅ™e strukturovanÃ½  proto zÃ¡sadnÃ­m zpÅ¯sobem pÅ™ispÃ­vÃ¡ k celkovÃ© pÅ™ehlednosti vÃ½slednÃ©ho generÃ¡toru kÃ³du.

1101
[tÃ­mto tÃ©matem se budeme zabÃ½vat jindy]

1101
SpouÅ¡tÄ›nÃ­  z editoru kÃ³du pomocÃ­ vhodnÃ© klÃ¡vesovÃ© zkratky zÃ¡sadnÄ› urychluje vÃ½voj M4 kÃ³du.
Soubor  obsahuje .

1111
Vim

1117
ZvlÃ¡dnutÃ­ editoru Vim je dÅ¯leÅ¾itÃ½m pÅ™edpokladem pro pohodlÃ­ a rychlost psanÃ­ kÃ³du M4.
Vim zkratky, definovanÃ© klÃ­ÄovÃ½m slovem , uÅ¡etÅ™Ã­ velkÃ© mnoÅ¾stvÃ­ zbyteÄnÄ› napsanÃ©ho textu.
Tyto zkratky takÃ© vÃ½znamnÄ› sniÅ¾ujÃ­ vÃ½skyt tÃ©mÄ›Å™ neviditelnÃ½ch chyb zpÅ¯sobenÃ½ch nepÃ¡rovou zÃ¡vorkou, ÄÃ­mÅ¾ Å¡etÅ™Ã­ ztracenÃ½ Äas vynaloÅ¾enÃ½ na ladÄ›nÃ­ kÃ³du.

1129
Talent a Äas

1135
M4 obvykle nejde zcela zvlÃ¡dnout pÅ™es vÃ­kend, zvlÃ¡Å¡tÄ› chybÃ­-li zÃ¡klady
teorie automatÅ¯ (Wikipedie) a formÃ¡lnÃ­ch gramatik (Wikipedie).
Ke zvlÃ¡dnutÃ­ jazyka M4 je nutnÃ© v nÄ›m programovat delÅ¡Ã­ obdobÃ­ a napsat mnoÅ¾stvÃ­ Å¡patnÃ©ho (sloÅ¾itÃ©ho) M4 kÃ³du, kterÃ½ z vlastnÃ­ vÅ¯le pÅ™epÃ­Å¡ete kvÅ¯li lepÅ¡Ã­mu nÃ¡padu.
TÃ­mto zpÅ¯sobem je moÅ¾nÃ© postupnÄ› zÃ­skat praxi.

1152
PÅ™Ã­klady generovÃ¡nÃ­ kÃ³du

1152
[pro informaci]

1152
Znaky {, , , } v nÃ¡zvu pÅ™Ã­kladu Å™Ã­dÃ­ expanzi neterminÃ¡lÅ¯.

1158
[poznÃ¡mka]

1158
PÅ™Ã­klady v tÃ©to pÅ™Ã­loze jsou sloÅ¾itÄ›jÅ¡Ã­ a jejich cÃ­lem je ukÃ¡zat praktickÃ© pouÅ¾itÃ­ jazyka M4.
PodrobnÄ›ji budou vysvÄ›tleny pozdÄ›ji.

1168
 VstupnÃ­ zdrojovÃ½ kÃ³d

1174
VstupnÃ­ zdrojovÃ½ kÃ³d je podobnÃ½ CSV (Comma Separated Values), kterÃ½ se pÅ™evede na libovolnÄ› sloÅ¾itÃ½ cÃ­lovÃ½ kÃ³d jinÃ©ho jazyka pomocÃ­ CFG (Context-Free Grammar â€“ bezkontextovÃ¡ gramatika), automatÅ¯ a vÃ½stupnÃ­ch front.
ZÃ¡sobnÃ­ky v pÅ™Ã­kladech nejsou pouÅ¾ity.
VstupnÃ­ zdrojovÃ½ kÃ³d obsahuje speciÃ¡lnÃ­ znaky, kterÃ© je nutnÃ© skrÃ½t:

1185
[]

1187
[poznÃ¡mka]

1187
VstupnÃ­ soubor mÅ¯Å¾e takÃ© obsahovat poznÃ¡mky, kterÃ© nemusÃ­ bÃ½t skrytÃ© v komentÃ¡Å™Ã­ch , ,  nebo .

1195
 CSV:  nejjednoduÅ¡Å¡Ã­ pÅ™Ã­klad

1201
Tento pÅ™Ã­klad nepouÅ¾Ã­vÃ¡ vÃ½stupnÃ­ fronty, pouze vypisuje CSV (Comma Separated Values) oddÄ›lenÃ© znakem .

1208
[]

1213
 CSV:  poÄÃ­tadlo

1219
PÅ™Ã­klad pouÅ¾Ã­vÃ¡ makro  z koÅ™enovÃ©ho souboru, jehoÅ¾  (pravÃ¡ strana pÅ™episovacÃ­ho pravidla) se zkopÃ­ruje do pravÃ© strany makra .
BÄ›hem prvnÃ­ expanze  probÄ›hne inicializace jeho startovacÃ­ hodnoty.
DalÅ¡Ã­ expanze vrÃ¡tÃ­ ÄÃ­selnÃ½ terminÃ¡lnÃ­ symbol a probÄ›hne zvÃ½Å¡enÃ­ vnitÅ™nÃ­ho pomocnÃ©ho (globÃ¡lnÃ­ho) symbolu o jedniÄku.
 je malÃ½ automat.

1232
[]

1237
(jak se to dÄ›lÃ¡) Ãšpravy speciÃ¡lnÃ­ch znakÅ¯

1243
KaÅ¾dÃ½ typ vÃ½stupnÃ­ho kÃ³du vyÅ¾aduje Ãºpravu speciÃ¡lnÃ­ch znakÅ¯.
KlÃ­ÄovÃ© slovo jazyka M4  je nevhodnÃ© pro tento Ãºkol.
VÅ¡echny speciÃ¡lnÃ­ znaky vstupnÃ­ho souboru proto napÅ™ed skryjeme do vhodnÄ› pojmenovanÃ½ch maker pomocÃ­ regulÃ¡rnÃ­ch vÃ½razÅ¯.

1254
UpravenÃ½ vstupnÃ­ kÃ³d

1260
[vÅ¡echny speciÃ¡lnÃ­ znaky jsou skryty do maker]

1264
VytvoÅ™Ã­me nÄ›kolik pÅ™evodnÃ­ch souborÅ¯ podle typu cÃ­lovÃ©ho kÃ³du, makra pro hranatÃ© zÃ¡vorky  a  jsou uÅ¾ definovÃ¡na v koÅ™enovÃ©m souboru.

1273
 PÅ™evodnÃ­ soubor pro XML, XSLT, HTML

1277
[pÅ™evodnÃ­ soubor pro znaÄkovacÃ­ jazyky]

1280
 PÅ™evodnÃ­ soubor pro C, JSON, INI: 

1285
[pÅ™evodnÃ­ soubor pro zdrojovÃ½ kÃ³d]

1288
 PÅ™evodnÃ­ soubor pro Bash: 

1294
[pÅ™evodnÃ­ soubor pro Bash "Å™etÄ›zce v uvozovkÃ¡ch"]

1296
 PÅ™evodnÃ­ soubor pro Bash: 

1302
[pÅ™evodnÃ­ soubor pro Bash 'Å™etÄ›zce v apostrofech']

1304
 PÅ™evodnÃ­ soubor pro CSV, M4 (vrÃ¡tÃ­ vÅ¡echny znaky zpÃ¡tky)

1310
[pÅ™evodnÃ­ soubor vrÃ¡tÃ­ vÅ¡echny speciÃ¡lnÃ­ znaky zpÃ¡tky]

1313
 C:  vÃ½stupnÃ­ fronta

1319
PÅ™Ã­klad pouÅ¾Ã­vÃ¡ jednu vÃ½stupnÃ­ frontu na znaky  pro uzavÅ™enÃ­ pole na konci skriptu.

1331
 INI:  externÃ­ pÅ™Ã­kaz

1337
PÅ™Ã­klad spustÃ­ externÃ­ pÅ™Ã­kaz  a jeho vÃ½stup umÃ­stÃ­ do hranatÃ½ch zÃ¡vorek.
VÃ½stupem externÃ­ho pÅ™Ã­kazu jsou dvÄ› poloÅ¾ky oddÄ›lenÃ© ÄÃ¡rkou.
Makro  vybere prvnÃ­ poloÅ¾ku, protoÅ¾e druhÃ¡ poloÅ¾ka obsahuje neÅ¾Ã¡doucÃ­ znak novÃ©ho Å™Ã¡dku  ().

1353
 .h:  hex poÄÃ­tadlo

1359
PÅ™Ã­klad pouÅ¾Ã­vÃ¡ makro  pro ÄÃ­slovÃ¡nÃ­ vÃ½slednÃ½ch CPP (Preprocesor jazyka C) maker a jednu vÃ½stupnÃ­ frontu.
Fronta ÄÃ­slo  obsahuje direktivu preprocesoru  pro zakonÄenÃ­ hlaviÄkovÃ©ho souboru.
PÅ™evod dekadickÃ© hodnoty poÄÃ­tadla na dvoumÃ­stnÃ© hex-a ÄÃ­slo provÃ¡dÃ­ klÃ­ÄovÃ© slovo .

1370
[]

1375
 C:  malÃ½ automat

1381
PÅ™Ã­klad pouÅ¾Ã­vÃ¡ malÃ½ automat  pro generovÃ¡nÃ­ znaku novÃ©ho Å™Ã¡dku  a jednu vÃ½stupnÃ­ frontu ÄÃ­slo  do kterÃ© se vloÅ¾Ã­ znaky  pro uzavÅ™enÃ­ vÃ½slednÃ©ho Å™etÄ›zce.
PoprvÃ© se  pÅ™epÃ­Å¡e na  (epsilon â€“ prÃ¡zdnÃ½ symbol), podruhÃ© a dÃ¡le se pÅ™epÃ­Å¡e na .

1390
[]

1397
[]

1402
 C:  malÃ½ automat 2

1408
Tento pÅ™Ã­klad je podobnÃ½ pÅ™edchozÃ­mu, avÅ¡ak kaÅ¾dÃ½ Å™etÄ›zec je na novÃ©m Å™Ã¡dku.

1420
 HTML:  vÃ½stupnÃ­ fronty

1426
PÅ™Ã­klad pouÅ¾Ã­vÃ¡ dvÄ› vÃ½stupnÃ­ fronty.
Fronta ÄÃ­slo  obsahuje odstavce,
fronta ÄÃ­slo  uzavÃ­racÃ­ znaÄky HTML strÃ¡nky.
NavigaÄnÃ­ odkazy nemusÃ­ bÃ½t nikde uloÅ¾eny, jdou pÅ™Ã­mo na vÃ½stup.
ZprÃ¡vy typu  a  jsou zpracovÃ¡ny stejnÄ› jako zprÃ¡vy typu .

1446
 VÄ›tvenÃ­ gramatikou

1452
PÅ™Ã­klad ukazuje vÄ›tvenÃ­ gramatikou, argumenty maker se ignorujÃ­.
VstupnÃ­ neterminÃ¡ly se pÅ™episujÃ­ na terminÃ¡ly (ğŸ›),
(ğŸœ),
(ğŸ).

1467
[]

1474
 JSON:  generujÃ­cÃ­ automat

1480
PÅ™Ã­klad pouÅ¾Ã­vÃ¡ dvÄ› vÃ½stupnÃ­ fronty a jeden generujÃ­cÃ­ automat.
PrvnÃ­ chybovÃ¡ zprÃ¡va  ve stavu  vygeneruje zÃ¡hlavÃ­ se zÃ¡vorkami a vypÃ­Å¡e na vÃ½stup prvnÃ­ zÃ¡znam.
Automat pÅ™ejde do stavu  coÅ¾ je  pravidlo (takovÃ© pravidlo se pouÅ¾Ã­vÃ¡ jako pravÃ¡ strana jinÃ©ho pÅ™episovacÃ­ho pravidla).
NÃ¡sledujÃ­cÃ­ chybovÃ© zprÃ¡vy ve stavu  pouze vypisujÃ­ na vÃ½stup jednotlivÃ© zÃ¡znamy.
Na zÃ¡vÄ›r vÃ½stupnÃ­ fronty ÄÃ­slo  a  vypÃ­Å¡ou znaky  a  ÄÃ­mÅ¾ zakonÄÃ­ vÃ½slednÃ½ JSON.

1500
 JSON:  pojmenovanÃ© fronty

1506
PÅ™Ã­klad zpracovÃ¡vÃ¡ dalÅ¡Ã­ zprÃ¡vy typu  a .
PouÅ¾Ã­vÃ¡ tÅ™i automaty a Å¡est vÃ½stupnÃ­ch front.
Generujeme-li sloÅ¾itÄ›jÅ¡Ã­ zdrojovÃ½ kÃ³d, brzy narazÃ­me na problÃ©m udrÅ¾enÃ­ konzistence indexÅ¯ pro vÃ½stupnÃ­ fronty.
Abychom se vyhnuli zmatku, pojmenujeme si fronty a mÃ­sto ÄÃ­sel pouÅ¾Ã­vÃ¡me jmÃ©na.

1519
Abychom nemuseli definovat podobnÃ¡ pravidla, zkopÃ­rujeme si pravou stranu 
(je to takÃ©  pravidlo (takovÃ© pravidlo se pouÅ¾Ã­vÃ¡ jako pravÃ¡ strana jinÃ©ho pÅ™episovacÃ­ho pravidla)) do pravÃ© strany pravidel  a .
PromÄ›nnÃ¡  se pÅ™epÃ­Å¡e na jmÃ©no makra a zÅ™etÄ›zÃ­ se s dalÅ¡Ã­m symbolem.
NovÄ› vzniklÃ½ neterminÃ¡l se pÅ™epÃ­Å¡e na odpovÃ­dajÃ­cÃ­ terminÃ¡lnÃ­ symbol (ÄÃ­slo fronty nebo jmÃ©no).

1530
[vÄ›tvenÃ­ gramatikou v M4]

1545
 JSON:  generovanÃ© indexy front

1551
BÄ›hem vÃ½voje se Äasto mÄ›nÃ­ poÅ™adÃ­ a poÄet vÃ½stupnÃ­ch front, coÅ¾ takÃ© vyÅ¾aduje Äastou zmÄ›nu jejich indexÅ¯.
Indexy je proto vhodnÃ© generovat.
MÅ¯Å¾eme pak pouÅ¾Ã­vat prakticky neomezenÃ½ poÄet front.
NÃ¡sledujÃ­cÃ­ pÅ™Ã­klad ukazuje, jak se tyto indexy generujÃ­.

1570
 INI:  nespojitÃ½ index front

1576
PÅ™Ã­klad pouÅ¾Ã­vÃ¡ tÅ™i automaty a dvÄ› vÃ½stupnÃ­ fronty ÄÃ­slo  a  definovanÃ© v oddÄ›lenÃ©m souboru.
NÃ¡zvy INI sekcÃ­ jsou generovÃ¡ny Å™etÄ›zenÃ­m symbolÅ¯.
PÅ™Ã­klad pouÅ¾Ã­vÃ¡ stejnÃ½ soubor pro vÃ½stupnÃ­ fronty jako pÅ™Ã­klad pro generovÃ¡nÃ­ JSON.

1592
 XML:  smÃ­Å¡enÃ© zprÃ¡vy

1598
PÅ™Ã­klad pouÅ¾Ã­vÃ¡ jednu vÃ½stupnÃ­ frontu ÄÃ­slo  pro uzavÃ­racÃ­ znaÄku .

1610
 XML:  oddÄ›lenÃ© zprÃ¡vy

1616
PÅ™Ã­klad seskupuje zprÃ¡vy podle jejich typu pomocÃ­ vÃ½stupnÃ­ch front.

1628
 Bash 

1639
 Bash 

1650
PÅ™Ã­klady preprocesoru

1650
[pro informaci]

1650
Znaky {, , , } v nÃ¡zvu pÅ™Ã­kladu Å™Ã­dÃ­ expanzi neterminÃ¡lÅ¯.

1656
 Preprocesor jazyka C a M4

1662
Direktivy CPP (Preprocesor jazyka C) jsou pro M4 jednoÅ™Ã¡dkovÃ½ komentÃ¡Å™, coÅ¾ brÃ¡nÃ­ neÅ¾Ã¡doucÃ­ expanzi stejnÄ› pojmenovanÃ½ch maker.
Definujeme-li bezpeÄnÄ›jÅ¡Ã­ makro , stejnÄ› pojmenovanÃ© makro  nebude pÅ™epsÃ¡no.
JmennÃ½ prostor CPP (Preprocesor jazyka C) tak mÅ¯Å¾e bÃ½t zcela oddÄ›len od jmennÃ©ho prostoru M4.
ProblematickÃ½ znak  je skryt do makra .
Apostrof  ve zdrojovÃ©m kÃ³du niÄemu nevadÃ­.
Apostrof uvnitÅ™ makra  je skryt do makra .
VÅ¡imnÄ›te si jmen funkcÃ­  nebo  a kde je expandovÃ¡n .

1681
[]

1684
[]

1690
[]

1696
 CSS:  vloÅ¾enÃ­ souboru, komentÃ¡Å™

1702
CSS pouÅ¾Ã­vÃ¡ znak  pro kÃ³dy barev, coÅ¾ je takÃ© zaÄÃ¡tek jednoÅ™Ã¡dkovÃ©ho M4 komentÃ¡Å™e.
KlÃ­ÄovÃ© slovo  nastavÃ­ vÃ­ceÅ™Ã¡dkovÃ½ komentÃ¡Å™  a pÅ™epÃ­Å¡e se na  (epsilon â€“ prÃ¡zdnÃ½ symbol).
KomentÃ¡Å™e se vypÃ­najÃ­ stejnÃ½m klÃ­ÄovÃ½m slovem  bez parametrÅ¯.

1713
[soubor vloÅ¾enÃ½ makro procesorem]

1715
[]

1720
 Bash:  netisknutelnÃ© znaky

1726
Bash pouÅ¾Ã­vÃ¡ oba znaky,  a .
Nechceme-li je skrÃ½vat do makra  nebo , mÅ¯Å¾eme pouÅ¾Ã­t pro Å™Ã­zenÃ­ expanze neterminÃ¡lÅ¯ netisknutelnÃ© znaky, viz. pÅ™Ã­klad:

1735
[]

1736
[]

1741
M4:  pÅ™Ã­klady

1741
[pro informaci]

1741
Znaky {, , , } v nÃ¡zvu pÅ™Ã­kladu Å™Ã­dÃ­ expanzi neterminÃ¡lÅ¯.

1748
 JSON:  levÃ¡ zÃ¡vorka 

1754
UvnitÅ™ hranatÃ½ch zÃ¡vorek .
Proto je levÃ¡ hranatÃ¡ zÃ¡vorka  nahrazena makrem  z koÅ™enovÃ©ho souboru.

1768
 Bash:  poÄÃ­tadla

1774
PoÄÃ­tadla  a  jsou definovÃ¡na v koÅ™enovÃ©m souboru.
NeterminÃ¡ly  nebudou expandovÃ¡ny, pouze se odeberou vnÄ›jÅ¡Ã­ zÃ¡vorky.
Nutno pouÅ¾Ã­t makro  z koÅ™enovÃ©ho souboru.

1785
[]

1794
 .h:  zÃ¡vorky , , , 

1800
PrÃ¡zdnÃ½ pÃ¡r  (nebo prÃ¡zdnÃ½ symbol v zÃ¡vorkÃ¡ch ) slouÅ¾Ã­ jako oddÄ›lovaÄ symbolÅ¯.
ZÃ¡vorky kolem znaku komentÃ¡Å™e  vypnou jeho pÅ¯vodnÃ­ vÃ½znam, stejnÄ› jako vypnou vÃ½znam silnÄ›jÅ¡Ã­ho M4 komentÃ¡Å™e .
Vypnou takÃ© pÅ¯vodnÃ­ vÃ½znam ÄÃ¡rky  jako oddÄ›lovaÄe argumentÅ¯ maker.
Tyto symboly se stanou obyÄejnÃ½mi terminÃ¡lnÃ­mi symboly bez jakÃ©hokoliv vedlejÅ¡Ã­ho efektu.

1813
[]

1822
 AWK:  pÅ™Ã­klady bezpeÄnÄ›jÅ¡Ã­ch maker

1828
UniverzÃ¡lnÃ­ vÃ½straha  se ignoruje bez zÃ¡vorek, stejnÄ› jako , , â€¦
TakovÃ¡ makra explicitnÄ› vytvÃ¡Å™Ã­ vÃ½vojÃ¡Å™ skriptÅ¯, prohlÃ©dnÄ›te si koÅ™enovÃ½ soubor.

1837
[]

1842
[]

1850
ProÄ pouÅ¾Ã­vat M4 a proÄ ne?

1850
[pro informaci]

1850
Znaky {, , , } v nÃ¡zvu pÅ™Ã­kladu Å™Ã­dÃ­ expanzi neterminÃ¡lÅ¯.

1858
 ProÄ generovat kÃ³d v M4

1864
pÅ™Ã­mÃ© pouÅ¾itÃ­ bezkontextovÃ© gramatiky (rekurze zdarma)
pro transformaci dat staÄÃ­ napsat minimum M4 kÃ³du

1864
pÅ™Ã­mÃ© pouÅ¾itÃ­ automatÅ¯
moÅ¾nost vymodelovat si potÅ™ebnÃ© algoritmy (M4 nepotÅ™ebuje verze)

1864
pÅ™Ã­mÃ© pouÅ¾itÃ­ zÃ¡sobnÃ­kÅ¯
zÃ¡sobnÃ­ky propojenÃ© s automaty rozÅ¡iÅ™ujÃ­ moÅ¾nosti generÃ¡toru kÃ³du

1864
pÅ™Ã­mÃ© pouÅ¾itÃ­ vÃ½stupnÃ­ch front pro doÄasnÃ© uloÅ¾enÃ­ vÃ½slednÃ½ch ÄÃ¡stÃ­ kÃ³du
jednotlivÃ© fronty jsou na zÃ¡vÄ›r vypsÃ¡ny na vÃ½stup ve vzestupnÃ©m poÅ™adÃ­

1864
vÃ½raznÄ› vyÅ¡Å¡Ã­ rychlost generovÃ¡nÃ­ kÃ³du (ve srovnÃ¡nÃ­ s XSLT)
nÃ­zkÃ© nÃ¡roky na vÃ½poÄetnÃ­ zdroje

1914
 ProÄ se vyhnout M4

1920
univerzÃ¡lnÃ­ jazyk nÃ­zkÃ© ÃºrovnÄ› (podobnÄ› jako jazyk C)
vÃ½mÄ›nou poskytuje ohromnou flexibilitu jako UNIX

1920
(tÃ©mÄ›Å™) neexistujÃ­cÃ­ komunita vÃ½vojÃ¡Å™Å¯ (podzim 2019)
M4 je tÃ©mÄ›Å™ zapomenutÃ½ jazyk, mÃ¡lo existujÃ­cÃ­ch projektÅ¯

1920
neobvyklÃ© programovacÃ­ paradigma vyÅ¾adujÃ­cÃ­ splnÄ›nÃ­ nÄ›kolika pÅ™edpokladÅ¯
prÃ¡vÄ› proto lze M4 povaÅ¾ovat za nÃ¡roÄnÃ½ jazyk

1920
produktivita znaÄnÄ› zÃ¡visÃ­ na zkuÅ¡enostech (moÅ¾nÃ½ problÃ©m s termÃ­ny)
psanÃ­ M4 skriptÅ¯ vyÅ¾aduje zÃ¡kladnÃ­ znalost automatÅ¯ a gramatik

1920
ÃºdrÅ¾ba Å¡patnÄ› napsanÃ©ho M4 kÃ³du nenÃ­ jednoduchÃ¡
existujÃ­cÃ­ M4 kÃ³d je snadnÃ© promÄ›nit ve zmatek (nutnÃ½ dohled!)

---

59
GenerovÃ¡nÃ­ kÃ³du v M4	vÃ­cejazyÄnÃ¡ Å¡ablona s pÅ™Ã­klady pro www.root.cz (Root.cz â€“ informace nejen ze svÄ›ta Linuxu)

151
A General Purpose Macro-generator	Computer Journal 8, 3 (1965), 225â€“41

270
RATFOR â€” A Preprocessor for a Rational Fortran	Brian W. Kernighan

364
The M4 Macro Processor	Bell Laboratories (1977)

373
Christopher Strachey	Computer Hope â€“ Free computer help since 1998

373
Dennis Ritchie	Zomrel tvorca Unixu a jazyka C

373
Brian Kernighan	An Interview with Brian Kernighan

413
GNU M4 - GNU macro processor	Free Software Foundation

1018
Teorie automatÅ¯	From Wikipedia, the free encyclopedia

1101
GNU Make Manual	Free Software Foundation

1117
Vim â€“ vÅ¡udypÅ™Ã­tomnÃ½ textovÃ½ editor	kterÃ½ edituje text rychlostÃ­ myÅ¡lenky

1135
Automaty a formÃ¡lnÃ­ jazyky I	UÄebnÃ­ text FI MU

1149
Automaty a gramatiky	Michal Chytil, 1. vydÃ¡nÃ­, Praha, 331 s. 1984.
